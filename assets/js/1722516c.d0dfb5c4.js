"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[2978],{85639:function(e,n,t){t.r(n),t.d(n,{assets:function(){return c},contentTitle:function(){return o},default:function(){return k},frontMatter:function(){return p},metadata:function(){return u},toc:function(){return d}});var a=t(83117),l=t(80102),i=(t(67294),t(3905)),r=["components"],p={id:"3AOP\u7b80\u8981\u5165\u95e8",slug:"/3AOP\u7b80\u8981\u5165\u95e8",title:"3 AOP\u7b80\u8981\u5165\u95e8",author:"RiverMountain",date:"2023/06/17",tags:["Java","Spring","AOP"],keywords:["Java","Spring","AOP"],description:"AOP\u5728\u4e0d\u6539\u539f\u6709\u4ee3\u7801\u7684\u524d\u63d0\u4e0b\u5bf9\u5176\u8fdb\u884c\u589e\u5f3a",last_update:{date:"2023/06/17"}},o=void 0,u={unversionedId:"stack/java/Spring/Spring\u57fa\u7840/3AOP\u7b80\u8981\u5165\u95e8",id:"stack/java/Spring/Spring\u57fa\u7840/3AOP\u7b80\u8981\u5165\u95e8",title:"3 AOP\u7b80\u8981\u5165\u95e8",description:"AOP\u5728\u4e0d\u6539\u539f\u6709\u4ee3\u7801\u7684\u524d\u63d0\u4e0b\u5bf9\u5176\u8fdb\u884c\u589e\u5f3a",source:"@site/docs/stack/java/Spring/Spring\u57fa\u7840/4 AOP\u7b80\u8981\u5165\u95e8.md",sourceDirName:"stack/java/Spring/Spring\u57fa\u7840",slug:"/3AOP\u7b80\u8981\u5165\u95e8",permalink:"/docs/3AOP\u7b80\u8981\u5165\u95e8",draft:!1,tags:[{label:"Java",permalink:"/docs/tags/java"},{label:"Spring",permalink:"/docs/tags/spring"},{label:"AOP",permalink:"/docs/tags/aop"}],version:"current",frontMatter:{id:"3AOP\u7b80\u8981\u5165\u95e8",slug:"/3AOP\u7b80\u8981\u5165\u95e8",title:"3 AOP\u7b80\u8981\u5165\u95e8",author:"RiverMountain",date:"2023/06/17",tags:["Java","Spring","AOP"],keywords:["Java","Spring","AOP"],description:"AOP\u5728\u4e0d\u6539\u539f\u6709\u4ee3\u7801\u7684\u524d\u63d0\u4e0b\u5bf9\u5176\u8fdb\u884c\u589e\u5f3a",last_update:{date:"2023/06/17"}},sidebar:"stack",previous:{title:"3 IOC\u4e0eDI\u8fdb\u9636",permalink:"/docs/3IOC\u4e0eDI\u8fdb\u9636"},next:{title:"\u8bbe\u8ba1\u6a21\u5f0f\u6982\u8ff0",permalink:"/docs/DP_1"}},c={},d=[{value:"AOP\u7b80\u4ecb",id:"aop\u7b80\u4ecb",level:2},{value:"\u4ec0\u4e48\u662fAOP?",id:"\u4ec0\u4e48\u662faop",level:3},{value:"AOP\u4f5c\u7528",id:"aop\u4f5c\u7528",level:3},{value:"AOP\u6838\u5fc3\u6982\u5ff5",id:"aop\u6838\u5fc3\u6982\u5ff5",level:3},{value:"AOP\u5165\u95e8\u6848\u4f8b",id:"aop\u5165\u95e8\u6848\u4f8b",level:2},{value:"\u9700\u6c42\u5206\u6790",id:"\u9700\u6c42\u5206\u6790",level:3},{value:"\u601d\u8def\u5206\u6790",id:"\u601d\u8def\u5206\u6790",level:3},{value:"\u73af\u5883\u51c6\u5907",id:"\u73af\u5883\u51c6\u5907",level:3},{value:"AOP\u5b9e\u73b0\u6b65\u9aa4",id:"aop\u5b9e\u73b0\u6b65\u9aa4",level:3},{value:"\u6b65\u9aa41:\u6dfb\u52a0\u4f9d\u8d56",id:"\u6b65\u9aa41\u6dfb\u52a0\u4f9d\u8d56",level:4},{value:"\u6b65\u9aa42:\u5b9a\u4e49\u63a5\u53e3\u4e0e\u5b9e\u73b0\u7c7b",id:"\u6b65\u9aa42\u5b9a\u4e49\u63a5\u53e3\u4e0e\u5b9e\u73b0\u7c7b",level:4},{value:"\u6b65\u9aa43:\u5b9a\u4e49\u901a\u77e5\u7c7b\u548c\u901a\u77e5",id:"\u6b65\u9aa43\u5b9a\u4e49\u901a\u77e5\u7c7b\u548c\u901a\u77e5",level:4},{value:"\u6b65\u9aa44:\u5b9a\u4e49\u5207\u5165\u70b9",id:"\u6b65\u9aa44\u5b9a\u4e49\u5207\u5165\u70b9",level:4},{value:"\u6b65\u9aa45:\u5236\u4f5c\u5207\u9762",id:"\u6b65\u9aa45\u5236\u4f5c\u5207\u9762",level:4},{value:"\u6b65\u9aa46:\u5c06\u901a\u77e5\u7c7b\u914d\u7ed9\u5bb9\u5668\u5e76\u6807\u8bc6\u5176\u4e3a\u5207\u9762\u7c7b",id:"\u6b65\u9aa46\u5c06\u901a\u77e5\u7c7b\u914d\u7ed9\u5bb9\u5668\u5e76\u6807\u8bc6\u5176\u4e3a\u5207\u9762\u7c7b",level:4},{value:"\u6b65\u9aa47:\u5f00\u542f\u6ce8\u89e3\u683c\u5f0fAOP\u529f\u80fd",id:"\u6b65\u9aa47\u5f00\u542f\u6ce8\u89e3\u683c\u5f0faop\u529f\u80fd",level:4},{value:"\u6b65\u9aa48:\u8fd0\u884c\u7a0b\u5e8f",id:"\u6b65\u9aa48\u8fd0\u884c\u7a0b\u5e8f",level:4},{value:"\u77e5\u8bc6\u70b91\uff1a@EnableAspectJAutoProxy",id:"\u77e5\u8bc6\u70b91enableaspectjautoproxy",level:3},{value:"\u77e5\u8bc6\u70b92\uff1a@Aspect",id:"\u77e5\u8bc6\u70b92aspect",level:3},{value:"\u77e5\u8bc6\u70b93\uff1a@Pointcut",id:"\u77e5\u8bc6\u70b93pointcut",level:3},{value:"\u77e5\u8bc6\u70b94\uff1a@Before",id:"\u77e5\u8bc6\u70b94before",level:3},{value:"AOP\u5de5\u4f5c\u6d41\u7a0b",id:"aop\u5de5\u4f5c\u6d41\u7a0b",level:2},{value:"AOP\u5de5\u4f5c\u6d41\u7a0b",id:"aop\u5de5\u4f5c\u6d41\u7a0b-1",level:3},{value:"\u6d41\u7a0b1:Spring\u5bb9\u5668\u542f\u52a8",id:"\u6d41\u7a0b1spring\u5bb9\u5668\u542f\u52a8",level:4},{value:"\u6d41\u7a0b2:\u8bfb\u53d6\u6240\u6709\u5207\u9762\u914d\u7f6e\u4e2d\u7684\u5207\u5165\u70b9",id:"\u6d41\u7a0b2\u8bfb\u53d6\u6240\u6709\u5207\u9762\u914d\u7f6e\u4e2d\u7684\u5207\u5165\u70b9",level:4},{value:"\u6d41\u7a0b3:\u521d\u59cb\u5316bean\uff0c",id:"\u6d41\u7a0b3\u521d\u59cb\u5316bean",level:4},{value:"\u6d41\u7a0b4:\u83b7\u53d6bean\u6267\u884c\u65b9\u6cd5",id:"\u6d41\u7a0b4\u83b7\u53d6bean\u6267\u884c\u65b9\u6cd5",level:4},{value:"\u9a8c\u8bc1\u5bb9\u5668\u4e2d\u662f\u5426\u4e3a\u4ee3\u7406\u5bf9\u8c61",id:"\u9a8c\u8bc1\u5bb9\u5668\u4e2d\u662f\u5426\u4e3a\u4ee3\u7406\u5bf9\u8c61",level:4},{value:"\u9a8c\u8bc1\u601d\u8def",id:"\u9a8c\u8bc1\u601d\u8def",level:5},{value:"\u6b65\u9aa41:\u4fee\u6539App\u7c7b,\u83b7\u53d6\u7c7b\u7684\u7c7b\u578b",id:"\u6b65\u9aa41\u4fee\u6539app\u7c7b\u83b7\u53d6\u7c7b\u7684\u7c7b\u578b",level:5},{value:"\u6b65\u9aa42:\u4fee\u6539MyAdvice\u7c7b\uff0c\u4e0d\u589e\u5f3a",id:"\u6b65\u9aa42\u4fee\u6539myadvice\u7c7b\u4e0d\u589e\u5f3a",level:5},{value:"\u6b65\u9aa43:\u8fd0\u884c\u7a0b\u5e8f",id:"\u6b65\u9aa43\u8fd0\u884c\u7a0b\u5e8f",level:5},{value:"\u6b65\u9aa44:\u4fee\u6539MyAdvice\u7c7b\uff0c\u589e\u5f3a",id:"\u6b65\u9aa44\u4fee\u6539myadvice\u7c7b\u589e\u5f3a",level:5},{value:"\u6b65\u9aa45:\u8fd0\u884c\u7a0b\u5e8f",id:"\u6b65\u9aa45\u8fd0\u884c\u7a0b\u5e8f",level:5},{value:"AOP\u6838\u5fc3\u6982\u5ff5",id:"aop\u6838\u5fc3\u6982\u5ff5-1",level:3},{value:"AOP\u914d\u7f6e\u7ba1\u7406",id:"aop\u914d\u7f6e\u7ba1\u7406",level:2},{value:"AOP\u5207\u5165\u70b9\u8868\u8fbe\u5f0f",id:"aop\u5207\u5165\u70b9\u8868\u8fbe\u5f0f",level:3},{value:"\u8bed\u6cd5\u683c\u5f0f",id:"\u8bed\u6cd5\u683c\u5f0f",level:4},{value:"\u901a\u914d\u7b26",id:"\u901a\u914d\u7b26",level:4},{value:"\u4e66\u5199\u6280\u5de7",id:"\u4e66\u5199\u6280\u5de7",level:4},{value:"AOP\u901a\u77e5\u7c7b\u578b",id:"aop\u901a\u77e5\u7c7b\u578b",level:3},{value:"\u7c7b\u578b\u4ecb\u7ecd",id:"\u7c7b\u578b\u4ecb\u7ecd",level:4},{value:"\u73af\u5883\u51c6\u5907",id:"\u73af\u5883\u51c6\u5907-1",level:4},{value:"\u901a\u77e5\u7c7b\u578b\u7684\u4f7f\u7528",id:"\u901a\u77e5\u7c7b\u578b\u7684\u4f7f\u7528",level:4},{value:"\u524d\u7f6e\u901a\u77e5",id:"\u524d\u7f6e\u901a\u77e5",level:5},{value:"\u540e\u7f6e\u901a\u77e5",id:"\u540e\u7f6e\u901a\u77e5",level:5},{value:"\u73af\u7ed5\u901a\u77e5",id:"\u73af\u7ed5\u901a\u77e5",level:5},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528",level:6},{value:"\u6ce8\u610f\u4e8b\u9879",id:"\u6ce8\u610f\u4e8b\u9879",level:6},{value:"\u8fd4\u56de\u540e\u901a\u77e5",id:"\u8fd4\u56de\u540e\u901a\u77e5",level:5},{value:"\u5f02\u5e38\u540e\u901a\u77e5",id:"\u5f02\u5e38\u540e\u901a\u77e5",level:5},{value:"\u901a\u77e5\u7c7b\u578b\u603b\u7ed3",id:"\u901a\u77e5\u7c7b\u578b\u603b\u7ed3",level:5},{value:"\u77e5\u8bc6\u70b91\uff1a@After",id:"\u77e5\u8bc6\u70b91after",level:6},{value:"\u77e5\u8bc6\u70b92\uff1a@AfterReturning",id:"\u77e5\u8bc6\u70b92afterreturning",level:6},{value:"\u77e5\u8bc6\u70b93\uff1a@AfterThrowing",id:"\u77e5\u8bc6\u70b93afterthrowing",level:6},{value:"\u77e5\u8bc6\u70b94\uff1a@Around",id:"\u77e5\u8bc6\u70b94around",level:6},{value:"\u4e1a\u52a1\u5c42\u63a5\u53e3\u6267\u884c\u6548\u7387",id:"\u4e1a\u52a1\u5c42\u63a5\u53e3\u6267\u884c\u6548\u7387",level:3},{value:"\u9700\u6c42\u5206\u6790",id:"\u9700\u6c42\u5206\u6790-1",level:4},{value:"\u73af\u5883\u51c6\u5907",id:"\u73af\u5883\u51c6\u5907-2",level:4},{value:"\u529f\u80fd\u5f00\u53d1",id:"\u529f\u80fd\u5f00\u53d1",level:4},{value:"\u6b65\u9aa41:\u5f00\u542fSpringAOP\u7684\u6ce8\u89e3\u529f\u80fd",id:"\u6b65\u9aa41\u5f00\u542fspringaop\u7684\u6ce8\u89e3\u529f\u80fd",level:5},{value:"\u6b65\u9aa42:\u521b\u5efaAOP\u7684\u901a\u77e5\u7c7b",id:"\u6b65\u9aa42\u521b\u5efaaop\u7684\u901a\u77e5\u7c7b",level:5},{value:"\u6b65\u9aa43:\u6dfb\u52a0\u73af\u7ed5\u901a\u77e5",id:"\u6b65\u9aa43\u6dfb\u52a0\u73af\u7ed5\u901a\u77e5",level:5},{value:"\u6b65\u9aa44:\u5b8c\u6210\u6838\u5fc3\u4e1a\u52a1\uff0c\u8bb0\u5f55\u4e07\u6b21\u6267\u884c\u7684\u65f6\u95f4",id:"\u6b65\u9aa44\u5b8c\u6210\u6838\u5fc3\u4e1a\u52a1\u8bb0\u5f55\u4e07\u6b21\u6267\u884c\u7684\u65f6\u95f4",level:5},{value:"\u6b65\u9aa45:\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\u7c7b",id:"\u6b65\u9aa45\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\u7c7b",level:5},{value:"\u6b65\u9aa46:\u7a0b\u5e8f\u4f18\u5316",id:"\u6b65\u9aa46\u7a0b\u5e8f\u4f18\u5316",level:5},{value:"\u6b65\u9aa47:\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\u7c7b",id:"\u6b65\u9aa47\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\u7c7b",level:5},{value:"AOP\u901a\u77e5\u83b7\u53d6\u6570\u636e",id:"aop\u901a\u77e5\u83b7\u53d6\u6570\u636e",level:3},{value:"\u73af\u5883\u51c6\u5907",id:"\u73af\u5883\u51c6\u5907-3",level:4},{value:"\u83b7\u53d6\u53c2\u6570",id:"\u83b7\u53d6\u53c2\u6570",level:4},{value:"\u975e\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u65b9\u5f0f",id:"\u975e\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u65b9\u5f0f",level:5},{value:"\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u65b9\u5f0f",id:"\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u65b9\u5f0f",level:5},{value:"\u83b7\u53d6\u8fd4\u56de\u503c",id:"\u83b7\u53d6\u8fd4\u56de\u503c",level:4},{value:"\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u8fd4\u56de\u503c",id:"\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u8fd4\u56de\u503c",level:5},{value:"\u8fd4\u56de\u540e\u901a\u77e5\u83b7\u53d6\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u540e\u901a\u77e5\u83b7\u53d6\u8fd4\u56de\u503c",level:5},{value:"\u83b7\u53d6\u5f02\u5e38",id:"\u83b7\u53d6\u5f02\u5e38",level:4},{value:"\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u5f02\u5e38",id:"\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u5f02\u5e38",level:5},{value:"\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5\u83b7\u53d6\u5f02\u5e38",id:"\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5\u83b7\u53d6\u5f02\u5e38",level:5},{value:"\u767e\u5ea6\u7f51\u76d8\u5bc6\u7801\u6570\u636e\u517c\u5bb9\u5904\u7406",id:"\u767e\u5ea6\u7f51\u76d8\u5bc6\u7801\u6570\u636e\u517c\u5bb9\u5904\u7406",level:3},{value:"\u9700\u6c42\u5206\u6790",id:"\u9700\u6c42\u5206\u6790-2",level:4},{value:"\u73af\u5883\u51c6\u5907",id:"\u73af\u5883\u51c6\u5907-4",level:4},{value:"\u5177\u4f53\u5b9e\u73b0",id:"\u5177\u4f53\u5b9e\u73b0",level:4},{value:"\u6b65\u9aa41:\u5f00\u542fSpringAOP\u7684\u6ce8\u89e3\u529f\u80fd",id:"\u6b65\u9aa41\u5f00\u542fspringaop\u7684\u6ce8\u89e3\u529f\u80fd-1",level:5},{value:"\u6b65\u9aa42:\u7f16\u5199\u901a\u77e5\u7c7b",id:"\u6b65\u9aa42\u7f16\u5199\u901a\u77e5\u7c7b",level:5},{value:"\u6b65\u9aa43:\u6dfb\u52a0\u73af\u7ed5\u901a\u77e5",id:"\u6b65\u9aa43\u6dfb\u52a0\u73af\u7ed5\u901a\u77e5-1",level:5},{value:"\u6b65\u9aa44:\u5b8c\u6210\u6838\u5fc3\u4e1a\u52a1\uff0c\u5904\u7406\u53c2\u6570\u4e2d\u7684\u7a7a\u683c",id:"\u6b65\u9aa44\u5b8c\u6210\u6838\u5fc3\u4e1a\u52a1\u5904\u7406\u53c2\u6570\u4e2d\u7684\u7a7a\u683c",level:5},{value:"\u6b65\u9aa45:\u8fd0\u884c\u7a0b\u5e8f",id:"\u6b65\u9aa45\u8fd0\u884c\u7a0b\u5e8f-1",level:5},{value:"\u6b65\u9aa46:\u4f18\u5316\u6d4b\u8bd5",id:"\u6b65\u9aa46\u4f18\u5316\u6d4b\u8bd5",level:5},{value:"AOP\u603b\u7ed3",id:"aop\u603b\u7ed3",level:2},{value:"AOP\u7684\u6838\u5fc3\u6982\u5ff5",id:"aop\u7684\u6838\u5fc3\u6982\u5ff5",level:3},{value:"\u5207\u5165\u70b9\u8868\u8fbe\u5f0f",id:"\u5207\u5165\u70b9\u8868\u8fbe\u5f0f",level:3},{value:"\u4e94\u79cd\u901a\u77e5\u7c7b\u578b",id:"\u4e94\u79cd\u901a\u77e5\u7c7b\u578b",level:3},{value:"\u901a\u77e5\u4e2d\u83b7\u53d6\u53c2\u6570",id:"\u901a\u77e5\u4e2d\u83b7\u53d6\u53c2\u6570",level:3},{value:"AOP\u4e8b\u52a1\u7ba1\u7406",id:"aop\u4e8b\u52a1\u7ba1\u7406",level:2},{value:"Spring\u4e8b\u52a1\u7b80\u4ecb",id:"spring\u4e8b\u52a1\u7b80\u4ecb",level:3},{value:"\u76f8\u5173\u6982\u5ff5\u4ecb\u7ecd",id:"\u76f8\u5173\u6982\u5ff5\u4ecb\u7ecd",level:4},{value:"\u8f6c\u8d26\u6848\u4f8b-\u9700\u6c42\u5206\u6790",id:"\u8f6c\u8d26\u6848\u4f8b-\u9700\u6c42\u5206\u6790",level:4},{value:"\u8f6c\u8d26\u6848\u4f8b-\u73af\u5883\u642d\u5efa",id:"\u8f6c\u8d26\u6848\u4f8b-\u73af\u5883\u642d\u5efa",level:4},{value:"\u6b65\u9aa41:\u51c6\u5907\u6570\u636e\u5e93\u8868",id:"\u6b65\u9aa41\u51c6\u5907\u6570\u636e\u5e93\u8868",level:5},{value:"\u6b65\u9aa42:\u521b\u5efa\u9879\u76ee\u5bfc\u5165jar\u5305",id:"\u6b65\u9aa42\u521b\u5efa\u9879\u76ee\u5bfc\u5165jar\u5305",level:5},{value:"\u6b65\u9aa43:\u6839\u636e\u8868\u521b\u5efa\u6a21\u578b\u7c7b",id:"\u6b65\u9aa43\u6839\u636e\u8868\u521b\u5efa\u6a21\u578b\u7c7b",level:5},{value:"\u6b65\u9aa44:\u521b\u5efaDao\u63a5\u53e3",id:"\u6b65\u9aa44\u521b\u5efadao\u63a5\u53e3",level:5},{value:"\u6b65\u9aa45:\u521b\u5efaService\u63a5\u53e3\u548c\u5b9e\u73b0\u7c7b",id:"\u6b65\u9aa45\u521b\u5efaservice\u63a5\u53e3\u548c\u5b9e\u73b0\u7c7b",level:5},{value:"\u6b65\u9aa46:\u6dfb\u52a0jdbc.properties\u6587\u4ef6",id:"\u6b65\u9aa46\u6dfb\u52a0jdbcproperties\u6587\u4ef6",level:5},{value:"\u6b65\u9aa47:\u521b\u5efaJdbcConfig\u914d\u7f6e\u7c7b",id:"\u6b65\u9aa47\u521b\u5efajdbcconfig\u914d\u7f6e\u7c7b",level:5},{value:"\u6b65\u9aa48:\u521b\u5efaMybatisConfig\u914d\u7f6e\u7c7b",id:"\u6b65\u9aa48\u521b\u5efamybatisconfig\u914d\u7f6e\u7c7b",level:5},{value:"\u6b65\u9aa49:\u521b\u5efaSpringConfig\u914d\u7f6e\u7c7b",id:"\u6b65\u9aa49\u521b\u5efaspringconfig\u914d\u7f6e\u7c7b",level:5},{value:"\u6b65\u9aa410:\u7f16\u5199\u6d4b\u8bd5\u7c7b",id:"\u6b65\u9aa410\u7f16\u5199\u6d4b\u8bd5\u7c7b",level:5},{value:"\u4e8b\u52a1\u7ba1\u7406",id:"\u4e8b\u52a1\u7ba1\u7406",level:4},{value:"\u6b65\u9aa41:\u5728\u9700\u8981\u88ab\u4e8b\u52a1\u7ba1\u7406\u7684\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u6ce8\u89e3",id:"\u6b65\u9aa41\u5728\u9700\u8981\u88ab\u4e8b\u52a1\u7ba1\u7406\u7684\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u6ce8\u89e3",level:5},{value:"\u6b65\u9aa42:\u5728JdbcConfig\u7c7b\u4e2d\u914d\u7f6e\u4e8b\u52a1\u7ba1\u7406\u5668",id:"\u6b65\u9aa42\u5728jdbcconfig\u7c7b\u4e2d\u914d\u7f6e\u4e8b\u52a1\u7ba1\u7406\u5668",level:5},{value:"\u6b65\u9aa43\uff1a\u5f00\u542f\u4e8b\u52a1\u6ce8\u89e3",id:"\u6b65\u9aa43\u5f00\u542f\u4e8b\u52a1\u6ce8\u89e3",level:5},{value:"\u6b65\u9aa44:\u8fd0\u884c\u6d4b\u8bd5\u7c7b",id:"\u6b65\u9aa44\u8fd0\u884c\u6d4b\u8bd5\u7c7b",level:5},{value:"\u77e5\u8bc6\u70b91\uff1a@EnableTransactionManagement",id:"\u77e5\u8bc6\u70b91enabletransactionmanagement",level:5},{value:"\u77e5\u8bc6\u70b92\uff1a@Transactional",id:"\u77e5\u8bc6\u70b92transactional",level:5},{value:"Spring\u4e8b\u52a1\u89d2\u8272",id:"spring\u4e8b\u52a1\u89d2\u8272",level:3},{value:"Spring\u4e8b\u52a1\u5c5e\u6027",id:"spring\u4e8b\u52a1\u5c5e\u6027",level:3},{value:"\u4e8b\u52a1\u914d\u7f6e",id:"\u4e8b\u52a1\u914d\u7f6e",level:4},{value:"\u8f6c\u8d26\u4e1a\u52a1\u8ffd\u52a0\u65e5\u5fd7\u6848\u4f8b",id:"\u8f6c\u8d26\u4e1a\u52a1\u8ffd\u52a0\u65e5\u5fd7\u6848\u4f8b",level:4},{value:"\u9700\u6c42\u5206\u6790",id:"\u9700\u6c42\u5206\u6790-3",level:5},{value:"\u73af\u5883\u51c6\u5907",id:"\u73af\u5883\u51c6\u5907-5",level:5},{value:"\u6b65\u9aa41:\u521b\u5efa\u65e5\u5fd7\u8868",id:"\u6b65\u9aa41\u521b\u5efa\u65e5\u5fd7\u8868",level:6},{value:"\u6b65\u9aa42:\u6dfb\u52a0LogDao\u63a5\u53e3",id:"\u6b65\u9aa42\u6dfb\u52a0logdao\u63a5\u53e3",level:6},{value:"\u6b65\u9aa43:\u6dfb\u52a0LogService\u63a5\u53e3\u4e0e\u5b9e\u73b0\u7c7b",id:"\u6b65\u9aa43\u6dfb\u52a0logservice\u63a5\u53e3\u4e0e\u5b9e\u73b0\u7c7b",level:6},{value:"\u6b65\u9aa44:\u5728\u8f6c\u8d26\u7684\u4e1a\u52a1\u4e2d\u6dfb\u52a0\u8bb0\u5f55\u65e5\u5fd7",id:"\u6b65\u9aa44\u5728\u8f6c\u8d26\u7684\u4e1a\u52a1\u4e2d\u6dfb\u52a0\u8bb0\u5f55\u65e5\u5fd7",level:6},{value:"\u6b65\u9aa45:\u8fd0\u884c\u7a0b\u5e8f",id:"\u6b65\u9aa45\u8fd0\u884c\u7a0b\u5e8f-2",level:6},{value:"\u4e8b\u52a1\u4f20\u64ad\u884c\u4e3a",id:"\u4e8b\u52a1\u4f20\u64ad\u884c\u4e3a",level:4},{value:"\u4fee\u6539logService\u6539\u53d8\u4e8b\u52a1\u7684\u4f20\u64ad\u884c\u4e3a",id:"\u4fee\u6539logservice\u6539\u53d8\u4e8b\u52a1\u7684\u4f20\u64ad\u884c\u4e3a",level:5},{value:"\u4e8b\u52a1\u4f20\u64ad\u884c\u4e3a\u7684\u53ef\u9009\u503c",id:"\u4e8b\u52a1\u4f20\u64ad\u884c\u4e3a\u7684\u53ef\u9009\u503c",level:5}],m={toc:d},s="wrapper";function k(e){var n=e.components,p=(0,l.Z)(e,r);return(0,i.kt)(s,(0,a.Z)({},m,p,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"aop\u7b80\u4ecb"},"AOP\u7b80\u4ecb"),(0,i.kt)("p",null,"\u524d\u9762\u6211\u4eec\u5728\u4ecb\u7ecdSpring\u7684\u65f6\u5019\u8bf4\u8fc7\uff0cSpring\u6709\u4e24\u4e2a\u6838\u5fc3\u7684\u6982\u5ff5\uff0c\u4e00\u4e2a\u662f",(0,i.kt)("inlineCode",{parentName:"p"},"IOC/DI"),"\uff0c\u4e00\u4e2a\u662f",(0,i.kt)("inlineCode",{parentName:"p"},"AOP"),"\u3002"),(0,i.kt)("p",null,"\u524d\u9762\u5df2\u7ecf\u5bf9",(0,i.kt)("inlineCode",{parentName:"p"},"IOC/DI"),"\u8fdb\u884c\u4e86\u7cfb\u7edf\u7684\u5b66\u4e60\uff0c\u63a5\u4e0b\u6765\u8981\u5b66\u4e60\u5b83\u7684\u53e6\u4e00\u4e2a\u6838\u5fc3\u5185\u5bb9\uff0c\u5c31\u662fAOP\u3002"),(0,i.kt)("p",null,"\u5bf9\u4e8eAOP,\u6211\u4eec\u524d\u9762\u63d0\u8fc7\u4e00\u53e5\u8bdd\u662f:AOP\u662f\u5728\u4e0d\u6539\u539f\u6709\u4ee3\u7801\u7684\u524d\u63d0\u4e0b\u5bf9\u5176\u8fdb\u884c\u589e\u5f3a\u3002"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u4e0b\u9762\u7684\u5185\u5bb9\uff0c\u6211\u4eec\u4e3b\u8981\u5c31\u662f\u56f4\u7ed5\u7740\u8fd9\u4e00\u53e5\u8bdd\u8fdb\u884c\u5c55\u5f00\u5b66\u4e60\uff0c\u4e3b\u8981\u5b66\u4e60\u4e24\u65b9\u9762\u5185\u5bb9",(0,i.kt)("inlineCode",{parentName:"p"},"AOP\u6838\u5fc3\u6982\u5ff5"),",",(0,i.kt)("inlineCode",{parentName:"p"},"AOP\u4f5c\u7528"),":"),(0,i.kt)("h3",{id:"\u4ec0\u4e48\u662faop"},"\u4ec0\u4e48\u662fAOP?"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"AOP(Aspect Oriented Programming)\u9762\u5411\u5207\u9762\u7f16\u7a0b\uff0c\u4e00\u79cd\u7f16\u7a0b\u8303\u5f0f\uff0c\u6307\u5bfc\u5f00\u53d1\u8005\u5982\u4f55\u7ec4\u7ec7\u7a0b\u5e8f\u7ed3\u6784\u3002",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"OOP(Object Oriented Programming)\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b")))),(0,i.kt)("p",null,"\u6211\u4eec\u90fd\u77e5\u9053OOP\u662f\u4e00\u79cd\u7f16\u7a0b\u601d\u60f3\uff0c\u90a3\u4e48AOP\u4e5f\u662f\u4e00\u79cd\u7f16\u7a0b\u601d\u60f3\uff0c\u7f16\u7a0b\u601d\u60f3\u4e3b\u8981\u7684\u5185\u5bb9\u5c31\u662f\u6307\u5bfc\u7a0b\u5e8f\u5458\u8be5\u5982\u4f55\u7f16\u5199\u7a0b\u5e8f\uff0c\u6240\u4ee5\u5b83\u4eec\u4e24\u4e2a\u662f\u4e0d\u540c\u7684",(0,i.kt)("inlineCode",{parentName:"p"},"\u7f16\u7a0b\u8303\u5f0f"),"\u3002"),(0,i.kt)("h3",{id:"aop\u4f5c\u7528"},"AOP\u4f5c\u7528"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4f5c\u7528:\u5728\u4e0d\u60ca\u52a8\u539f\u59cb\u8bbe\u8ba1\u7684\u57fa\u7840\u4e0a\u4e3a\u5176\u8fdb\u884c\u529f\u80fd\u589e\u5f3a\uff0c\u524d\u9762\u54b1\u4eec\u6709\u6280\u672f\u5c31\u53ef\u4ee5\u5b9e\u73b0\u8fd9\u6837\u7684\u529f\u80fd\u5373\u4ee3\u7406\u6a21\u5f0f\u3002")),(0,i.kt)("p",null,"\u524d\u9762\u54b1\u4eec\u6709\u6280\u672f\u5c31\u53ef\u4ee5\u5b9e\u73b0\u8fd9\u6837\u7684\u529f\u80fd\u5373",(0,i.kt)("inlineCode",{parentName:"p"},"\u4ee3\u7406\u6a21\u5f0f"),"\u3002"),(0,i.kt)("h3",{id:"aop\u6838\u5fc3\u6982\u5ff5"},"AOP\u6838\u5fc3\u6982\u5ff5"),(0,i.kt)("p",null,"\u4e3a\u4e86\u80fd\u66f4\u597d\u7684\u7406\u89e3AOP\u7684\u76f8\u5173\u6982\u5ff5\uff0c\u6211\u4eec\u51c6\u5907\u4e86\u4e00\u4e2a\u73af\u5883\uff0c\u6574\u4e2a\u73af\u5883\u7684\u5185\u5bb9\u6211\u4eec\u6682\u65f6\u53ef\u4ee5\u4e0d\u7528\u5173\u6ce8\uff0c\u6700\u4e3b\u8981\u7684\u7c7b\u4e3a:",(0,i.kt)("inlineCode",{parentName:"p"},"BookDaoImpl")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Repository\npublic class BookDaoImpl implements BookDao {\n    public void save() {\n        //\u8bb0\u5f55\u7a0b\u5e8f\u5f53\u524d\u6267\u884c\u6267\u884c\uff08\u5f00\u59cb\u65f6\u95f4\uff09\n        Long startTime = System.currentTimeMillis();\n        //\u4e1a\u52a1\u6267\u884c\u4e07\u6b21\n        for (int i = 0;i<10000;i++) {\n            System.out.println("book dao save ...");\n        }\n        //\u8bb0\u5f55\u7a0b\u5e8f\u5f53\u524d\u6267\u884c\u65f6\u95f4\uff08\u7ed3\u675f\u65f6\u95f4\uff09\n        Long endTime = System.currentTimeMillis();\n        //\u8ba1\u7b97\u65f6\u95f4\u5dee\n        Long totalTime = endTime-startTime;\n        //\u8f93\u51fa\u4fe1\u606f\n        System.out.println("\u6267\u884c\u4e07\u6b21\u6d88\u8017\u65f6\u95f4\uff1a" + totalTime + "ms");\n    }\n    public void update(){\n        System.out.println("book dao update ...");\n    }\n    public void delete(){\n        System.out.println("book dao delete ...");\n    }\n    public void select(){\n        System.out.println("book dao select ...");\n    }\n}\n')),(0,i.kt)("p",null,"\u4ee3\u7801\u7684\u5185\u5bb9\u76f8\u4fe1\u5927\u5bb6\u90fd\u80fd\u591f\u8bfb\u61c2\uff0c\u5bf9\u4e8e",(0,i.kt)("inlineCode",{parentName:"p"},"save"),"\u65b9\u6cd5\u4e2d\u6709\u8ba1\u7b97\u4e07\u6b21\u6267\u884c\u6d88\u8017\u7684\u65f6\u95f4\u3002"),(0,i.kt)("p",null,"\u5f53\u5728App\u7c7b\u4e2d\u4ece\u5bb9\u5668\u4e2d\u83b7\u53d6bookDao\u5bf9\u8c61\u540e\uff0c\u5206\u522b\u6267\u884c\u5176",(0,i.kt)("inlineCode",{parentName:"p"},"save"),",",(0,i.kt)("inlineCode",{parentName:"p"},"delete"),",",(0,i.kt)("inlineCode",{parentName:"p"},"update"),"\u548c",(0,i.kt)("inlineCode",{parentName:"p"},"select"),"\u65b9\u6cd5\u540e\u4f1a\u6709\u5982\u4e0b\u7684\u6253\u5370\u7ed3\u679c:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630143927489",src:t(42453).Z,width:"1821",height:"409"})),(0,i.kt)("p",null,"\u8fd9\u4e2a\u65f6\u5019\uff0c\u6211\u4eec\u5c31\u5e94\u8be5\u6709\u4e9b\u7591\u95ee?"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5bf9\u4e8e\u8ba1\u7b97\u4e07\u6b21\u6267\u884c\u6d88\u8017\u7684\u65f6\u95f4\u53ea\u6709save\u65b9\u6cd5\u6709\uff0c\u4e3a\u4ec0\u4e48delete\u548cupdate\u65b9\u6cd5\u4e5f\u4f1a\u6709\u5462?"),(0,i.kt)("li",{parentName:"ul"},"delete\u548cupdate\u65b9\u6cd5\u6709\uff0c\u90a3\u4ec0\u4e48select\u65b9\u6cd5\u4e3a\u4ec0\u4e48\u53c8\u6ca1\u6709\u5462?")),(0,i.kt)("p",null,"\u8fd9\u4e2a\u6848\u4f8b\u4e2d\u5176\u5b9e\u5c31\u4f7f\u7528\u4e86Spring\u7684AOP\uff0c\u5728\u4e0d\u60ca\u52a8(\u6539\u52a8)\u539f\u6709\u8bbe\u8ba1(\u4ee3\u7801)\u7684\u524d\u63d0\u4e0b\uff0c\u60f3\u7ed9\u8c01\u6dfb\u52a0\u529f\u80fd\u5c31\u7ed9\u8c01\u6dfb\u52a0\u3002\u8fd9\u4e2a\u4e5f\u5c31\u662fSpring\u7684\u7406\u5ff5\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u65e0\u5165\u4fb5\u5f0f/\u65e0\u4fb5\u5165\u5f0f")),(0,i.kt)("p",null,"\u8bf4\u4e86\u8fd9\u4e48\u591a\uff0cSpring\u5230\u5e95\u662f\u5982\u4f55\u5b9e\u73b0\u7684\u5462?"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630144353462",src:t(21080).Z,width:"1325",height:"578"})),(0,i.kt)("p",null,"(1)\u524d\u9762\u4e00\u76f4\u5728\u5f3a\u8c03\uff0cSpring\u7684AOP\u662f\u5bf9\u4e00\u4e2a\u7c7b\u7684\u65b9\u6cd5\u5728\u4e0d\u8fdb\u884c\u4efb\u4f55\u4fee\u6539\u7684\u524d\u63d0\u4e0b\u5b9e\u73b0\u589e\u5f3a\u3002\u5bf9\u4e8e\u4e0a\u9762\u7684\u6848\u4f8b\u4e2dBookServiceImpl\u4e2d\u6709",(0,i.kt)("inlineCode",{parentName:"p"},"save"),",",(0,i.kt)("inlineCode",{parentName:"p"},"update"),",",(0,i.kt)("inlineCode",{parentName:"p"},"delete"),"\u548c",(0,i.kt)("inlineCode",{parentName:"p"},"select"),"\u65b9\u6cd5,\u8fd9\u4e9b\u65b9\u6cd5\u6211\u4eec\u7ed9\u8d77\u4e86\u4e00\u4e2a\u540d\u5b57\u53eb\u8fde\u63a5\u70b9"),(0,i.kt)("p",null,"(2)\u5728BookServiceImpl\u7684\u56db\u4e2a\u65b9\u6cd5\u4e2d\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"update"),"\u548c",(0,i.kt)("inlineCode",{parentName:"p"},"delete"),"\u53ea\u6709\u6253\u5370\u6ca1\u6709\u8ba1\u7b97\u4e07\u6b21\u6267\u884c\u6d88\u8017\u65f6\u95f4\uff0c\u4f46\u662f\u5728\u8fd0\u884c\u7684\u65f6\u5019\u5df2\u7ecf\u6709\u8be5\u529f\u80fd\uff0c\u90a3\u4e5f\u5c31\u662f\u8bf4",(0,i.kt)("inlineCode",{parentName:"p"},"update"),"\u548c",(0,i.kt)("inlineCode",{parentName:"p"},"delete"),"\u65b9\u6cd5\u90fd\u5df2\u7ecf\u88ab\u589e\u5f3a\uff0c\u6240\u4ee5\u5bf9\u4e8e\u9700\u8981\u589e\u5f3a\u7684\u65b9\u6cd5\u6211\u4eec\u7ed9\u8d77\u4e86\u4e00\u4e2a\u540d\u5b57\u53eb\u5207\u5165\u70b9"),(0,i.kt)("p",null,"(3)\u6267\u884cBookServiceImpl\u7684update\u548cdelete\u65b9\u6cd5\u7684\u65f6\u5019\u90fd\u88ab\u6dfb\u52a0\u4e86\u4e00\u4e2a\u8ba1\u7b97\u4e07\u6b21\u6267\u884c\u6d88\u8017\u65f6\u95f4\u7684\u529f\u80fd\uff0c\u5c06\u8fd9\u4e2a\u529f\u80fd\u62bd\u53d6\u5230\u4e00\u4e2a\u65b9\u6cd5\u4e2d\uff0c\u6362\u53e5\u8bdd\u8bf4\u5c31\u662f\u5b58\u653e\u5171\u6027\u529f\u80fd\u7684\u65b9\u6cd5\uff0c\u6211\u4eec\u7ed9\u8d77\u4e86\u4e2a\u540d\u5b57\u53eb\u901a\u77e5"),(0,i.kt)("p",null,"(4)\u901a\u77e5\u662f\u8981\u589e\u5f3a\u7684\u5185\u5bb9\uff0c\u4f1a\u6709\u591a\u4e2a\uff0c\u5207\u5165\u70b9\u662f\u9700\u8981\u88ab\u589e\u5f3a\u7684\u65b9\u6cd5\uff0c\u4e5f\u4f1a\u6709\u591a\u4e2a\uff0c\u90a3\u54ea\u4e2a\u5207\u5165\u70b9\u9700\u8981\u6dfb\u52a0\u54ea\u4e2a\u901a\u77e5\uff0c\u5c31\u9700\u8981\u63d0\u524d\u5c06\u5b83\u4eec\u4e4b\u95f4\u7684\u5173\u7cfb\u63cf\u8ff0\u6e05\u695a\uff0c\u90a3\u4e48\u5bf9\u4e8e\u901a\u77e5\u548c\u5207\u5165\u70b9\u4e4b\u95f4\u7684\u5173\u7cfb\u63cf\u8ff0\uff0c\u6211\u4eec\u7ed9\u8d77\u4e86\u4e2a\u540d\u5b57\u53eb\u5207\u9762"),(0,i.kt)("p",null,"(5)\u901a\u77e5\u662f\u4e00\u4e2a\u65b9\u6cd5\uff0c\u65b9\u6cd5\u4e0d\u80fd\u72ec\u7acb\u5b58\u5728\u9700\u8981\u88ab\u5199\u5728\u4e00\u4e2a\u7c7b\u4e2d\uff0c\u8fd9\u4e2a\u7c7b\u6211\u4eec\u4e5f\u7ed9\u8d77\u4e86\u4e2a\u540d\u5b57\u53eb\u901a\u77e5\u7c7b"),(0,i.kt)("p",null,"\u81f3\u6b64AOP\u4e2d\u7684\u6838\u5fc3\u6982\u5ff5\u5c31\u5df2\u7ecf\u4ecb\u7ecd\u5b8c\u4e86\uff0c\u603b\u7ed3\u4e0b:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u8fde\u63a5\u70b9(JoinPoint)\uff1a\u7a0b\u5e8f\u6267\u884c\u8fc7\u7a0b\u4e2d\u7684\u4efb\u610f\u4f4d\u7f6e\uff0c\u7c92\u5ea6\u4e3a\u6267\u884c\u65b9\u6cd5\u3001\u629b\u51fa\u5f02\u5e38\u3001\u8bbe\u7f6e\u53d8\u91cf\u7b49",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u5728SpringAOP\u4e2d\uff0c\u7406\u89e3\u4e3a\u65b9\u6cd5\u7684\u6267\u884c"))),(0,i.kt)("li",{parentName:"ul"},"\u5207\u5165\u70b9(Pointcut):\u5339\u914d\u8fde\u63a5\u70b9\u7684\u5f0f\u5b50",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u5728SpringAOP\u4e2d\uff0c\u4e00\u4e2a\u5207\u5165\u70b9\u53ef\u4ee5\u63cf\u8ff0\u4e00\u4e2a\u5177\u4f53\u65b9\u6cd5\uff0c\u4e5f\u53ef\u4e5f\u5339\u914d\u591a\u4e2a\u65b9\u6cd5",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u4e00\u4e2a\u5177\u4f53\u7684\u65b9\u6cd5:\u5982com.wrm244.dao\u5305\u4e0b\u7684BookDao\u63a5\u53e3\u4e2d\u7684\u65e0\u5f62\u53c2\u65e0\u8fd4\u56de\u503c\u7684save\u65b9\u6cd5"),(0,i.kt)("li",{parentName:"ul"},"\u5339\u914d\u591a\u4e2a\u65b9\u6cd5:\u6240\u6709\u7684save\u65b9\u6cd5\uff0c\u6240\u6709\u7684get\u5f00\u5934\u7684\u65b9\u6cd5\uff0c\u6240\u6709\u4ee5Dao\u7ed3\u5c3e\u7684\u63a5\u53e3\u4e2d\u7684\u4efb\u610f\u65b9\u6cd5\uff0c\u6240\u6709\u5e26\u6709\u4e00\u4e2a\u53c2\u6570\u7684\u65b9\u6cd5"))),(0,i.kt)("li",{parentName:"ul"},"\u8fde\u63a5\u70b9\u8303\u56f4\u8981\u6bd4\u5207\u5165\u70b9\u8303\u56f4\u5927\uff0c\u662f\u5207\u5165\u70b9\u7684\u65b9\u6cd5\u4e5f\u4e00\u5b9a\u662f\u8fde\u63a5\u70b9\uff0c\u4f46\u662f\u662f\u8fde\u63a5\u70b9\u7684\u65b9\u6cd5\u5c31\u4e0d\u4e00\u5b9a\u8981\u88ab\u589e\u5f3a\uff0c\u6240\u4ee5\u53ef\u80fd\u4e0d\u662f\u5207\u5165\u70b9\u3002"))),(0,i.kt)("li",{parentName:"ul"},"\u901a\u77e5(Advice):\u5728\u5207\u5165\u70b9\u5904\u6267\u884c\u7684\u64cd\u4f5c\uff0c\u4e5f\u5c31\u662f\u5171\u6027\u529f\u80fd",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u5728SpringAOP\u4e2d\uff0c\u529f\u80fd\u6700\u7ec8\u4ee5\u65b9\u6cd5\u7684\u5f62\u5f0f\u5448\u73b0"))),(0,i.kt)("li",{parentName:"ul"},"\u901a\u77e5\u7c7b\uff1a\u5b9a\u4e49\u901a\u77e5\u7684\u7c7b"),(0,i.kt)("li",{parentName:"ul"},"\u5207\u9762(Aspect):\u63cf\u8ff0\u901a\u77e5\u4e0e\u5207\u5165\u70b9\u7684\u5bf9\u5e94\u5173\u7cfb\u3002")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u5c0f\u7ed3")),(0,i.kt)("p",null,"\u8fd9\u4e00\u8282\u4e2d\u4e3b\u8981\u8bb2\u89e3\u4e86AOP\u7684\u6982\u5ff5\u4e0e\u4f5c\u7528\uff0c\u4ee5\u53caAOP\u4e2d\u7684\u6838\u5fc3\u6982\u5ff5\uff0c\u5b66\u5b8c\u4ee5\u540e\u5927\u5bb6\u9700\u8981\u80fd\u8bf4\u51fa:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4ec0\u4e48\u662fAOP?"),(0,i.kt)("li",{parentName:"ul"},"AOP\u7684\u4f5c\u7528\u662f\u4ec0\u4e48?"),(0,i.kt)("li",{parentName:"ul"},"AOP\u4e2d\u6838\u5fc3\u6982\u5ff5\u5206\u522b\u6307\u7684\u662f\u4ec0\u4e48?",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u8fde\u63a5\u70b9"),(0,i.kt)("li",{parentName:"ul"},"\u5207\u5165\u70b9"),(0,i.kt)("li",{parentName:"ul"},"\u901a\u77e5"),(0,i.kt)("li",{parentName:"ul"},"\u901a\u77e5\u7c7b"),(0,i.kt)("li",{parentName:"ul"},"\u5207\u9762")))),(0,i.kt)("h2",{id:"aop\u5165\u95e8\u6848\u4f8b"},"AOP\u5165\u95e8\u6848\u4f8b"),(0,i.kt)("h3",{id:"\u9700\u6c42\u5206\u6790"},"\u9700\u6c42\u5206\u6790"),(0,i.kt)("p",null,"\u6848\u4f8b\u8bbe\u5b9a\uff1a\u6d4b\u7b97\u63a5\u53e3\u6267\u884c\u6548\u7387\uff0c\u4f46\u662f\u8fd9\u4e2a\u6848\u4f8b\u7a0d\u5fae\u590d\u6742\u4e86\u70b9\uff0c\u6211\u4eec\u5bf9\u5176\u8fdb\u884c\u7b80\u5316\u3002"),(0,i.kt)("p",null,"\u7b80\u5316\u8bbe\u5b9a\uff1a\u5728\u65b9\u6cd5\u6267\u884c\u524d\u8f93\u51fa\u5f53\u524d\u7cfb\u7edf\u65f6\u95f4\u3002"),(0,i.kt)("p",null,"\u5bf9\u4e8eSpringAOP\u7684\u5f00\u53d1\u6709\u4e24\u79cd\u65b9\u5f0f\uff0cXML \u548c \u6ce8\u89e3\uff0c\u6211\u4eec\u4f7f\u7528\u54ea\u4e2a\u5462?"),(0,i.kt)("p",null,"\u56e0\u4e3a\u73b0\u5728\u6ce8\u89e3\u4f7f\u7528\u7684\u6bd4\u8f83\u591a\uff0c\u6240\u4ee5\u672c\u6b21\u8bfe\u7a0b\u5c31\u91c7\u7528\u6ce8\u89e3\u5b8c\u6210AOP\u7684\u5f00\u53d1\u3002"),(0,i.kt)("p",null,"\u603b\u7ed3\u9700\u6c42\u4e3a:\u4f7f\u7528SpringAOP\u7684\u6ce8\u89e3\u65b9\u5f0f\u5b8c\u6210\u5728\u65b9\u6cd5\u6267\u884c\u7684\u524d\u6253\u5370\u51fa\u5f53\u524d\u7cfb\u7edf\u65f6\u95f4\u3002"),(0,i.kt)("h3",{id:"\u601d\u8def\u5206\u6790"},"\u601d\u8def\u5206\u6790"),(0,i.kt)("p",null,"\u9700\u6c42\u660e\u786e\u540e\uff0c\u5177\u4f53\u8be5\u5982\u4f55\u5b9e\u73b0\uff0c\u90fd\u6709\u54ea\u4e9b\u6b65\u9aa4\uff0c\u6211\u4eec\u5148\u6765\u5206\u6790\u4e0b:"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"1.\u5bfc\u5165\u5750\u6807(pom.xml)"),(0,i.kt)("p",{parentName:"blockquote"},"2.\u5236\u4f5c\u8fde\u63a5\u70b9(\u539f\u59cb\u64cd\u4f5c\uff0cDao\u63a5\u53e3\u4e0e\u5b9e\u73b0\u7c7b)"),(0,i.kt)("p",{parentName:"blockquote"},"3.\u5236\u4f5c\u5171\u6027\u529f\u80fd(\u901a\u77e5\u7c7b\u4e0e\u901a\u77e5)"),(0,i.kt)("p",{parentName:"blockquote"},"4.\u5b9a\u4e49\u5207\u5165\u70b9"),(0,i.kt)("p",{parentName:"blockquote"},"5.\u7ed1\u5b9a\u5207\u5165\u70b9\u4e0e\u901a\u77e5\u5173\u7cfb(\u5207\u9762)")),(0,i.kt)("h3",{id:"\u73af\u5883\u51c6\u5907"},"\u73af\u5883\u51c6\u5907"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u521b\u5efa\u4e00\u4e2aMaven\u9879\u76ee")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"pom.xml\u6dfb\u52a0Spring\u4f9d\u8d56"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-xml"},"<dependencies>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-context</artifactId>\n        <version>5.2.10.RELEASE</version>\n    </dependency>\n</dependencies>\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6dfb\u52a0BookDao\u548cBookDaoImpl\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public interface BookDao {\n    public void save();\n    public void update();\n}\n\n@Repository\npublic class BookDaoImpl implements BookDao {\n\n    public void save() {\n        System.out.println(System.currentTimeMillis());\n        System.out.println("book dao save ...");\n    }\n\n    public void update(){\n        System.out.println("book dao update ...");\n    }\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u521b\u5efaSpring\u7684\u914d\u7f6e\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\n@ComponentScan("com.wrm244")\npublic class SpringConfig {\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u7f16\u5199App\u8fd0\u884c\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class App {\n    public static void main(String[] args) {\n        ApplicationContext ctx = new AnnotationConfigApplicationContext(SpringConfig.class);\n        BookDao bookDao = ctx.getBean(BookDao.class);\n        bookDao.save();\n    }\n}\n")))),(0,i.kt)("p",null,"\u6700\u7ec8\u521b\u5efa\u597d\u7684\u9879\u76ee\u7ed3\u6784\u5982\u4e0b:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630167092142",src:t(84082).Z,width:"414",height:"312"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u8bf4\u660e:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u76ee\u524d\u6253\u5370save\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u65b9\u6cd5\u4e2d\u6709\u6253\u5370\u7cfb\u7edf\u65f6\u95f4\uff0c\u6240\u4ee5\u8fd0\u884c\u7684\u65f6\u5019\u662f\u53ef\u4ee5\u770b\u5230\u7cfb\u7edf\u65f6\u95f4"),(0,i.kt)("li",{parentName:"ul"},"\u5bf9\u4e8eupdate\u65b9\u6cd5\u6765\u8bf4\uff0c\u5c31\u6ca1\u6709\u8be5\u529f\u80fd"),(0,i.kt)("li",{parentName:"ul"},"\u6211\u4eec\u8981\u4f7f\u7528SpringAOP\u7684\u65b9\u5f0f\u5728\u4e0d\u6539\u53d8update\u65b9\u6cd5\u7684\u524d\u63d0\u4e0b\u8ba9\u5176\u5177\u6709\u6253\u5370\u7cfb\u7edf\u65f6\u95f4\u7684\u529f\u80fd\u3002")),(0,i.kt)("h3",{id:"aop\u5b9e\u73b0\u6b65\u9aa4"},"AOP\u5b9e\u73b0\u6b65\u9aa4"),(0,i.kt)("h4",{id:"\u6b65\u9aa41\u6dfb\u52a0\u4f9d\u8d56"},"\u6b65\u9aa41:\u6dfb\u52a0\u4f9d\u8d56"),(0,i.kt)("p",null,"pom.xml"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>org.aspectj</groupId>\n    <artifactId>aspectjweaver</artifactId>\n    <version>1.9.4</version>\n</dependency>\n")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630146885493",src:t(36252).Z,width:"525",height:"145"})),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u56e0\u4e3a",(0,i.kt)("inlineCode",{parentName:"li"},"spring-context"),"\u4e2d\u5df2\u7ecf\u5bfc\u5165\u4e86",(0,i.kt)("inlineCode",{parentName:"li"},"spring-aop"),",\u6240\u4ee5\u4e0d\u9700\u8981\u518d\u5355\u72ec\u5bfc\u5165",(0,i.kt)("inlineCode",{parentName:"li"},"spring-aop")),(0,i.kt)("li",{parentName:"ul"},"\u5bfc\u5165AspectJ\u7684jar\u5305,AspectJ\u662fAOP\u601d\u60f3\u7684\u4e00\u4e2a\u5177\u4f53\u5b9e\u73b0\uff0cSpring\u6709\u81ea\u5df1\u7684AOP\u5b9e\u73b0\uff0c\u4f46\u662f\u76f8\u6bd4\u4e8eAspectJ\u6765\u8bf4\u6bd4\u8f83\u9ebb\u70e6\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u91c7\u7528Spring\u6574\u5408ApsectJ\u7684\u65b9\u5f0f\u8fdb\u884cAOP\u5f00\u53d1\u3002")),(0,i.kt)("h4",{id:"\u6b65\u9aa42\u5b9a\u4e49\u63a5\u53e3\u4e0e\u5b9e\u73b0\u7c7b"},"\u6b65\u9aa42:\u5b9a\u4e49\u63a5\u53e3\u4e0e\u5b9e\u73b0\u7c7b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"\u73af\u5883\u51c6\u5907\u7684\u65f6\u5019\uff0cBookDaoImpl\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u4e0d\u9700\u8981\u505a\u4efb\u4f55\u4fee\u6539\n")),(0,i.kt)("h4",{id:"\u6b65\u9aa43\u5b9a\u4e49\u901a\u77e5\u7c7b\u548c\u901a\u77e5"},"\u6b65\u9aa43:\u5b9a\u4e49\u901a\u77e5\u7c7b\u548c\u901a\u77e5"),(0,i.kt)("p",null,"\u901a\u77e5\u5c31\u662f\u5c06\u5171\u6027\u529f\u80fd\u62bd\u53d6\u51fa\u6765\u540e\u5f62\u6210\u7684\u65b9\u6cd5\uff0c\u5171\u6027\u529f\u80fd\u6307\u7684\u5c31\u662f\u5f53\u524d\u7cfb\u7edf\u65f6\u95f4\u7684\u6253\u5370\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class MyAdvice {\n    public void method(){\n        System.out.println(System.currentTimeMillis());\n    }\n}\n")),(0,i.kt)("p",null,"\u7c7b\u540d\u548c\u65b9\u6cd5\u540d\u6ca1\u6709\u8981\u6c42\uff0c\u53ef\u4ee5\u4efb\u610f\u3002"),(0,i.kt)("h4",{id:"\u6b65\u9aa44\u5b9a\u4e49\u5207\u5165\u70b9"},"\u6b65\u9aa44:\u5b9a\u4e49\u5207\u5165\u70b9"),(0,i.kt)("p",null,"BookDaoImpl\u4e2d\u6709\u4e24\u4e2a\u65b9\u6cd5\uff0c\u5206\u522b\u662fsave\u548cupdate\uff0c\u6211\u4eec\u8981\u589e\u5f3a\u7684\u662fupdate\u65b9\u6cd5\uff0c\u8be5\u5982\u4f55\u5b9a\u4e49\u5462?"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class MyAdvice {\n    @Pointcut("execution(void com.wrm244.dao.BookDao.update())")\n    private void pt(){}\n    public void method(){\n        System.out.println(System.currentTimeMillis());\n    }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u8bf4\u660e:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5207\u5165\u70b9\u5b9a\u4e49\u4f9d\u6258\u4e00\u4e2a\u4e0d\u5177\u6709\u5b9e\u9645\u610f\u4e49\u7684\u65b9\u6cd5\u8fdb\u884c\uff0c\u5373\u65e0\u53c2\u6570\u3001\u65e0\u8fd4\u56de\u503c\u3001\u65b9\u6cd5\u4f53\u65e0\u5b9e\u9645\u903b\u8f91\u3002"),(0,i.kt)("li",{parentName:"ul"},"execution\u53ca\u540e\u9762\u7f16\u5199\u7684\u5185\u5bb9\uff0c\u540e\u9762\u4f1a\u6709\u7ae0\u8282\u4e13\u95e8\u53bb\u5b66\u4e60\u3002")),(0,i.kt)("h4",{id:"\u6b65\u9aa45\u5236\u4f5c\u5207\u9762"},"\u6b65\u9aa45:\u5236\u4f5c\u5207\u9762"),(0,i.kt)("p",null,"\u5207\u9762\u662f\u7528\u6765\u63cf\u8ff0\u901a\u77e5\u548c\u5207\u5165\u70b9\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u5982\u4f55\u8fdb\u884c\u5173\u7cfb\u7684\u7ed1\u5b9a?"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class MyAdvice {\n    @Pointcut("execution(void com.wrm244.dao.BookDao.update())")\n    private void pt(){}\n    \n    @Before("pt()")\n    public void method(){\n        System.out.println(System.currentTimeMillis());\n    }\n}\n')),(0,i.kt)("p",null,"\u7ed1\u5b9a\u5207\u5165\u70b9\u4e0e\u901a\u77e5\u5173\u7cfb\uff0c\u5e76\u6307\u5b9a\u901a\u77e5\u6dfb\u52a0\u5230\u539f\u59cb\u8fde\u63a5\u70b9\u7684\u5177\u4f53\u6267\u884c\u4f4d\u7f6e"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630148447689",src:t(95673).Z,width:"1491",height:"446"})),(0,i.kt)("p",null,"*",(0,i.kt)("em",{parentName:"p"},"\u8bf4\u660e:"),"- @Before\u7ffb\u8bd1\u8fc7\u6765\u662f\u4e4b\u524d\uff0c\u4e5f\u5c31\u662f\u8bf4\u901a\u77e5\u4f1a\u5728\u5207\u5165\u70b9\u65b9\u6cd5\u6267\u884c\u4e4b\u524d\u6267\u884c\uff0c\u9664\u6b64\u4e4b\u524d\u8fd8\u6709\u5176\u4ed6\u56db\u79cd\u7c7b\u578b\uff0c\u540e\u9762\u4f1a\u8bb2\u3002"),(0,i.kt)("h4",{id:"\u6b65\u9aa46\u5c06\u901a\u77e5\u7c7b\u914d\u7ed9\u5bb9\u5668\u5e76\u6807\u8bc6\u5176\u4e3a\u5207\u9762\u7c7b"},"\u6b65\u9aa46:\u5c06\u901a\u77e5\u7c7b\u914d\u7ed9\u5bb9\u5668\u5e76\u6807\u8bc6\u5176\u4e3a\u5207\u9762\u7c7b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(void com.wrm244.dao.BookDao.update())")\n    private void pt(){}\n    \n    @Before("pt()")\n    public void method(){\n        System.out.println(System.currentTimeMillis());\n    }\n}\n')),(0,i.kt)("h4",{id:"\u6b65\u9aa47\u5f00\u542f\u6ce8\u89e3\u683c\u5f0faop\u529f\u80fd"},"\u6b65\u9aa47:\u5f00\u542f\u6ce8\u89e3\u683c\u5f0fAOP\u529f\u80fd"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\n@ComponentScan("com.wrm244")\n@EnableAspectJAutoProxy\npublic class SpringConfig {\n}\n')),(0,i.kt)("h4",{id:"\u6b65\u9aa48\u8fd0\u884c\u7a0b\u5e8f"},"\u6b65\u9aa48:\u8fd0\u884c\u7a0b\u5e8f"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class App {\n    public static void main(String[] args) {\n        ApplicationContext ctx = new AnnotationConfigApplicationContext(SpringConfig.class);\n        BookDao bookDao = ctx.getBean(BookDao.class);\n        bookDao.update();\n    }\n}\n")),(0,i.kt)("p",null,"\u770b\u5230\u5728\u6267\u884cupdate\u65b9\u6cd5\u4e4b\u524d\u6253\u5370\u4e86\u7cfb\u7edf\u65f6\u95f4\u6233\uff0c\u8bf4\u660e\u5bf9\u539f\u59cb\u65b9\u6cd5\u8fdb\u884c\u4e86\u589e\u5f3a\uff0cAOP\u7f16\u7a0b\u6210\u529f\u3002"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630147945888",src:t(65532).Z,width:"609",height:"246"})),(0,i.kt)("h3",{id:"\u77e5\u8bc6\u70b91enableaspectjautoproxy"},"\u77e5\u8bc6\u70b91\uff1a@EnableAspectJAutoProxy"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,i.kt)("th",{parentName:"tr",align:null},"@EnableAspectJAutoProxy"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,i.kt)("td",{parentName:"tr",align:null},"\u914d\u7f6e\u7c7b\u6ce8\u89e3")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f4d\u7f6e"),(0,i.kt)("td",{parentName:"tr",align:null},"\u914d\u7f6e\u7c7b\u5b9a\u4e49\u4e0a\u65b9")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f5c\u7528"),(0,i.kt)("td",{parentName:"tr",align:null},"\u5f00\u542f\u6ce8\u89e3\u683c\u5f0fAOP\u529f\u80fd")))),(0,i.kt)("h3",{id:"\u77e5\u8bc6\u70b92aspect"},"\u77e5\u8bc6\u70b92\uff1a@Aspect"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,i.kt)("th",{parentName:"tr",align:null},"@Aspect"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,i.kt)("td",{parentName:"tr",align:null},"\u7c7b\u6ce8\u89e3")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f4d\u7f6e"),(0,i.kt)("td",{parentName:"tr",align:null},"\u5207\u9762\u7c7b\u5b9a\u4e49\u4e0a\u65b9")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f5c\u7528"),(0,i.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u5f53\u524d\u7c7b\u4e3aAOP\u5207\u9762\u7c7b")))),(0,i.kt)("h3",{id:"\u77e5\u8bc6\u70b93pointcut"},"\u77e5\u8bc6\u70b93\uff1a@Pointcut"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,i.kt)("th",{parentName:"tr",align:null},"@Pointcut"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,i.kt)("td",{parentName:"tr",align:null},"\u65b9\u6cd5\u6ce8\u89e3")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f4d\u7f6e"),(0,i.kt)("td",{parentName:"tr",align:null},"\u5207\u5165\u70b9\u65b9\u6cd5\u5b9a\u4e49\u4e0a\u65b9")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f5c\u7528"),(0,i.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u5207\u5165\u70b9\u65b9\u6cd5")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u5c5e\u6027"),(0,i.kt)("td",{parentName:"tr",align:null},"value\uff08\u9ed8\u8ba4\uff09\uff1a\u5207\u5165\u70b9\u8868\u8fbe\u5f0f")))),(0,i.kt)("h3",{id:"\u77e5\u8bc6\u70b94before"},"\u77e5\u8bc6\u70b94\uff1a@Before"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,i.kt)("th",{parentName:"tr",align:null},"@Before"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,i.kt)("td",{parentName:"tr",align:null},"\u65b9\u6cd5\u6ce8\u89e3")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f4d\u7f6e"),(0,i.kt)("td",{parentName:"tr",align:null},"\u901a\u77e5\u65b9\u6cd5\u5b9a\u4e49\u4e0a\u65b9")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f5c\u7528"),(0,i.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u65b9\u6cd5\u4e0e\u5207\u5165\u70b9\u4e4b\u95f4\u7684\u7ed1\u5b9a\u5173\u7cfb\uff0c\u5f53\u524d\u901a\u77e5\u65b9\u6cd5\u5728\u539f\u59cb\u5207\u5165\u70b9\u65b9\u6cd5\u524d\u8fd0\u884c")))),(0,i.kt)("h2",{id:"aop\u5de5\u4f5c\u6d41\u7a0b"},"AOP\u5de5\u4f5c\u6d41\u7a0b"),(0,i.kt)("p",null,"AOP\u7684\u5165\u95e8\u6848\u4f8b\u5df2\u7ecf\u5b8c\u6210\uff0c\u5bf9\u4e8e\u521a\u624d\u6848\u4f8b\u7684\u6267\u884c\u8fc7\u7a0b\uff0c\u6211\u4eec\u5c31\u5f97\u6765\u5206\u6790\u5206\u6790\uff0c\u8fd9\u4e00\u8282\u6211\u4eec\u4e3b\u8981\u8bb2\u89e3\u4e24\u4e2a\u77e5\u8bc6\u70b9:",(0,i.kt)("inlineCode",{parentName:"p"},"AOP\u5de5\u4f5c\u6d41\u7a0b"),"\u548c",(0,i.kt)("inlineCode",{parentName:"p"},"AOP\u6838\u5fc3\u6982\u5ff5"),"\u3002\u5176\u4e2d\u6838\u5fc3\u6982\u5ff5\u662f\u5bf9\u524d\u9762\u6838\u5fc3\u6982\u5ff5\u7684\u8865\u5145\u3002"),(0,i.kt)("h3",{id:"aop\u5de5\u4f5c\u6d41\u7a0b-1"},"AOP\u5de5\u4f5c\u6d41\u7a0b"),(0,i.kt)("p",null,"\u7531\u4e8eAOP\u662f\u57fa\u4e8eSpring\u5bb9\u5668\u7ba1\u7406\u7684bean\u505a\u7684\u589e\u5f3a\uff0c\u6240\u4ee5\u6574\u4e2a\u5de5\u4f5c\u8fc7\u7a0b\u9700\u8981\u4eceSpring\u52a0\u8f7dbean\u8bf4\u8d77:"),(0,i.kt)("h4",{id:"\u6d41\u7a0b1spring\u5bb9\u5668\u542f\u52a8"},"\u6d41\u7a0b1:Spring\u5bb9\u5668\u542f\u52a8"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5bb9\u5668\u542f\u52a8\u5c31\u9700\u8981\u53bb\u52a0\u8f7dbean,\u54ea\u4e9b\u7c7b\u9700\u8981\u88ab\u52a0\u8f7d\u5462?"),(0,i.kt)("li",{parentName:"ul"},"\u9700\u8981\u88ab\u589e\u5f3a\u7684\u7c7b\uff0c\u5982:BookServiceImpl"),(0,i.kt)("li",{parentName:"ul"},"\u901a\u77e5\u7c7b\uff0c\u5982:MyAdvice"),(0,i.kt)("li",{parentName:"ul"},"\u6ce8\u610f\u6b64\u65f6bean\u5bf9\u8c61\u8fd8\u6ca1\u6709\u521b\u5efa\u6210\u529f")),(0,i.kt)("h4",{id:"\u6d41\u7a0b2\u8bfb\u53d6\u6240\u6709\u5207\u9762\u914d\u7f6e\u4e2d\u7684\u5207\u5165\u70b9"},"\u6d41\u7a0b2:\u8bfb\u53d6\u6240\u6709\u5207\u9762\u914d\u7f6e\u4e2d\u7684\u5207\u5165\u70b9"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630151682428",src:t(66181).Z,width:"1401",height:"677"})),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u6709\u4e24\u4e2a\u5207\u5165\u70b9\u7684\u914d\u7f6e\uff0c\u4f46\u662f\u7b2c\u4e00\u4e2a",(0,i.kt)("inlineCode",{parentName:"li"},"ptx()"),"\u5e76\u6ca1\u6709\u88ab\u4f7f\u7528\uff0c\u6240\u4ee5\u4e0d\u4f1a\u88ab\u8bfb\u53d6\u3002")),(0,i.kt)("h4",{id:"\u6d41\u7a0b3\u521d\u59cb\u5316bean"},"\u6d41\u7a0b3:\u521d\u59cb\u5316bean\uff0c"),(0,i.kt)("p",null,"\u5224\u5b9abean\u5bf9\u5e94\u7684\u7c7b\u4e2d\u7684\u65b9\u6cd5\u662f\u5426\u5339\u914d\u5230\u4efb\u610f\u5207\u5165\u70b9"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6ce8\u610f\u7b2c1\u6b65\u5728\u5bb9\u5668\u542f\u52a8\u7684\u65f6\u5019\uff0cbean\u5bf9\u8c61\u8fd8\u6ca1\u6709\u88ab\u521b\u5efa\u6210\u529f\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u8981\u88ab\u5b9e\u4f8b\u5316bean\u5bf9\u8c61\u7684\u7c7b\u4e2d\u7684\u65b9\u6cd5\u548c\u5207\u5165\u70b9\u8fdb\u884c\u5339\u914d"),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("img",{alt:"1630152538083",src:t(97726).Z,width:"1733",height:"1019"})),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u5339\u914d\u5931\u8d25\uff0c\u521b\u5efa\u539f\u59cb\u5bf9\u8c61,\u5982",(0,i.kt)("inlineCode",{parentName:"li"},"UserDao"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u5339\u914d\u5931\u8d25\u8bf4\u660e\u4e0d\u9700\u8981\u589e\u5f3a\uff0c\u76f4\u63a5\u8c03\u7528\u539f\u59cb\u5bf9\u8c61\u7684\u65b9\u6cd5\u5373\u53ef\u3002"))),(0,i.kt)("li",{parentName:"ul"},"\u5339\u914d\u6210\u529f\uff0c\u521b\u5efa\u539f\u59cb\u5bf9\u8c61\uff08\u76ee\u6807\u5bf9\u8c61\uff09\u7684\u4ee3\u7406\u5bf9\u8c61,\u5982:",(0,i.kt)("inlineCode",{parentName:"li"},"BookDao"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u5339\u914d\u6210\u529f\u8bf4\u660e\u9700\u8981\u5bf9\u5176\u8fdb\u884c\u589e\u5f3a"),(0,i.kt)("li",{parentName:"ul"},"\u5bf9\u54ea\u4e2a\u7c7b\u505a\u589e\u5f3a\uff0c\u8fd9\u4e2a\u7c7b\u5bf9\u5e94\u7684\u5bf9\u8c61\u5c31\u53eb\u505a\u76ee\u6807\u5bf9\u8c61"),(0,i.kt)("li",{parentName:"ul"},"\u56e0\u4e3a\u8981\u5bf9\u76ee\u6807\u5bf9\u8c61\u8fdb\u884c\u529f\u80fd\u589e\u5f3a\uff0c\u800c\u91c7\u7528\u7684\u6280\u672f\u662f\u52a8\u6001\u4ee3\u7406\uff0c\u6240\u4ee5\u4f1a\u4e3a\u5176\u521b\u5efa\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61"),(0,i.kt)("li",{parentName:"ul"},"\u6700\u7ec8\u8fd0\u884c\u7684\u662f\u4ee3\u7406\u5bf9\u8c61\u7684\u65b9\u6cd5\uff0c\u5728\u8be5\u65b9\u6cd5\u4e2d\u4f1a\u5bf9\u539f\u59cb\u65b9\u6cd5\u8fdb\u884c\u529f\u80fd\u589e\u5f3a")))))),(0,i.kt)("h4",{id:"\u6d41\u7a0b4\u83b7\u53d6bean\u6267\u884c\u65b9\u6cd5"},"\u6d41\u7a0b4:\u83b7\u53d6bean\u6267\u884c\u65b9\u6cd5"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u7684bean\u662f\u539f\u59cb\u5bf9\u8c61\u65f6\uff0c\u8c03\u7528\u65b9\u6cd5\u5e76\u6267\u884c\uff0c\u5b8c\u6210\u64cd\u4f5c"),(0,i.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u7684bean\u662f\u4ee3\u7406\u5bf9\u8c61\u65f6\uff0c\u6839\u636e\u4ee3\u7406\u5bf9\u8c61\u7684\u8fd0\u884c\u6a21\u5f0f\u8fd0\u884c\u539f\u59cb\u65b9\u6cd5\u4e0e\u589e\u5f3a\u7684\u5185\u5bb9\uff0c\u5b8c\u6210\u64cd\u4f5c")),(0,i.kt)("h4",{id:"\u9a8c\u8bc1\u5bb9\u5668\u4e2d\u662f\u5426\u4e3a\u4ee3\u7406\u5bf9\u8c61"},"\u9a8c\u8bc1\u5bb9\u5668\u4e2d\u662f\u5426\u4e3a\u4ee3\u7406\u5bf9\u8c61"),(0,i.kt)("p",null,"\u4e3a\u4e86\u9a8c\u8bc1IOC\u5bb9\u5668\u4e2d\u521b\u5efa\u7684\u5bf9\u8c61\u548c\u6211\u4eec\u521a\u624d\u6240\u8bf4\u7684\u7ed3\u8bba\u662f\u5426\u4e00\u81f4\uff0c\u9996\u5148\u5148\u628a\u7ed3\u8bba\u7406\u51fa\u6765:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u4e2d\u7684\u65b9\u6cd5\u4f1a\u88ab\u589e\u5f3a\uff0c\u90a3\u4e48\u5bb9\u5668\u4e2d\u5c06\u5b58\u5165\u7684\u662f\u76ee\u6807\u5bf9\u8c61\u7684\u4ee3\u7406\u5bf9\u8c61"),(0,i.kt)("li",{parentName:"ul"},"\u5982\u679c\u76ee\u6807\u5bf9\u8c61\u4e2d\u7684\u65b9\u6cd5\u4e0d\u88ab\u589e\u5f3a\uff0c\u90a3\u4e48\u5bb9\u5668\u4e2d\u5c06\u5b58\u5165\u7684\u662f\u76ee\u6807\u5bf9\u8c61\u672c\u8eab\u3002")),(0,i.kt)("h5",{id:"\u9a8c\u8bc1\u601d\u8def"},"\u9a8c\u8bc1\u601d\u8def"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"1.\u8981\u6267\u884c\u7684\u65b9\u6cd5\uff0c\u4e0d\u88ab\u5b9a\u4e49\u7684\u5207\u5165\u70b9\u5305\u542b\uff0c\u5373\u4e0d\u8981\u589e\u5f3a\uff0c\u6253\u5370\u5f53\u524d\u7c7b\u7684getClass()\u65b9\u6cd5"),(0,i.kt)("p",{parentName:"blockquote"},"2.\u8981\u6267\u884c\u7684\u65b9\u6cd5\uff0c\u88ab\u5b9a\u4e49\u7684\u5207\u5165\u70b9\u5305\u542b\uff0c\u5373\u8981\u589e\u5f3a\uff0c\u6253\u5370\u51fa\u5f53\u524d\u7c7b\u7684getClass()\u65b9\u6cd5"),(0,i.kt)("p",{parentName:"blockquote"},"3.\u89c2\u5bdf\u4e24\u6b21\u6253\u5370\u7684\u7ed3\u679c")),(0,i.kt)("h5",{id:"\u6b65\u9aa41\u4fee\u6539app\u7c7b\u83b7\u53d6\u7c7b\u7684\u7c7b\u578b"},"\u6b65\u9aa41:\u4fee\u6539App\u7c7b,\u83b7\u53d6\u7c7b\u7684\u7c7b\u578b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class App {\n    public static void main(String[] args) {\n        ApplicationContext ctx = new AnnotationConfigApplicationContext(SpringConfig.class);\n        BookDao bookDao = ctx.getBean(BookDao.class);\n        System.out.println(bookDao);\n        System.out.println(bookDao.getClass());\n    }\n}\n")),(0,i.kt)("h5",{id:"\u6b65\u9aa42\u4fee\u6539myadvice\u7c7b\u4e0d\u589e\u5f3a"},"\u6b65\u9aa42:\u4fee\u6539MyAdvice\u7c7b\uff0c\u4e0d\u589e\u5f3a"),(0,i.kt)("p",null,"\u56e0\u4e3a\u5b9a\u4e49\u7684\u5207\u5165\u70b9\u4e2d\uff0c\u88ab\u4fee\u6539\u6210",(0,i.kt)("inlineCode",{parentName:"p"},"update1"),",\u6240\u4ee5BookDao\u4e2d\u7684update\u65b9\u6cd5\u5728\u6267\u884c\u7684\u65f6\u5019\uff0c\u5c31\u4e0d\u4f1a\u88ab\u589e\u5f3a\uff0c"),(0,i.kt)("p",null,"\u6240\u4ee5\u5bb9\u5668\u4e2d\u7684\u5bf9\u8c61\u5e94\u8be5\u662f\u76ee\u6807\u5bf9\u8c61\u672c\u8eab\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(void com.wrm244.dao.BookDao.update1())")\n    private void pt(){}\n    \n    @Before("pt()")\n    public void method(){\n        System.out.println(System.currentTimeMillis());\n    }\n}\n')),(0,i.kt)("h5",{id:"\u6b65\u9aa43\u8fd0\u884c\u7a0b\u5e8f"},"\u6b65\u9aa43:\u8fd0\u884c\u7a0b\u5e8f"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630154495165",src:t(4223).Z,width:"924",height:"220"})),(0,i.kt)("h5",{id:"\u6b65\u9aa44\u4fee\u6539myadvice\u7c7b\u589e\u5f3a"},"\u6b65\u9aa44:\u4fee\u6539MyAdvice\u7c7b\uff0c\u589e\u5f3a"),(0,i.kt)("p",null,"\u56e0\u4e3a\u5b9a\u4e49\u7684\u5207\u5165\u70b9\u4e2d\uff0c\u88ab\u4fee\u6539\u6210",(0,i.kt)("inlineCode",{parentName:"p"},"update"),",\u6240\u4ee5BookDao\u4e2d\u7684update\u65b9\u6cd5\u5728\u6267\u884c\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u88ab\u589e\u5f3a\uff0c"),(0,i.kt)("p",null,"\u6240\u4ee5\u5bb9\u5668\u4e2d\u7684\u5bf9\u8c61\u5e94\u8be5\u662f\u76ee\u6807\u5bf9\u8c61\u7684\u4ee3\u7406\u5bf9\u8c61"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(void com.wrm244.dao.BookDao.update())")\n    private void pt(){}\n    \n    @Before("pt()")\n    public void method(){\n        System.out.println(System.currentTimeMillis());\n    }\n}\n')),(0,i.kt)("h5",{id:"\u6b65\u9aa45\u8fd0\u884c\u7a0b\u5e8f"},"\u6b65\u9aa45:\u8fd0\u884c\u7a0b\u5e8f"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630154625564",src:t(42478).Z,width:"798",height:"232"})),(0,i.kt)("p",null,"\u81f3\u6b64\u5bf9\u4e8e\u521a\u624d\u7684\u7ed3\u8bba\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u9a8c\u8bc1\uff0c\u8fd9\u5757\u5927\u5bb6\u9700\u8981\u6ce8\u610f\u7684\u662f:"),(0,i.kt)("p",null,"\u4e0d\u80fd\u76f4\u63a5\u6253\u5370\u5bf9\u8c61\uff0c\u4ece\u4e0a\u9762\u4e24\u6b21\u7ed3\u679c\u4e2d\u53ef\u4ee5\u770b\u51fa\uff0c\u76f4\u63a5\u6253\u5370\u5bf9\u8c61\u8d70\u7684\u662f\u5bf9\u8c61\u7684toString\u65b9\u6cd5\uff0c\u4e0d\u7ba1\u662f\u4e0d\u662f\u4ee3\u7406\u5bf9\u8c61\u6253\u5370\u7684\u7ed3\u679c\u90fd\u662f\u4e00\u6837\u7684\uff0c\u539f\u56e0\u662f\u5185\u90e8\u5bf9toString\u65b9\u6cd5\u8fdb\u884c\u4e86\u91cd\u5199\u3002"),(0,i.kt)("h3",{id:"aop\u6838\u5fc3\u6982\u5ff5-1"},"AOP\u6838\u5fc3\u6982\u5ff5"),(0,i.kt)("p",null,"\u5728\u4e0a\u9762\u4ecb\u7ecdAOP\u7684\u5de5\u4f5c\u6d41\u7a0b\u4e2d\uff0c\u6211\u4eec\u63d0\u5230\u4e86\u4e24\u4e2a\u6838\u5fc3\u6982\u5ff5\uff0c\u5206\u522b\u662f:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u76ee\u6807\u5bf9\u8c61(Target)\uff1a\u539f\u59cb\u529f\u80fd\u53bb\u6389\u5171\u6027\u529f\u80fd\u5bf9\u5e94\u7684\u7c7b\u4ea7\u751f\u7684\u5bf9\u8c61\uff0c\u8fd9\u79cd\u5bf9\u8c61\u662f\u65e0\u6cd5\u76f4\u63a5\u5b8c\u6210\u6700\u7ec8\u5de5\u4f5c\u7684"),(0,i.kt)("li",{parentName:"ul"},"\u4ee3\u7406(Proxy)\uff1a\u76ee\u6807\u5bf9\u8c61\u65e0\u6cd5\u76f4\u63a5\u5b8c\u6210\u5de5\u4f5c\uff0c\u9700\u8981\u5bf9\u5176\u8fdb\u884c\u529f\u80fd\u56de\u586b\uff0c\u901a\u8fc7\u539f\u59cb\u5bf9\u8c61\u7684\u4ee3\u7406\u5bf9\u8c61\u5b9e\u73b0")),(0,i.kt)("p",null,"\u4e0a\u9762\u8fd9\u4e24\u4e2a\u6982\u5ff5\u6bd4\u8f83\u62bd\u8c61\uff0c\u7b80\u5355\u6765\u8bf4\uff0c"),(0,i.kt)("p",null,"\u76ee\u6807\u5bf9\u8c61\u5c31\u662f\u8981\u589e\u5f3a\u7684\u7c7b","[\u5982:BookServiceImpl\u7c7b]","\u5bf9\u5e94\u7684\u5bf9\u8c61\uff0c\u4e5f\u53eb\u539f\u59cb\u5bf9\u8c61\uff0c\u4e0d\u80fd\u8bf4\u5b83\u4e0d\u80fd\u8fd0\u884c\uff0c\u53ea\u80fd\u8bf4\u5b83\u5728\u8fd0\u884c\u7684\u8fc7\u7a0b\u4e2d\u5bf9\u4e8e\u8981\u589e\u5f3a\u7684\u5185\u5bb9\u662f\u7f3a\u5931\u7684\u3002"),(0,i.kt)("p",null,"SpringAOP\u662f\u5728\u4e0d\u6539\u53d8\u539f\u6709\u8bbe\u8ba1(\u4ee3\u7801)\u7684\u524d\u63d0\u4e0b\u5bf9\u5176\u8fdb\u884c\u589e\u5f3a\u7684\uff0c\u5b83\u7684\u5e95\u5c42\u91c7\u7528\u7684\u662f\u4ee3\u7406\u6a21\u5f0f\u5b9e\u73b0\u7684\uff0c\u6240\u4ee5\u8981\u5bf9\u539f\u59cb\u5bf9\u8c61\u8fdb\u884c\u589e\u5f3a\uff0c\u5c31\u9700\u8981\u5bf9\u539f\u59cb\u5bf9\u8c61\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\uff0c\u5728\u4ee3\u7406\u5bf9\u8c61\u4e2d\u7684\u65b9\u6cd5\u628a\u901a\u77e5","[\u5982:MyAdvice\u4e2d\u7684method\u65b9\u6cd5]","\u5185\u5bb9\u52a0\u8fdb\u53bb\uff0c\u5c31\u5b9e\u73b0\u4e86\u589e\u5f3a,\u8fd9\u5c31\u662f\u6211\u4eec\u6240\u8bf4\u7684\u4ee3\u7406(Proxy)\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u5c0f\u7ed3")),(0,i.kt)("p",null,"\u901a\u8fc7\u8fd9\u4e00\u8282\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u638c\u63e1\u7684\u5185\u5bb9\u6709\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u80fd\u8bf4\u51faAOP\u7684\u5de5\u4f5c\u6d41\u7a0b"),(0,i.kt)("li",{parentName:"ul"},"AOP\u7684\u6838\u5fc3\u6982\u5ff5",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u76ee\u6807\u5bf9\u8c61\u3001\u8fde\u63a5\u70b9\u3001\u5207\u5165\u70b9"),(0,i.kt)("li",{parentName:"ul"},"\u901a\u77e5\u7c7b\u3001\u901a\u77e5"),(0,i.kt)("li",{parentName:"ul"},"\u5207\u9762"),(0,i.kt)("li",{parentName:"ul"},"\u4ee3\u7406"))),(0,i.kt)("li",{parentName:"ul"},"SpringAOP\u7684\u672c\u8d28\u6216\u8005\u53ef\u4ee5\u8bf4\u5e95\u5c42\u5b9e\u73b0\u662f\u901a\u8fc7\u4ee3\u7406\u6a21\u5f0f\u3002")),(0,i.kt)("h2",{id:"aop\u914d\u7f6e\u7ba1\u7406"},"AOP\u914d\u7f6e\u7ba1\u7406"),(0,i.kt)("h3",{id:"aop\u5207\u5165\u70b9\u8868\u8fbe\u5f0f"},"AOP\u5207\u5165\u70b9\u8868\u8fbe\u5f0f"),(0,i.kt)("p",null,"\u524d\u9762\u7684\u6848\u4f8b\u4e2d\uff0c\u6709\u6d89\u53ca\u5230\u5982\u4e0b\u5185\u5bb9:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630155937718",src:t(51830).Z,width:"913",height:"229"})),(0,i.kt)("p",null,"\u5bf9\u4e8eAOP\u4e2d\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\uff0c\u6211\u4eec\u603b\u5171\u4f1a\u5b66\u4e60\u4e09\u4e2a\u5185\u5bb9\uff0c\u5206\u522b\u662f",(0,i.kt)("inlineCode",{parentName:"p"},"\u8bed\u6cd5\u683c\u5f0f"),"\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"\u901a\u914d\u7b26"),"\u548c",(0,i.kt)("inlineCode",{parentName:"p"},"\u4e66\u5199\u6280\u5de7"),"\u3002"),(0,i.kt)("h4",{id:"\u8bed\u6cd5\u683c\u5f0f"},"\u8bed\u6cd5\u683c\u5f0f"),(0,i.kt)("p",null,"\u9996\u5148\u6211\u4eec\u5148\u8981\u660e\u786e\u4e24\u4e2a\u6982\u5ff5:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5207\u5165\u70b9:\u8981\u8fdb\u884c\u589e\u5f3a\u7684\u65b9\u6cd5"),(0,i.kt)("li",{parentName:"ul"},"\u5207\u5165\u70b9\u8868\u8fbe\u5f0f:\u8981\u8fdb\u884c\u589e\u5f3a\u7684\u65b9\u6cd5\u7684\u63cf\u8ff0\u65b9\u5f0f")),(0,i.kt)("p",null,"\u5bf9\u4e8e\u5207\u5165\u70b9\u7684\u63cf\u8ff0\uff0c\u6211\u4eec\u5176\u5b9e\u662f\u6709\u4e24\u4e2d\u65b9\u5f0f\u7684\uff0c\u5148\u6765\u770b\u4e0b\u524d\u9762\u7684\u4f8b\u5b50"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630156172790",src:t(24549).Z,width:"1580",height:"226"})),(0,i.kt)("p",null,"\u63cf\u8ff0\u65b9\u5f0f\u4e00\uff1a\u6267\u884ccom.wrm244.dao\u5305\u4e0b\u7684BookDao\u63a5\u53e3\u4e2d\u7684\u65e0\u53c2\u6570update\u65b9\u6cd5"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"execution(void com.wrm244.dao.BookDao.update())\n")),(0,i.kt)("p",null,"\u63cf\u8ff0\u65b9\u5f0f\u4e8c\uff1a\u6267\u884ccom.wrm244.dao.impl\u5305\u4e0b\u7684BookDaoImpl\u7c7b\u4e2d\u7684\u65e0\u53c2\u6570update\u65b9\u6cd5"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"execution(void com.wrm244.dao.impl.BookDaoImpl.update())\n")),(0,i.kt)("p",null,"\u56e0\u4e3a\u8c03\u7528\u63a5\u53e3\u65b9\u6cd5\u7684\u65f6\u5019\u6700\u7ec8\u8fd0\u884c\u7684\u8fd8\u662f\u5176\u5b9e\u73b0\u7c7b\u7684\u65b9\u6cd5\uff0c\u6240\u4ee5\u4e0a\u9762\u4e24\u79cd\u63cf\u8ff0\u65b9\u5f0f\u90fd\u662f\u53ef\u4ee5\u7684\u3002"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u7684\u8bed\u6cd5\u4e3a:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u6807\u51c6\u683c\u5f0f\uff1a\u52a8\u4f5c\u5173\u952e\u5b57(\u8bbf\u95ee\u4fee\u9970\u7b26  \u8fd4\u56de\u503c  \u5305\u540d.\u7c7b/\u63a5\u53e3\u540d.\u65b9\u6cd5\u540d(\u53c2\u6570) \u5f02\u5e38\u540d\uff09")),(0,i.kt)("p",null,"\u5bf9\u4e8e\u8fd9\u4e2a\u683c\u5f0f\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u786c\u8bb0\uff0c\u901a\u8fc7\u4e00\u4e2a\u4f8b\u5b50\uff0c\u7406\u89e3\u5b83:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"execution(public User com.wrm244.service.UserService.findById(int))\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"execution\uff1a\u52a8\u4f5c\u5173\u952e\u5b57\uff0c\u63cf\u8ff0\u5207\u5165\u70b9\u7684\u884c\u4e3a\u52a8\u4f5c\uff0c\u4f8b\u5982execution\u8868\u793a\u6267\u884c\u5230\u6307\u5b9a\u5207\u5165\u70b9"),(0,i.kt)("li",{parentName:"ul"},"public:\u8bbf\u95ee\u4fee\u9970\u7b26,\u8fd8\u53ef\u4ee5\u662fpublic\uff0cprivate\u7b49\uff0c\u53ef\u4ee5\u7701\u7565"),(0,i.kt)("li",{parentName:"ul"},"User\uff1a\u8fd4\u56de\u503c\uff0c\u5199\u8fd4\u56de\u503c\u7c7b\u578b"),(0,i.kt)("li",{parentName:"ul"},"com.wrm244.service\uff1a\u5305\u540d\uff0c\u591a\u7ea7\u5305\u4f7f\u7528\u70b9\u8fde\u63a5"),(0,i.kt)("li",{parentName:"ul"},"UserService:\u7c7b/\u63a5\u53e3\u540d\u79f0"),(0,i.kt)("li",{parentName:"ul"},"findById\uff1a\u65b9\u6cd5\u540d"),(0,i.kt)("li",{parentName:"ul"},"int:\u53c2\u6570\uff0c\u76f4\u63a5\u5199\u53c2\u6570\u7684\u7c7b\u578b\uff0c\u591a\u4e2a\u7c7b\u578b\u7528\u9017\u53f7\u9694\u5f00"),(0,i.kt)("li",{parentName:"ul"},"\u5f02\u5e38\u540d\uff1a\u65b9\u6cd5\u5b9a\u4e49\u4e2d\u629b\u51fa\u6307\u5b9a\u5f02\u5e38\uff0c\u53ef\u4ee5\u7701\u7565")),(0,i.kt)("p",null,"\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u5c31\u662f\u8981\u627e\u5230\u9700\u8981\u589e\u5f3a\u7684\u65b9\u6cd5\uff0c\u6240\u4ee5\u5b83\u5c31\u662f\u5bf9\u4e00\u4e2a\u5177\u4f53\u65b9\u6cd5\u7684\u63cf\u8ff0\uff0c\u4f46\u662f\u65b9\u6cd5\u7684\u5b9a\u4e49\u4f1a\u6709\u5f88\u591a\uff0c\u6240\u4ee5\u5982\u679c\u6bcf\u4e00\u4e2a\u65b9\u6cd5\u5bf9\u5e94\u4e00\u4e2a\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\uff0c\u60f3\u60f3\u8fd9\u5757\u5c31\u4f1a\u89c9\u5f97\u5c06\u6765\u7f16\u5199\u8d77\u6765\u4f1a\u6bd4\u8f83\u9ebb\u70e6\uff0c\u6709\u6ca1\u6709\u66f4\u7b80\u5355\u7684\u65b9\u5f0f\u5462?"),(0,i.kt)("p",null,"\u5c31\u9700\u8981\u7528\u5230\u4e0b\u9762\u6240\u5b66\u4e60\u7684\u901a\u914d\u7b26\u3002"),(0,i.kt)("h4",{id:"\u901a\u914d\u7b26"},"\u901a\u914d\u7b26"),(0,i.kt)("p",null,"\u6211\u4eec\u4f7f\u7528\u901a\u914d\u7b26\u63cf\u8ff0\u5207\u5165\u70b9\uff0c\u4e3b\u8981\u7684\u76ee\u7684\u5c31\u662f\u7b80\u5316\u4e4b\u524d\u7684\u914d\u7f6e\uff0c\u5177\u4f53\u90fd\u6709\u54ea\u4e9b\u901a\u914d\u7b26\u53ef\u4ee5\u4f7f\u7528?"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"*"),":\u5355\u4e2a\u72ec\u7acb\u7684\u4efb\u610f\u7b26\u53f7\uff0c\u53ef\u4ee5\u72ec\u7acb\u51fa\u73b0\uff0c\u4e5f\u53ef\u4ee5\u4f5c\u4e3a\u524d\u7f00\u6216\u8005\u540e\u7f00\u7684\u5339\u914d\u7b26\u51fa\u73b0"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"execution\uff08public - com.wrm244.*.UserService.find*(*))\n")),(0,i.kt)("p",{parentName:"li"},"\u5339\u914dcom.wrm244\u5305\u4e0b\u7684\u4efb\u610f\u5305\u4e2d\u7684UserService\u7c7b\u6216\u63a5\u53e3\u4e2d\u6240\u6709find\u5f00\u5934\u7684\u5e26\u6709\u4e00\u4e2a\u53c2\u6570\u7684\u65b9\u6cd5")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},".."),"\uff1a\u591a\u4e2a\u8fde\u7eed\u7684\u4efb\u610f\u7b26\u53f7\uff0c\u53ef\u4ee5\u72ec\u7acb\u51fa\u73b0\uff0c\u5e38\u7528\u4e8e\u7b80\u5316\u5305\u540d\u4e0e\u53c2\u6570\u7684\u4e66\u5199"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"execution\uff08public User com..UserService.findById(..))\n")),(0,i.kt)("p",{parentName:"li"},"\u5339\u914dcom\u5305\u4e0b\u7684\u4efb\u610f\u5305\u4e2d\u7684UserService\u7c7b\u6216\u63a5\u53e3\u4e2d\u6240\u6709\u540d\u79f0\u4e3afindById\u7684\u65b9\u6cd5")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"+"),"\uff1a\u4e13\u7528\u4e8e\u5339\u914d\u5b50\u7c7b\u7c7b\u578b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"execution(- *..*Service+.*(..))\n")),(0,i.kt)("p",{parentName:"li"},"\u8fd9\u4e2a\u4f7f\u7528\u7387\u8f83\u4f4e\uff0c\u63cf\u8ff0\u5b50\u7c7b\u7684\uff0c\u54b1\u4eec\u505aJavaEE\u5f00\u53d1\uff0c\u7ee7\u627f\u673a\u4f1a\u5c31\u4e00\u6b21\uff0c\u4f7f\u7528\u90fd\u5f88\u614e\u91cd\uff0c\u6240\u4ee5\u5f88\u5c11\u7528\u5b83\u3002*Service+\uff0c\u8868\u793a\u6240\u6709\u4ee5Service\u7ed3\u5c3e\u7684\u63a5\u53e3\u7684\u5b50\u7c7b\u3002"))),(0,i.kt)("p",null,"\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u628a\u6848\u4f8b\u4e2d\u4f7f\u7528\u5230\u7684\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u6765\u5206\u6790\u4e0b:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630163744963",src:t(55798).Z,width:"1266",height:"519"})),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"execution(void com.wrm244.dao.BookDao.update())\n\u5339\u914d\u63a5\u53e3\uff0c\u80fd\u5339\u914d\u5230\nexecution(void com.wrm244.dao.impl.BookDaoImpl.update())\n\u5339\u914d\u5b9e\u73b0\u7c7b\uff0c\u80fd\u5339\u914d\u5230\nexecution(- com.wrm244.dao.impl.BookDaoImpl.update())\n\u8fd4\u56de\u503c\u4efb\u610f\uff0c\u80fd\u5339\u914d\u5230\nexecution(- com.wrm244.dao.impl.BookDaoImpl.update(*))\n\u8fd4\u56de\u503c\u4efb\u610f\uff0c\u4f46\u662fupdate\u65b9\u6cd5\u5fc5\u987b\u8981\u6709\u4e00\u4e2a\u53c2\u6570\uff0c\u65e0\u6cd5\u5339\u914d\uff0c\u8981\u60f3\u5339\u914d\u9700\u8981\u5728update\u63a5\u53e3\u548c\u5b9e\u73b0\u7c7b\u6dfb\u52a0\u53c2\u6570\nexecution(void com.*.*.*.*.update())\n\u8fd4\u56de\u503c\u4e3avoid,com\u5305\u4e0b\u7684\u4efb\u610f\u5305\u4e09\u5c42\u5305\u4e0b\u7684\u4efb\u610f\u7c7b\u7684update\u65b9\u6cd5\uff0c\u5339\u914d\u5230\u7684\u662f\u5b9e\u73b0\u7c7b\uff0c\u80fd\u5339\u914d\nexecution(void com.*.*.*.update())\n\u8fd4\u56de\u503c\u4e3avoid,com\u5305\u4e0b\u7684\u4efb\u610f\u4e24\u5c42\u5305\u4e0b\u7684\u4efb\u610f\u7c7b\u7684update\u65b9\u6cd5\uff0c\u5339\u914d\u5230\u7684\u662f\u63a5\u53e3\uff0c\u80fd\u5339\u914d\nexecution(void *..update())\n\u8fd4\u56de\u503c\u4e3avoid\uff0c\u65b9\u6cd5\u540d\u662fupdate\u7684\u4efb\u610f\u5305\u4e0b\u7684\u4efb\u610f\u7c7b\uff0c\u80fd\u5339\u914d\nexecution(- *..*(..))\n\u5339\u914d\u9879\u76ee\u4e2d\u4efb\u610f\u7c7b\u7684\u4efb\u610f\u65b9\u6cd5\uff0c\u80fd\u5339\u914d\uff0c\u4f46\u662f\u4e0d\u5efa\u8bae\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\uff0c\u5f71\u54cd\u8303\u56f4\u5e7f\nexecution(- *..u*(..))\n\u5339\u914d\u9879\u76ee\u4e2d\u4efb\u610f\u5305\u4efb\u610f\u7c7b\u4e0b\u53ea\u8981\u4ee5u\u5f00\u5934\u7684\u65b9\u6cd5\uff0cupdate\u65b9\u6cd5\u80fd\u6ee1\u8db3\uff0c\u80fd\u5339\u914d\nexecution(- *..*e(..))\n\u5339\u914d\u9879\u76ee\u4e2d\u4efb\u610f\u5305\u4efb\u610f\u7c7b\u4e0b\u53ea\u8981\u4ee5e\u7ed3\u5c3e\u7684\u65b9\u6cd5\uff0cupdate\u548csave\u65b9\u6cd5\u80fd\u6ee1\u8db3\uff0c\u80fd\u5339\u914d\nexecution(void com..*())\n\u8fd4\u56de\u503c\u4e3avoid\uff0ccom\u5305\u4e0b\u7684\u4efb\u610f\u5305\u4efb\u610f\u7c7b\u4efb\u610f\u65b9\u6cd5\uff0c\u80fd\u5339\u914d\uff0c*\u4ee3\u8868\u7684\u662f\u65b9\u6cd5\nexecution(- com.wrm244.*.*Service.find*(..))\n\u5c06\u9879\u76ee\u4e2d\u6240\u6709\u4e1a\u52a1\u5c42\u65b9\u6cd5\u7684\u4ee5find\u5f00\u5934\u7684\u65b9\u6cd5\u5339\u914d\nexecution(- com.wrm244.*.*Service.save*(..))\n\u5c06\u9879\u76ee\u4e2d\u6240\u6709\u4e1a\u52a1\u5c42\u65b9\u6cd5\u7684\u4ee5save\u5f00\u5934\u7684\u65b9\u6cd5\u5339\u914d\n")),(0,i.kt)("p",null,"\u540e\u9762\u4e24\u79cd\u66f4\u7b26\u5408\u6211\u4eec\u5e73\u5e38\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u7684\u7f16\u5199\u89c4\u5219"),(0,i.kt)("h4",{id:"\u4e66\u5199\u6280\u5de7"},"\u4e66\u5199\u6280\u5de7"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u7684\u7f16\u5199\u5176\u5b9e\u662f\u5f88\u7075\u6d3b\u7684\uff0c\u90a3\u4e48\u5728\u7f16\u5199\u7684\u65f6\u5019\uff0c\u6709\u6ca1\u6709\u4ec0\u4e48\u597d\u7684\u6280\u5de7\u8ba9\u6211\u4eec\u7528\u7528:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u6240\u6709\u4ee3\u7801\u6309\u7167\u6807\u51c6\u89c4\u8303\u5f00\u53d1\uff0c\u5426\u5219\u4ee5\u4e0b\u6280\u5de7\u5168\u90e8\u5931\u6548"),(0,i.kt)("li",{parentName:"ul"},"\u63cf\u8ff0\u5207\u5165\u70b9\u901a",(0,i.kt)("strong",{parentName:"li"},"\u5e38\u63cf\u8ff0\u63a5\u53e3"),"\uff0c\u800c\u4e0d\u63cf\u8ff0\u5b9e\u73b0\u7c7b,\u5982\u679c\u63cf\u8ff0\u5230\u5b9e\u73b0\u7c7b\uff0c\u5c31\u51fa\u73b0\u7d27\u8026\u5408\u4e86"),(0,i.kt)("li",{parentName:"ul"},"\u8bbf\u95ee\u63a7\u5236\u4fee\u9970\u7b26\u9488\u5bf9\u63a5\u53e3\u5f00\u53d1\u5747\u91c7\u7528public\u63cf\u8ff0\uff08",(0,i.kt)("strong",{parentName:"li"},"\u53ef\u7701\u7565\u8bbf\u95ee\u63a7\u5236\u4fee\u9970\u7b26\u63cf\u8ff0"),"\uff09"),(0,i.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u503c\u7c7b\u578b\u5bf9\u4e8e\u589e\u5220\u6539\u7c7b\u4f7f\u7528\u7cbe\u51c6\u7c7b\u578b\u52a0\u901f\u5339\u914d\uff0c\u5bf9\u4e8e\u67e5\u8be2\u7c7b\u4f7f\u7528","*","\u901a\u914d\u5feb\u901f\u63cf\u8ff0"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u5305\u540d"),"\u4e66\u5199",(0,i.kt)("strong",{parentName:"li"},"\u5c3d\u91cf\u4e0d\u4f7f\u7528..\u5339\u914d"),"\uff0c\u6548\u7387\u8fc7\u4f4e\uff0c\u5e38\u7528","*","\u505a\u5355\u4e2a\u5305\u63cf\u8ff0\u5339\u914d\uff0c\u6216\u7cbe\u51c6\u5339\u914d"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u63a5\u53e3\u540d/\u7c7b\u540d"),"\u4e66\u5199\u540d\u79f0\u4e0e\u6a21\u5757\u76f8\u5173\u7684",(0,i.kt)("strong",{parentName:"li"},"\u91c7\u7528","*","\u5339\u914d"),"\uff0c\u4f8b\u5982UserService\u4e66\u5199\u6210","*","Service\uff0c\u7ed1\u5b9a\u4e1a\u52a1\u5c42\u63a5\u53e3\u540d"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u65b9\u6cd5\u540d"),"\u4e66\u5199\u4ee5",(0,i.kt)("strong",{parentName:"li"},"\u52a8\u8bcd"),"\u8fdb\u884c",(0,i.kt)("strong",{parentName:"li"},"\u7cbe\u51c6\u5339\u914d"),"\uff0c\u540d\u8bcd\u91c7\u7528",(0,i.kt)("em",{parentName:"li"},"\u5339\u914d\uff0c\u4f8b\u5982getById\u4e66\u5199\u6210getBy"),",selectAll\u4e66\u5199\u6210selectAll"),(0,i.kt)("li",{parentName:"ul"},"\u53c2\u6570\u89c4\u5219\u8f83\u4e3a\u590d\u6742\uff0c\u6839\u636e\u4e1a\u52a1\u65b9\u6cd5\u7075\u6d3b\u8c03\u6574"),(0,i.kt)("li",{parentName:"ul"},"\u901a\u5e38",(0,i.kt)("strong",{parentName:"li"},"\u4e0d\u4f7f\u7528\u5f02\u5e38"),"\u4f5c\u4e3a",(0,i.kt)("strong",{parentName:"li"},"\u5339\u914d"),"\u89c4\u5219")),(0,i.kt)("h3",{id:"aop\u901a\u77e5\u7c7b\u578b"},"AOP\u901a\u77e5\u7c7b\u578b"),(0,i.kt)("p",null,"\u524d\u9762\u7684\u6848\u4f8b\u4e2d\uff0c\u6709\u6d89\u53ca\u5230\u5982\u4e0b\u5185\u5bb9:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630164718080",src:t(71321).Z,width:"831",height:"54"})),(0,i.kt)("p",null,"\u5b83\u6240\u4ee3\u8868\u7684\u542b\u4e49\u662f\u5c06",(0,i.kt)("inlineCode",{parentName:"p"},"\u901a\u77e5"),"\u6dfb\u52a0\u5230",(0,i.kt)("inlineCode",{parentName:"p"},"\u5207\u5165\u70b9"),"\u65b9\u6cd5\u6267\u884c\u7684\u524d\u9762\u3002"),(0,i.kt)("p",null,"\u9664\u4e86\u8fd9\u4e2a\u6ce8\u89e3\u5916\uff0c\u8fd8\u6709\u6ca1\u6709\u5176\u4ed6\u7684\u6ce8\u89e3\uff0c\u6362\u4e2a\u95ee\u9898\u5c31\u662f\u9664\u4e86\u53ef\u4ee5\u5728\u524d\u9762\u52a0\uff0c\u80fd\u4e0d\u80fd\u5728\u5176\u4ed6\u7684\u5730\u65b9\u52a0?"),(0,i.kt)("h4",{id:"\u7c7b\u578b\u4ecb\u7ecd"},"\u7c7b\u578b\u4ecb\u7ecd"),(0,i.kt)("p",null,"\u6211\u4eec\u5148\u6765\u56de\u987e\u4e0bAOP\u901a\u77e5:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"AOP\u901a\u77e5\u63cf\u8ff0\u4e86\u62bd\u53d6\u7684\u5171\u6027\u529f\u80fd\uff0c\u6839\u636e\u5171\u6027\u529f\u80fd\u62bd\u53d6\u7684\u4f4d\u7f6e\u4e0d\u540c\uff0c\u6700\u7ec8\u8fd0\u884c\u4ee3\u7801\u65f6\u8981\u5c06\u5176\u52a0\u5165\u5230\u5408\u7406\u7684\u4f4d\u7f6e")),(0,i.kt)("p",null,"\u901a\u77e5\u5177\u4f53\u8981\u6dfb\u52a0\u5230\u5207\u5165\u70b9\u7684\u54ea\u91cc?"),(0,i.kt)("p",null,"\u5171\u63d0\u4f9b\u4e865\u79cd\u901a\u77e5\u7c7b\u578b:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u524d\u7f6e\u901a\u77e5"),(0,i.kt)("li",{parentName:"ul"},"\u540e\u7f6e\u901a\u77e5"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\u73af\u7ed5\u901a\u77e5(\u91cd\u70b9)")),(0,i.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u540e\u901a\u77e5(\u4e86\u89e3)"),(0,i.kt)("li",{parentName:"ul"},"\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5(\u4e86\u89e3)")),(0,i.kt)("p",null,"\u4e3a\u4e86\u66f4\u597d\u7684\u7406\u89e3\u8fd9\u51e0\u79cd\u901a\u77e5\u7c7b\u578b\uff0c\u6211\u4eec\u6765\u770b\u4e00\u5f20\u56fe"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630166147697",src:t(66732).Z,width:"846",height:"524"})),(0,i.kt)("p",null,"(1)\u524d\u7f6e\u901a\u77e5\uff0c\u8ffd\u52a0\u529f\u80fd\u5230\u65b9\u6cd5\u6267\u884c\u524d,\u7c7b\u4f3c\u4e8e\u5728\u4ee3\u78011\u6216\u8005\u4ee3\u78012\u6dfb\u52a0\u5185\u5bb9"),(0,i.kt)("p",null,"(2)\u540e\u7f6e\u901a\u77e5,\u8ffd\u52a0\u529f\u80fd\u5230\u65b9\u6cd5\u6267\u884c\u540e,\u4e0d\u7ba1\u65b9\u6cd5\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\u6709\u6ca1\u6709\u629b\u51fa\u5f02\u5e38\u90fd\u4f1a\u6267\u884c\uff0c\u7c7b\u4f3c\u4e8e\u5728\u4ee3\u78015\u6dfb\u52a0\u5185\u5bb9"),(0,i.kt)("p",null,"(3)\u8fd4\u56de\u540e\u901a\u77e5,\u8ffd\u52a0\u529f\u80fd\u5230\u65b9\u6cd5\u6267\u884c\u540e\uff0c\u53ea\u6709\u65b9\u6cd5\u6b63\u5e38\u6267\u884c\u7ed3\u675f\u540e\u624d\u8fdb\u884c,\u7c7b\u4f3c\u4e8e\u5728\u4ee3\u78013\u6dfb\u52a0\u5185\u5bb9\uff0c\u5982\u679c\u65b9\u6cd5\u6267\u884c\u629b\u51fa\u5f02\u5e38\uff0c\u8fd4\u56de\u540e\u901a\u77e5\u5c06\u4e0d\u4f1a\u88ab\u6dfb\u52a0"),(0,i.kt)("p",null,"(4)\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5,\u8ffd\u52a0\u529f\u80fd\u5230\u65b9\u6cd5\u629b\u51fa\u5f02\u5e38\u540e\uff0c\u53ea\u6709\u65b9\u6cd5\u6267\u884c\u51fa\u5f02\u5e38\u624d\u8fdb\u884c,\u7c7b\u4f3c\u4e8e\u5728\u4ee3\u78014\u6dfb\u52a0\u5185\u5bb9\uff0c\u53ea\u6709\u65b9\u6cd5\u629b\u51fa\u5f02\u5e38\u540e\u624d\u4f1a\u88ab\u6dfb\u52a0"),(0,i.kt)("p",null,"(5)\u73af\u7ed5\u901a\u77e5,\u73af\u7ed5\u901a\u77e5\u529f\u80fd\u6bd4\u8f83\u5f3a\u5927\uff0c\u5b83\u53ef\u4ee5\u8ffd\u52a0\u529f\u80fd\u5230\u65b9\u6cd5\u6267\u884c\u7684\u524d\u540e\uff0c\u8fd9\u4e5f\u662f\u6bd4\u8f83\u5e38\u7528\u7684\u65b9\u5f0f\uff0c\u5b83\u53ef\u4ee5\u5b9e\u73b0\u5176\u4ed6\u56db\u79cd\u901a\u77e5\u7c7b\u578b\u7684\u529f\u80fd\uff0c\u5177\u4f53\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff0c\u9700\u8981\u6211\u4eec\u5f80\u4e0b\u5b66\u4e60\u3002"),(0,i.kt)("h4",{id:"\u73af\u5883\u51c6\u5907-1"},"\u73af\u5883\u51c6\u5907"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u521b\u5efa\u4e00\u4e2aMaven\u9879\u76ee")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"pom.xml\u6dfb\u52a0Spring\u4f9d\u8d56"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-xml"},"<dependencies>\n    <dependency>\n        <groupId>org.springframework</groupId>\n        <artifactId>spring-context</artifactId>\n        <version>5.2.10.RELEASE</version>\n    </dependency>\n    <dependency>\n      <groupId>org.aspectj</groupId>\n      <artifactId>aspectjweaver</artifactId>\n      <version>1.9.4</version>\n    </dependency>\n</dependencies>\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6dfb\u52a0BookDao\u548cBookDaoImpl\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public interface BookDao {\n    public void update();\n    public int select();\n}\n\n@Repository\npublic class BookDaoImpl implements BookDao {\n    public void update(){\n        System.out.println("book dao update ...");\n    }\n    public int select() {\n        System.out.println("book dao select is running ...");\n        return 100;\n    }\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u521b\u5efaSpring\u7684\u914d\u7f6e\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\n@ComponentScan("com.wrm244")\n@EnableAspectJAutoProxy\npublic class SpringConfig {\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u521b\u5efa\u901a\u77e5\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(void com.wrm244.dao.BookDao.update())")\n    private void pt(){}\n\n    public void before() {\n        System.out.println("before advice ...");\n    }\n\n    public void after() {\n        System.out.println("after advice ...");\n    }\n\n    public void around(){\n        System.out.println("around before advice ...");\n        System.out.println("around after advice ...");\n    }\n\n    public void afterReturning() {\n        System.out.println("afterReturning advice ...");\n    }\n    \n    public void afterThrowing() {\n        System.out.println("afterThrowing advice ...");\n    }\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u7f16\u5199App\u8fd0\u884c\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class App {\n    public static void main(String[] args) {\n        ApplicationContext ctx = new AnnotationConfigApplicationContext(SpringConfig.class);\n        BookDao bookDao = ctx.getBean(BookDao.class);\n        bookDao.update();\n    }\n}\n")))),(0,i.kt)("p",null,"\u6700\u7ec8\u521b\u5efa\u597d\u7684\u9879\u76ee\u7ed3\u6784\u5982\u4e0b:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630167385146",src:t(45373).Z,width:"421",height:"363"})),(0,i.kt)("h4",{id:"\u901a\u77e5\u7c7b\u578b\u7684\u4f7f\u7528"},"\u901a\u77e5\u7c7b\u578b\u7684\u4f7f\u7528"),(0,i.kt)("h5",{id:"\u524d\u7f6e\u901a\u77e5"},"\u524d\u7f6e\u901a\u77e5"),(0,i.kt)("p",null,"\u4fee\u6539MyAdvice,\u5728before\u65b9\u6cd5\u4e0a\u6dfb\u52a0",(0,i.kt)("inlineCode",{parentName:"p"},"@Before\u6ce8\u89e3")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(void com.wrm244.dao.BookDao.update())")\n    private void pt(){}\n    \n    @Before("pt()")\n    //\u6b64\u5904\u4e5f\u53ef\u4ee5\u5199\u6210 @Before("MyAdvice.pt()"),\u4e0d\u5efa\u8bae\n    public void before() {\n        System.out.println("before advice ...");\n    }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630167805723",src:t(48605).Z,width:"726",height:"212"})),(0,i.kt)("h5",{id:"\u540e\u7f6e\u901a\u77e5"},"\u540e\u7f6e\u901a\u77e5"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(void com.wrm244.dao.BookDao.update())")\n    private void pt(){}\n    \n    @Before("pt()")\n    public void before() {\n        System.out.println("before advice ...");\n    }\n    @After("pt()")\n    public void after() {\n        System.out.println("after advice ...");\n    }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630167887131",src:t(37146).Z,width:"708",height:"237"})),(0,i.kt)("h5",{id:"\u73af\u7ed5\u901a\u77e5"},"\u73af\u7ed5\u901a\u77e5"),(0,i.kt)("h6",{id:"\u57fa\u672c\u4f7f\u7528"},"\u57fa\u672c\u4f7f\u7528"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(void com.wrm244.dao.BookDao.update())")\n    private void pt(){}\n    \n    @Around("pt()")\n    public void around(){\n        System.out.println("around before advice ...");\n        System.out.println("around after advice ...");\n    }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630167969051",src:t(7573).Z,width:"773",height:"214"})),(0,i.kt)("p",null,"\u8fd0\u884c\u7ed3\u679c\u4e2d\uff0c\u901a\u77e5\u7684\u5185\u5bb9\u6253\u5370\u51fa\u6765\uff0c\u4f46\u662f\u539f\u59cb\u65b9\u6cd5\u7684\u5185\u5bb9\u5374\u6ca1\u6709\u88ab\u6267\u884c\u3002"),(0,i.kt)("p",null,"\u56e0\u4e3a\u73af\u7ed5\u901a\u77e5\u9700\u8981\u5728\u539f\u59cb\u65b9\u6cd5\u7684\u524d\u540e\u8fdb\u884c\u589e\u5f3a\uff0c\u6240\u4ee5\u73af\u7ed5\u901a\u77e5\u5c31\u5fc5\u987b\u8981\u80fd\u5bf9\u539f\u59cb\u64cd\u4f5c\u8fdb\u884c\u8c03\u7528\uff0c\u5177\u4f53\u5982\u4f55\u5b9e\u73b0?"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(void com.wrm244.dao.BookDao.update())")\n    private void pt(){}\n    \n    @Around("pt()")\n    public void around(ProceedingJoinPoint pjp) throws Throwable{\n        System.out.println("around before advice ...");\n        //\u8868\u793a\u5bf9\u539f\u59cb\u64cd\u4f5c\u7684\u8c03\u7528\n        pjp.proceed();\n        System.out.println("around after advice ...");\n    }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u8bf4\u660e:")," proceed()\u4e3a\u4ec0\u4e48\u8981\u629b\u51fa\u5f02\u5e38?"),(0,i.kt)("p",null,"\u539f\u56e0\u5f88\u7b80\u5355\uff0c\u770b\u4e0b\u6e90\u7801\u5c31\u77e5\u9053\u4e86"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630168248052",src:t(81975).Z,width:"869",height:"300"})),(0,i.kt)("p",null,"\u518d\u6b21\u8fd0\u884c\uff0c\u7a0b\u5e8f\u53ef\u4ee5\u770b\u5230\u539f\u59cb\u65b9\u6cd5\u5df2\u7ecf\u88ab\u6267\u884c\u4e86"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630168293492",src:t(17951).Z,width:"690",height:"235"})),(0,i.kt)("h6",{id:"\u6ce8\u610f\u4e8b\u9879"},"\u6ce8\u610f\u4e8b\u9879"),(0,i.kt)("p",null,"(1)\u539f\u59cb\u65b9\u6cd5\u6709\u8fd4\u56de\u503c\u7684\u5904\u7406"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4fee\u6539MyAdvice,\u5bf9BookDao\u4e2d\u7684select\u65b9\u6cd5\u6dfb\u52a0\u73af\u7ed5\u901a\u77e5\uff0c")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(void com.wrm244.dao.BookDao.update())")\n    private void pt(){}\n    \n    @Pointcut("execution(int com.wrm244.dao.BookDao.select())")\n    private void pt2(){}\n    \n    @Around("pt2()")\n    public void aroundSelect(ProceedingJoinPoint pjp) throws Throwable {\n        System.out.println("around before advice ...");\n        //\u8868\u793a\u5bf9\u539f\u59cb\u64cd\u4f5c\u7684\u8c03\u7528\n        pjp.proceed();\n        System.out.println("around after advice ...");\n    }\n}\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4fee\u6539App\u7c7b\uff0c\u8c03\u7528select\u65b9\u6cd5")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class App {\n    public static void main(String[] args) {\n        ApplicationContext ctx = new AnnotationConfigApplicationContext(SpringConfig.class);\n        BookDao bookDao = ctx.getBean(BookDao.class);\n        int num = bookDao.select();\n        System.out.println(num);\n    }\n}\n")),(0,i.kt)("p",null,"\u8fd0\u884c\u540e\u4f1a\u62a5\u9519\uff0c\u9519\u8bef\u5185\u5bb9\u4e3a:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},'Exception in thread "main" org.springframework.aop.AopInvocationException: Null return value from advice does not match primitive return type for: public abstract int com.wrm244.dao.BookDao.select()\n    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:226)\n    at com.sun.proxy.$Proxy19.select(Unknown Source)\n    at com.wrm244.App.main(App.java:12)\n')),(0,i.kt)("p",null,"\u9519\u8bef\u5927\u6982\u7684\u610f\u601d\u662f:",(0,i.kt)("inlineCode",{parentName:"p"},"\u7a7a\u7684\u8fd4\u56de\u4e0d\u5339\u914d\u539f\u59cb\u65b9\u6cd5\u7684int\u8fd4\u56de")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"void\u5c31\u662f\u8fd4\u56deNull"),(0,i.kt)("li",{parentName:"ul"},"\u539f\u59cb\u65b9\u6cd5\u5c31\u662fBookDao\u4e0b\u7684select\u65b9\u6cd5")),(0,i.kt)("p",null,"\u6240\u4ee5\u5982\u679c\u6211\u4eec\u4f7f\u7528\u73af\u7ed5\u901a\u77e5\u7684\u8bdd\uff0c\u8981\u6839\u636e\u539f\u59cb\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u6765\u8bbe\u7f6e\u73af\u7ed5\u901a\u77e5\u7684\u8fd4\u56de\u503c\uff0c\u5177\u4f53\u89e3\u51b3\u65b9\u6848\u4e3a:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(void com.wrm244.dao.BookDao.update())")\n    private void pt(){}\n    \n    @Pointcut("execution(int com.wrm244.dao.BookDao.select())")\n    private void pt2(){}\n    \n    @Around("pt2()")\n    public Object aroundSelect(ProceedingJoinPoint pjp) throws Throwable {\n        System.out.println("around before advice ...");\n        //\u8868\u793a\u5bf9\u539f\u59cb\u64cd\u4f5c\u7684\u8c03\u7528\n        Object ret = pjp.proceed();\n        System.out.println("around after advice ...");\n        return ret;\n    }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u8bf4\u660e:")),(0,i.kt)("p",null,"\u200b\t\u4e3a\u4ec0\u4e48\u8fd4\u56de\u7684\u662fObject\u800c\u4e0d\u662fint\u7684\u4e3b\u8981\u539f\u56e0\u662fObject\u7c7b\u578b\u66f4\u901a\u7528\u3002"),(0,i.kt)("p",null,"\u200b\t\u5728\u73af\u7ed5\u901a\u77e5\u4e2d\u662f\u53ef\u4ee5\u5bf9\u539f\u59cb\u65b9\u6cd5\u8fd4\u56de\u503c\u5c31\u884c\u4fee\u6539\u7684\u3002"),(0,i.kt)("h5",{id:"\u8fd4\u56de\u540e\u901a\u77e5"},"\u8fd4\u56de\u540e\u901a\u77e5"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(void com.wrm244.dao.BookDao.update())")\n    private void pt(){}\n    \n    @Pointcut("execution(int com.wrm244.dao.BookDao.select())")\n    private void pt2(){}\n    \n    @AfterReturning("pt2()")\n    public void afterReturning() {\n        System.out.println("afterReturning advice ...");\n    }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630169124446",src:t(44124).Z,width:"687",height:"222"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6ce8\u610f:")," \u8fd4\u56de\u540e\u901a\u77e5\u662f\u9700\u8981\u5728\u539f\u59cb\u65b9\u6cd5",(0,i.kt)("inlineCode",{parentName:"p"},"select"),"\u6b63\u5e38\u6267\u884c\u540e\u624d\u4f1a\u88ab\u6267\u884c\uff0c\u5982\u679c",(0,i.kt)("inlineCode",{parentName:"p"},"select()"),"\u65b9\u6cd5\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e86\u5f02\u5e38\uff0c\u90a3\u4e48\u8fd4\u56de\u540e\u901a\u77e5\u662f\u4e0d\u4f1a\u88ab\u6267\u884c\u3002\u540e\u7f6e\u901a\u77e5\u662f\u4e0d\u7ba1\u539f\u59cb\u65b9\u6cd5\u6709\u6ca1\u6709\u629b\u51fa\u5f02\u5e38\u90fd\u4f1a\u88ab\u6267\u884c\u3002\u8fd9\u4e2a\u6848\u4f8b\u5927\u5bb6\u4e0b\u53bb\u53ef\u4ee5\u81ea\u5df1\u7ec3\u4e60\u9a8c\u8bc1\u4e0b\u3002"),(0,i.kt)("h5",{id:"\u5f02\u5e38\u540e\u901a\u77e5"},"\u5f02\u5e38\u540e\u901a\u77e5"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(void com.wrm244.dao.BookDao.update())")\n    private void pt(){}\n    \n    @Pointcut("execution(int com.wrm244.dao.BookDao.select())")\n    private void pt2(){}\n    \n    @AfterThrowing("pt2()")\n    public void afterThrowing() {\n        System.out.println("afterThrowing advice ...");\n    }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630169357146",src:t(26079).Z,width:"1086",height:"271"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6ce8\u610f\uff1a"),"\u5f02\u5e38\u540e\u901a\u77e5\u662f\u9700\u8981\u539f\u59cb\u65b9\u6cd5\u629b\u51fa\u5f02\u5e38\uff0c\u53ef\u4ee5\u5728",(0,i.kt)("inlineCode",{parentName:"p"},"select()"),"\u65b9\u6cd5\u4e2d\u6dfb\u52a0\u4e00\u884c\u4ee3\u7801",(0,i.kt)("inlineCode",{parentName:"p"},"int i = 1/0"),"\u5373\u53ef\u3002\u5982\u679c\u6ca1\u6709\u629b\u5f02\u5e38\uff0c\u5f02\u5e38\u540e\u901a\u77e5\u5c06\u4e0d\u4f1a\u88ab\u6267\u884c\u3002"),(0,i.kt)("p",null,"\u5b66\u4e60\u5b8c\u8fd95\u79cd\u901a\u77e5\u7c7b\u578b\uff0c\u6211\u4eec\u6765\u601d\u8003\u4e0b\u73af\u7ed5\u901a\u77e5\u662f\u5982\u4f55\u5b9e\u73b0\u5176\u4ed6\u901a\u77e5\u7c7b\u578b\u7684\u529f\u80fd\u7684?"),(0,i.kt)("p",null,"\u56e0\u4e3a\u73af\u7ed5\u901a\u77e5\u662f\u53ef\u4ee5\u63a7\u5236\u539f\u59cb\u65b9\u6cd5\u6267\u884c\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u628a\u589e\u5f3a\u7684\u4ee3\u7801\u5199\u5728\u8c03\u7528\u539f\u59cb\u65b9\u6cd5\u7684\u4e0d\u540c\u4f4d\u7f6e\u5c31\u53ef\u4ee5\u5b9e\u73b0\u4e0d\u540c\u7684\u901a\u77e5\u7c7b\u578b\u7684\u529f\u80fd\uff0c\u5982:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630170090945",src:t(19204).Z,width:"1090",height:"560"})),(0,i.kt)("h5",{id:"\u901a\u77e5\u7c7b\u578b\u603b\u7ed3"},"\u901a\u77e5\u7c7b\u578b\u603b\u7ed3"),(0,i.kt)("h6",{id:"\u77e5\u8bc6\u70b91after"},"\u77e5\u8bc6\u70b91\uff1a@After"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,i.kt)("th",{parentName:"tr",align:null},"@After"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,i.kt)("td",{parentName:"tr",align:null},"\u65b9\u6cd5\u6ce8\u89e3")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f4d\u7f6e"),(0,i.kt)("td",{parentName:"tr",align:null},"\u901a\u77e5\u65b9\u6cd5\u5b9a\u4e49\u4e0a\u65b9")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f5c\u7528"),(0,i.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u65b9\u6cd5\u4e0e\u5207\u5165\u70b9\u4e4b\u95f4\u7684\u7ed1\u5b9a\u5173\u7cfb\uff0c\u5f53\u524d\u901a\u77e5\u65b9\u6cd5\u5728\u539f\u59cb\u5207\u5165\u70b9\u65b9\u6cd5\u540e\u8fd0\u884c")))),(0,i.kt)("h6",{id:"\u77e5\u8bc6\u70b92afterreturning"},"\u77e5\u8bc6\u70b92\uff1a@AfterReturning"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,i.kt)("th",{parentName:"tr",align:null},"@AfterReturning"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,i.kt)("td",{parentName:"tr",align:null},"\u65b9\u6cd5\u6ce8\u89e3")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f4d\u7f6e"),(0,i.kt)("td",{parentName:"tr",align:null},"\u901a\u77e5\u65b9\u6cd5\u5b9a\u4e49\u4e0a\u65b9")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f5c\u7528"),(0,i.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u65b9\u6cd5\u4e0e\u5207\u5165\u70b9\u4e4b\u95f4\u7ed1\u5b9a\u5173\u7cfb\uff0c\u5f53\u524d\u901a\u77e5\u65b9\u6cd5\u5728\u539f\u59cb\u5207\u5165\u70b9\u65b9\u6cd5\u6b63\u5e38\u6267\u884c\u5b8c\u6bd5\u540e\u6267\u884c")))),(0,i.kt)("h6",{id:"\u77e5\u8bc6\u70b93afterthrowing"},"\u77e5\u8bc6\u70b93\uff1a@AfterThrowing"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,i.kt)("th",{parentName:"tr",align:null},"@AfterThrowing"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,i.kt)("td",{parentName:"tr",align:null},"\u65b9\u6cd5\u6ce8\u89e3")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f4d\u7f6e"),(0,i.kt)("td",{parentName:"tr",align:null},"\u901a\u77e5\u65b9\u6cd5\u5b9a\u4e49\u4e0a\u65b9")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f5c\u7528"),(0,i.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u65b9\u6cd5\u4e0e\u5207\u5165\u70b9\u4e4b\u95f4\u7ed1\u5b9a\u5173\u7cfb\uff0c\u5f53\u524d\u901a\u77e5\u65b9\u6cd5\u5728\u539f\u59cb\u5207\u5165\u70b9\u65b9\u6cd5\u8fd0\u884c\u629b\u51fa\u5f02\u5e38\u540e\u6267\u884c")))),(0,i.kt)("h6",{id:"\u77e5\u8bc6\u70b94around"},"\u77e5\u8bc6\u70b94\uff1a@Around"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,i.kt)("th",{parentName:"tr",align:null},"@Around"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,i.kt)("td",{parentName:"tr",align:null},"\u65b9\u6cd5\u6ce8\u89e3")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f4d\u7f6e"),(0,i.kt)("td",{parentName:"tr",align:null},"\u901a\u77e5\u65b9\u6cd5\u5b9a\u4e49\u4e0a\u65b9")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f5c\u7528"),(0,i.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u5f53\u524d\u901a\u77e5\u65b9\u6cd5\u4e0e\u5207\u5165\u70b9\u4e4b\u95f4\u7684\u7ed1\u5b9a\u5173\u7cfb\uff0c\u5f53\u524d\u901a\u77e5\u65b9\u6cd5\u5728\u539f\u59cb\u5207\u5165\u70b9\u65b9\u6cd5\u524d\u540e\u8fd0\u884c")))),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u73af\u7ed5\u901a\u77e5\u6ce8\u610f\u4e8b\u9879")),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u73af\u7ed5\u901a\u77e5\u5fc5\u987b\u4f9d\u8d56\u5f62\u53c2ProceedingJoinPoint\u624d\u80fd\u5b9e\u73b0\u5bf9\u539f\u59cb\u65b9\u6cd5\u7684\u8c03\u7528\uff0c\u8fdb\u800c\u5b9e\u73b0\u539f\u59cb\u65b9\u6cd5\u8c03\u7528\u524d\u540e\u540c\u65f6\u6dfb\u52a0\u901a\u77e5"),(0,i.kt)("li",{parentName:"ol"},"\u901a\u77e5\u4e2d\u5982\u679c\u672a\u4f7f\u7528ProceedingJoinPoint\u5bf9\u539f\u59cb\u65b9\u6cd5\u8fdb\u884c\u8c03\u7528\u5c06\u8df3\u8fc7\u539f\u59cb\u65b9\u6cd5\u7684\u6267\u884c"),(0,i.kt)("li",{parentName:"ol"},"\u5bf9\u539f\u59cb\u65b9\u6cd5\u7684\u8c03\u7528\u53ef\u4ee5\u4e0d\u63a5\u6536\u8fd4\u56de\u503c\uff0c\u901a\u77e5\u65b9\u6cd5\u8bbe\u7f6e\u6210void\u5373\u53ef\uff0c\u5982\u679c\u63a5\u6536\u8fd4\u56de\u503c\uff0c\u6700\u597d\u8bbe\u5b9a\u4e3aObject\u7c7b\u578b"),(0,i.kt)("li",{parentName:"ol"},"\u539f\u59cb\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u5982\u679c\u662fvoid\u7c7b\u578b\uff0c\u901a\u77e5\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u7c7b\u578b\u53ef\u4ee5\u8bbe\u7f6e\u6210void,\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u6210Object"),(0,i.kt)("li",{parentName:"ol"},"\u7531\u4e8e\u65e0\u6cd5\u9884\u77e5\u539f\u59cb\u65b9\u6cd5\u8fd0\u884c\u540e\u662f\u5426\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u56e0\u6b64\u73af\u7ed5\u901a\u77e5\u65b9\u6cd5\u5fc5\u987b\u8981\u5904\u7406Throwable\u5f02\u5e38")),(0,i.kt)("h3",{id:"\u4e1a\u52a1\u5c42\u63a5\u53e3\u6267\u884c\u6548\u7387"},"\u4e1a\u52a1\u5c42\u63a5\u53e3\u6267\u884c\u6548\u7387"),(0,i.kt)("h4",{id:"\u9700\u6c42\u5206\u6790-1"},"\u9700\u6c42\u5206\u6790"),(0,i.kt)("p",null,"\u8fd9\u4e2a\u9700\u6c42\u4e5f\u6bd4\u8f83\u7b80\u5355\uff0c\u524d\u9762\u6211\u4eec\u5728\u4ecb\u7ecdAOP\u7684\u65f6\u5019\u5df2\u7ecf\u6f14\u793a\u8fc7:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u9700\u6c42:\u4efb\u610f\u4e1a\u52a1\u5c42\u63a5\u53e3\u6267\u884c\u5747\u53ef\u663e\u793a\u5176\u6267\u884c\u6548\u7387\uff08\u6267\u884c\u65f6\u957f\uff09")),(0,i.kt)("p",null,"\u8fd9\u4e2a\u6848\u4f8b\u7684\u76ee\u7684\u662f\u67e5\u770b\u6bcf\u4e2a\u4e1a\u52a1\u5c42\u6267\u884c\u7684\u65f6\u95f4\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u76d1\u63a7\u51fa\u54ea\u4e2a\u4e1a\u52a1\u6bd4\u8f83\u8017\u65f6\uff0c\u5c06\u5176\u67e5\u627e\u51fa\u6765\u65b9\u4fbf\u4f18\u5316\u3002"),(0,i.kt)("p",null,"\u5177\u4f53\u5b9e\u73b0\u7684\u601d\u8def:"),(0,i.kt)("p",null,"(1) \u5f00\u59cb\u6267\u884c\u65b9\u6cd5\u4e4b\u524d\u8bb0\u5f55\u4e00\u4e2a\u65f6\u95f4"),(0,i.kt)("p",null,"(2) \u6267\u884c\u65b9\u6cd5"),(0,i.kt)("p",null,"(3) \u6267\u884c\u5b8c\u65b9\u6cd5\u4e4b\u540e\u8bb0\u5f55\u4e00\u4e2a\u65f6\u95f4"),(0,i.kt)("p",null,"(4) \u7528\u540e\u4e00\u4e2a\u65f6\u95f4\u51cf\u53bb\u524d\u4e00\u4e2a\u65f6\u95f4\u7684\u5dee\u503c\uff0c\u5c31\u662f\u6211\u4eec\u9700\u8981\u7684\u7ed3\u679c\u3002"),(0,i.kt)("p",null,"\u6240\u4ee5\u8981\u5728\u65b9\u6cd5\u6267\u884c\u7684\u524d\u540e\u6dfb\u52a0\u4e1a\u52a1\uff0c\u7ecf\u8fc7\u5206\u6790\u6211\u4eec\u5c06\u91c7\u7528",(0,i.kt)("inlineCode",{parentName:"p"},"\u73af\u7ed5\u901a\u77e5"),"\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u8bf4\u660e:")," \u539f\u59cb\u65b9\u6cd5\u5982\u679c\u53ea\u6267\u884c\u4e00\u6b21\uff0c\u65f6\u95f4\u592a\u5feb\uff0c\u4e24\u4e2a\u65f6\u95f4\u5dee\u53ef\u80fd\u4e3a0\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u6267\u884c\u4e07\u6b21\u6765\u8ba1\u7b97\u65f6\u95f4\u5dee\u3002"),(0,i.kt)("h4",{id:"\u73af\u5883\u51c6\u5907-2"},"\u73af\u5883\u51c6\u5907"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u521b\u5efa\u4e00\u4e2aMaven\u9879\u76ee")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"pom.xml\u6dfb\u52a0Spring\u4f9d\u8d56"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-xml"},"<dependencies>\n    <dependency>\n      <groupId>org.springframework</groupId>\n      <artifactId>spring-context</artifactId>\n      <version>5.2.10.RELEASE</version>\n    </dependency>\n    <dependency>\n      <groupId>org.springframework</groupId>\n      <artifactId>spring-jdbc</artifactId>\n      <version>5.2.10.RELEASE</version>\n    </dependency>\n    <dependency>\n      <groupId>org.springframework</groupId>\n      <artifactId>spring-test</artifactId>\n      <version>5.2.10.RELEASE</version>\n    </dependency>\n    <dependency>\n      <groupId>org.aspectj</groupId>\n      <artifactId>aspectjweaver</artifactId>\n      <version>1.9.4</version>\n    </dependency>\n    <dependency>\n      <groupId>mysql</groupId>\n      <artifactId>mysql-connector-java</artifactId>\n      <version>5.1.47</version>\n    </dependency>\n    <dependency>\n      <groupId>com.alibaba</groupId>\n      <artifactId>druid</artifactId>\n      <version>1.1.16</version>\n    </dependency>\n    <dependency>\n      <groupId>org.mybatis</groupId>\n      <artifactId>mybatis</artifactId>\n      <version>3.5.6</version>\n    </dependency>\n    <dependency>\n      <groupId>org.mybatis</groupId>\n      <artifactId>mybatis-spring</artifactId>\n      <version>1.3.0</version>\n    </dependency>\n    <dependency>\n      <groupId>junit</groupId>\n      <artifactId>junit</artifactId>\n      <version>4.12</version>\n      <scope>test</scope>\n    </dependency>\n  </dependencies>\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6dfb\u52a0AccountService\u3001AccountServiceImpl\u3001AccountDao\u4e0eAccount\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public interface AccountService {\n    void save(Account account);\n    void delete(Integer id);\n    void update(Account account);\n    List<Account> findAll();\n    Account findById(Integer id);\n}\n\n@Service\npublic class AccountServiceImpl implements AccountService {\n\n    @Autowired\n    private AccountDao accountDao;\n\n    public void save(Account account) {\n        accountDao.save(account);\n    }\n\n    public void update(Account account){\n        accountDao.update(account);\n    }\n\n    public void delete(Integer id) {\n        accountDao.delete(id);\n    }\n\n    public Account findById(Integer id) {\n        return accountDao.findById(id);\n    }\n\n    public List<Account> findAll() {\n        return accountDao.findAll();\n    }\n}\npublic interface AccountDao {\n\n    @Insert("insert into tbl_account(name,money)values(#{name},#{money})")\n    void save(Account account);\n\n    @Delete("delete from tbl_account where id = #{id} ")\n    void delete(Integer id);\n\n    @Update("update tbl_account set name = #{name} , money = #{money} where id = #{id} ")\n    void update(Account account);\n\n    @Select("select - from tbl_account")\n    List<Account> findAll();\n\n    @Select("select - from tbl_account where id = #{id} ")\n    Account findById(Integer id);\n}\n\npublic class Account implements Serializable {\n\n    private Integer id;\n    private String name;\n    private Double money;\n    //setter..getter..toString\u65b9\u6cd5\u7701\u7565\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"resources\u4e0b\u63d0\u4f9b\u4e00\u4e2ajdbc.properties"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-properties"},"jdbc.driver=com.mysql.jdbc.Driver\njdbc.url=jdbc:mysql://localhost:3306/spring_db?useSSL=false\njdbc.username=root\njdbc.password=root\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u521b\u5efa\u76f8\u5173\u914d\u7f6e\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'//Spring\u914d\u7f6e\u7c7b:SpringConfig\n@Configuration\n@ComponentScan("com.wrm244")\n@PropertySource("classpath:jdbc.properties")\n@Import({JdbcConfig.class,MybatisConfig.class})\npublic class SpringConfig {\n}\n//JdbcConfig\u914d\u7f6e\u7c7b\npublic class JdbcConfig {\n    @Value("${jdbc.driver}")\n    private String driver;\n    @Value("${jdbc.url}")\n    private String url;\n    @Value("${jdbc.username}")\n    private String userName;\n    @Value("${jdbc.password}")\n    private String password;\n\n    @Bean\n    public DataSource dataSource(){\n        DruidDataSource ds = new DruidDataSource();\n        ds.setDriverClassName(driver);\n        ds.setUrl(url);\n        ds.setUsername(userName);\n        ds.setPassword(password);\n        return ds;\n    }\n}\n//MybatisConfig\u914d\u7f6e\u7c7b\npublic class MybatisConfig {\n\n    @Bean\n    public SqlSessionFactoryBean sqlSessionFactory(DataSource dataSource){\n        SqlSessionFactoryBean ssfb = new SqlSessionFactoryBean();\n        ssfb.setTypeAliasesPackage("com.wrm244.domain");\n        ssfb.setDataSource(dataSource);\n        return ssfb;\n    }\n\n    @Bean\n    public MapperScannerConfigurer mapperScannerConfigurer(){\n        MapperScannerConfigurer msc = new MapperScannerConfigurer();\n        msc.setBasePackage("com.wrm244.dao");\n        return msc;\n    }\n}\n\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u7f16\u5199Spring\u6574\u5408Junit\u7684\u6d4b\u8bd5\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(classes = SpringConfig.class)\npublic class AccountServiceTestCase {\n    @Autowired\n    private AccountService accountService;\n\n    @Test\n    public void testFindById(){\n        Account ac = accountService.findById(2);\n    }\n\n    @Test\n    public void testFindAll(){\n        List<Account> all = accountService.findAll();\n    }\n\n}\n")))),(0,i.kt)("p",null,"\u6700\u7ec8\u521b\u5efa\u597d\u7684\u9879\u76ee\u7ed3\u6784\u5982\u4e0b:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630214631112",src:t(85276).Z,width:"413",height:"586"})),(0,i.kt)("h4",{id:"\u529f\u80fd\u5f00\u53d1"},"\u529f\u80fd\u5f00\u53d1"),(0,i.kt)("h5",{id:"\u6b65\u9aa41\u5f00\u542fspringaop\u7684\u6ce8\u89e3\u529f\u80fd"},"\u6b65\u9aa41:\u5f00\u542fSpringAOP\u7684\u6ce8\u89e3\u529f\u80fd"),(0,i.kt)("p",null,"\u5728Spring\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6SpringConfig\u7c7b\u4e2d\u6dfb\u52a0\u6ce8\u89e3"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@EnableAspectJAutoProxy\n")),(0,i.kt)("h5",{id:"\u6b65\u9aa42\u521b\u5efaaop\u7684\u901a\u77e5\u7c7b"},"\u6b65\u9aa42:\u521b\u5efaAOP\u7684\u901a\u77e5\u7c7b"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u8be5\u7c7b\u8981\u88abSpring\u7ba1\u7406\uff0c\u9700\u8981\u6dfb\u52a0@Component")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u8981\u6807\u8bc6\u8be5\u7c7b\u662f\u4e00\u4e2aAOP\u7684\u5207\u9762\u7c7b\uff0c\u9700\u8981\u6dfb\u52a0@Aspect")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u914d\u7f6e\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\uff0c\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a\u65b9\u6cd5\uff0c\u5e76\u6dfb\u52a0@Pointcut"))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class ProjectAdvice {\n    //\u914d\u7f6e\u4e1a\u52a1\u5c42\u7684\u6240\u6709\u65b9\u6cd5\n    @Pointcut("execution(- com.wrm244.service.*Service.*(..))")\n    private void servicePt(){}\n    \n    public void runSpeed(){\n        \n    } \n}\n')),(0,i.kt)("h5",{id:"\u6b65\u9aa43\u6dfb\u52a0\u73af\u7ed5\u901a\u77e5"},"\u6b65\u9aa43:\u6dfb\u52a0\u73af\u7ed5\u901a\u77e5"),(0,i.kt)("p",null,"\u5728runSpeed()\u65b9\u6cd5\u4e0a\u6dfb\u52a0@Around"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class ProjectAdvice {\n    //\u914d\u7f6e\u4e1a\u52a1\u5c42\u7684\u6240\u6709\u65b9\u6cd5\n    @Pointcut("execution(- com.wrm244.service.*Service.*(..))")\n    private void servicePt(){}\n    //@Around("ProjectAdvice.servicePt()") \u53ef\u4ee5\u7b80\u5199\u4e3a\u4e0b\u9762\u7684\u65b9\u5f0f\n    @Around("servicePt()")\n    public Object runSpeed(ProceedingJoinPoint pjp){\n        Object ret = pjp.proceed();\n        return ret;\n    } \n}\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6ce8\u610f:")," \u76ee\u524d\u5e76\u6ca1\u6709\u505a\u4efb\u4f55\u589e\u5f3a"),(0,i.kt)("h5",{id:"\u6b65\u9aa44\u5b8c\u6210\u6838\u5fc3\u4e1a\u52a1\u8bb0\u5f55\u4e07\u6b21\u6267\u884c\u7684\u65f6\u95f4"},"\u6b65\u9aa44:\u5b8c\u6210\u6838\u5fc3\u4e1a\u52a1\uff0c\u8bb0\u5f55\u4e07\u6b21\u6267\u884c\u7684\u65f6\u95f4"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class ProjectAdvice {\n    //\u914d\u7f6e\u4e1a\u52a1\u5c42\u7684\u6240\u6709\u65b9\u6cd5\n    @Pointcut("execution(- com.wrm244.service.*Service.*(..))")\n    private void servicePt(){}\n    //@Around("ProjectAdvice.servicePt()") \u53ef\u4ee5\u7b80\u5199\u4e3a\u4e0b\u9762\u7684\u65b9\u5f0f\n    @Around("servicePt()")\n    public void runSpeed(ProceedingJoinPoint pjp){\n        \n        long start = System.currentTimeMillis();\n        for (int i = 0; i < 10000; i++) {\n           pjp.proceed();\n        }\n        long end = System.currentTimeMillis();\n        System.out.println("\u4e1a\u52a1\u5c42\u63a5\u53e3\u4e07\u6b21\u6267\u884c\u65f6\u95f4: "+(end-start)+"ms");\n    } \n}\n')),(0,i.kt)("h5",{id:"\u6b65\u9aa45\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\u7c7b"},"\u6b65\u9aa45:\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\u7c7b"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630215355776",src:t(85803).Z,width:"853",height:"252"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6ce8\u610f:")," \u56e0\u4e3a\u7a0b\u5e8f\u6bcf\u6b21\u6267\u884c\u7684\u65f6\u957f\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u8fd0\u884c\u591a\u6b21\u6700\u7ec8\u7684\u7ed3\u679c\u662f\u4e0d\u4e00\u6837\u7684\u3002"),(0,i.kt)("h5",{id:"\u6b65\u9aa46\u7a0b\u5e8f\u4f18\u5316"},"\u6b65\u9aa46:\u7a0b\u5e8f\u4f18\u5316"),(0,i.kt)("p",null,"\u76ee\u524d\u7a0b\u5e8f\u6240\u9762\u4e34\u7684\u95ee\u9898\u662f\uff0c\u591a\u4e2a\u65b9\u6cd5\u4e00\u8d77\u6267\u884c\u6d4b\u8bd5\u7684\u65f6\u5019\uff0c\u63a7\u5236\u53f0\u90fd\u6253\u5370\u7684\u662f:"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"\u4e1a\u52a1\u5c42\u63a5\u53e3\u4e07\u6b21\u6267\u884c\u65f6\u95f4:xxxms")),(0,i.kt)("p",null,"\u6211\u4eec\u6ca1\u6709\u529e\u6cd5\u533a\u5206\u5230\u5e95\u662f\u54ea\u4e2a\u63a5\u53e3\u7684\u54ea\u4e2a\u65b9\u6cd5\u6267\u884c\u7684\u5177\u4f53\u65f6\u95f4\uff0c\u5177\u4f53\u5982\u4f55\u4f18\u5316?"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class ProjectAdvice {\n    //\u914d\u7f6e\u4e1a\u52a1\u5c42\u7684\u6240\u6709\u65b9\u6cd5\n    @Pointcut("execution(- com.wrm244.service.*Service.*(..))")\n    private void servicePt(){}\n    //@Around("ProjectAdvice.servicePt()") \u53ef\u4ee5\u7b80\u5199\u4e3a\u4e0b\u9762\u7684\u65b9\u5f0f\n    @Around("servicePt()")\n    public void runSpeed(ProceedingJoinPoint pjp){\n        //\u83b7\u53d6\u6267\u884c\u7b7e\u540d\u4fe1\u606f\n        Signature signature = pjp.getSignature();\n        //\u901a\u8fc7\u7b7e\u540d\u83b7\u53d6\u6267\u884c\u64cd\u4f5c\u540d\u79f0(\u63a5\u53e3\u540d)\n        String className = signature.getDeclaringTypeName();\n        //\u901a\u8fc7\u7b7e\u540d\u83b7\u53d6\u6267\u884c\u64cd\u4f5c\u540d\u79f0(\u65b9\u6cd5\u540d)\n        String methodName = signature.getName();\n        \n        long start = System.currentTimeMillis();\n        for (int i = 0; i < 10000; i++) {\n           pjp.proceed();\n        }\n        long end = System.currentTimeMillis();\n        System.out.println("\u4e07\u6b21\u6267\u884c\uff1a"+ className+"."+methodName+"----\x3e" +(end-start) + "ms");\n    } \n}\n')),(0,i.kt)("h5",{id:"\u6b65\u9aa47\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\u7c7b"},"\u6b65\u9aa47:\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\u7c7b"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630215743444",src:t(37880).Z,width:"1402",height:"231"})),(0,i.kt)("admonition",{type:"tip"},(0,i.kt)("p",{parentName:"admonition"},"\u8865\u5145\u8bf4\u660e"),(0,i.kt)("p",{parentName:"admonition"},"\u5f53\u524d\u6d4b\u8bd5\u7684\u63a5\u53e3\u6267\u884c\u6548\u7387\u4ec5\u4ec5\u662f\u4e00\u4e2a\u7406\u8bba\u503c\uff0c\u5e76\u4e0d\u662f\u4e00\u6b21\u5b8c\u6574\u7684\u6267\u884c\u8fc7\u7a0b\u3002"),(0,i.kt)("p",{parentName:"admonition"},"\u8fd9\u5757\u53ea\u662f\u901a\u8fc7\u8be5\u6848\u4f8b\u628aAOP\u7684\u4f7f\u7528\u8fdb\u884c\u4e86\u5b66\u4e60\uff0c\u5177\u4f53\u7684\u5b9e\u9645\u503c\u662f\u6709\u5f88\u591a\u56e0\u7d20\u5171\u540c\u51b3\u5b9a\u7684\u3002")),(0,i.kt)("h3",{id:"aop\u901a\u77e5\u83b7\u53d6\u6570\u636e"},"AOP\u901a\u77e5\u83b7\u53d6\u6570\u636e"),(0,i.kt)("p",null,"\u76ee\u524d\u6211\u4eec\u5199AOP\u4ec5\u4ec5\u662f\u5728\u539f\u59cb\u65b9\u6cd5\u524d\u540e\u8ffd\u52a0\u4e00\u4e9b\u64cd\u4f5c\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u8981\u8bf4\u8bf4AOP\u4e2d\u6570\u636e\u76f8\u5173\u7684\u5185\u5bb9\uff0c\u6211\u4eec\u5c06\u4ece",(0,i.kt)("inlineCode",{parentName:"p"},"\u83b7\u53d6\u53c2\u6570"),"\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"\u83b7\u53d6\u8fd4\u56de\u503c"),"\u548c",(0,i.kt)("inlineCode",{parentName:"p"},"\u83b7\u53d6\u5f02\u5e38"),"\u4e09\u4e2a\u65b9\u9762\u6765\u7814\u7a76\u5207\u5165\u70b9\u7684\u76f8\u5173\u4fe1\u606f\u3002"),(0,i.kt)("p",null,"\u524d\u9762\u6211\u4eec\u4ecb\u7ecd\u901a\u77e5\u7c7b\u578b\u7684\u65f6\u5019\u603b\u5171\u8bb2\u4e86\u4e94\u79cd\uff0c\u90a3\u4e48\u5bf9\u4e8e\u8fd9\u4e94\u79cd\u7c7b\u578b\u90fd\u4f1a\u6709\u53c2\u6570\uff0c\u8fd4\u56de\u503c\u548c\u5f02\u5e38\u5417?"),(0,i.kt)("p",null,"\u6211\u4eec\u5148\u6765\u4e00\u4e2a\u4e2a\u5206\u6790\u4e0b:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u5207\u5165\u70b9\u65b9\u6cd5\u7684\u53c2\u6570\uff0c\u6240\u6709\u7684\u901a\u77e5\u7c7b\u578b\u90fd\u53ef\u4ee5\u83b7\u53d6\u53c2\u6570",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"JoinPoint\uff1a\u9002\u7528\u4e8e\u524d\u7f6e\u3001\u540e\u7f6e\u3001\u8fd4\u56de\u540e\u3001\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5"),(0,i.kt)("li",{parentName:"ul"},"ProceedingJoinPoint\uff1a\u9002\u7528\u4e8e\u73af\u7ed5\u901a\u77e5"))),(0,i.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u5207\u5165\u70b9\u65b9\u6cd5\u8fd4\u56de\u503c\uff0c\u524d\u7f6e\u548c\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5\u662f\u6ca1\u6709\u8fd4\u56de\u503c\uff0c\u540e\u7f6e\u901a\u77e5\u53ef\u6709\u53ef\u65e0\uff0c\u6240\u4ee5\u4e0d\u505a\u7814\u7a76",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u540e\u901a\u77e5"),(0,i.kt)("li",{parentName:"ul"},"\u73af\u7ed5\u901a\u77e5"))),(0,i.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u5207\u5165\u70b9\u65b9\u6cd5\u8fd0\u884c\u5f02\u5e38\u4fe1\u606f\uff0c\u524d\u7f6e\u548c\u8fd4\u56de\u540e\u901a\u77e5\u662f\u4e0d\u4f1a\u6709\uff0c\u540e\u7f6e\u901a\u77e5\u53ef\u6709\u53ef\u65e0\uff0c\u6240\u4ee5\u4e0d\u505a\u7814\u7a76",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5"),(0,i.kt)("li",{parentName:"ul"},"\u73af\u7ed5\u901a\u77e5")))),(0,i.kt)("h4",{id:"\u73af\u5883\u51c6\u5907-3"},"\u73af\u5883\u51c6\u5907"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u521b\u5efa\u4e00\u4e2aMaven\u9879\u76ee")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"pom.xml\u6dfb\u52a0Spring\u4f9d\u8d56"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-xml"},"<dependencies>\n    <dependency>\n      <groupId>org.springframework</groupId>\n      <artifactId>spring-context</artifactId>\n      <version>5.2.10.RELEASE</version>\n    </dependency>\n    <dependency>\n      <groupId>org.aspectj</groupId>\n      <artifactId>aspectjweaver</artifactId>\n      <version>1.9.4</version>\n    </dependency>\n  </dependencies>\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6dfb\u52a0BookDao\u548cBookDaoImpl\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public interface BookDao {\n    public String findName(int id);\n}\n@Repository\npublic class BookDaoImpl implements BookDao {\n\n    public String findName(int id) {\n        System.out.println("id:"+id);\n        return "itcast";\n    }\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u521b\u5efaSpring\u7684\u914d\u7f6e\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\n@ComponentScan("com.wrm244")\n@EnableAspectJAutoProxy\npublic class SpringConfig {\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u7f16\u5199\u901a\u77e5\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(- com.wrm244.dao.BookDao.findName(..))")\n    private void pt(){}\n\n    @Before("pt()")\n    public void before() {\n        System.out.println("before advice ..." );\n    }\n\n    @After("pt()")\n    public void after() {\n        System.out.println("after advice ...");\n    }\n\n    @Around("pt()")\n    public Object around() throws Throwable{\n        Object ret = pjp.proceed();\n        return ret;\n    }\n    @AfterReturning("pt()")\n    public void afterReturning() {\n        System.out.println("afterReturning advice ...");\n    }\n\n\n    @AfterThrowing("pt()")\n    public void afterThrowing() {\n        System.out.println("afterThrowing advice ...");\n    }\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u7f16\u5199App\u8fd0\u884c\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class App {\n    public static void main(String[] args) {\n        ApplicationContext ctx = new AnnotationConfigApplicationContext(SpringConfig.class);\n        BookDao bookDao = ctx.getBean(BookDao.class);\n        String name = bookDao.findName(100);\n        System.out.println(name);\n    }\n}\n")))),(0,i.kt)("p",null,"\u6700\u7ec8\u521b\u5efa\u597d\u7684\u9879\u76ee\u7ed3\u6784\u5982\u4e0b:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630233154992",src:t(446).Z,width:"421",height:"359"})),(0,i.kt)("h4",{id:"\u83b7\u53d6\u53c2\u6570"},"\u83b7\u53d6\u53c2\u6570"),(0,i.kt)("h5",{id:"\u975e\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u65b9\u5f0f"},"\u975e\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u65b9\u5f0f"),(0,i.kt)("p",null,"\u5728\u65b9\u6cd5\u4e0a\u6dfb\u52a0JoinPoint,\u901a\u8fc7JoinPoint\u6765\u83b7\u53d6\u53c2\u6570"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(- com.wrm244.dao.BookDao.findName(..))")\n    private void pt(){}\n\n    @Before("pt()")\n    public void before(JoinPoint jp) \n        Object[] args = jp.getArgs();\n        System.out.println(Arrays.toString(args));\n        System.out.println("before advice ..." );\n    }\n    //...\u5176\u4ed6\u7684\u7565\n}\n')),(0,i.kt)("p",null,"\u8fd0\u884cApp\u7c7b\uff0c\u53ef\u4ee5\u83b7\u53d6\u5982\u4e0b\u5185\u5bb9\uff0c\u8bf4\u660e\u53c2\u6570100\u5df2\u7ecf\u88ab\u83b7\u53d6"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630233291929",src:t(16081).Z,width:"530",height:"200"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u601d\u8003:\u65b9\u6cd5\u7684\u53c2\u6570\u53ea\u6709\u4e00\u4e2a\uff0c\u4e3a\u4ec0\u4e48\u83b7\u53d6\u7684\u662f\u4e00\u4e2a\u6570\u7ec4?")),(0,i.kt)("p",null,"\u56e0\u4e3a\u53c2\u6570\u7684\u4e2a\u6570\u662f\u4e0d\u56fa\u5b9a\u7684\uff0c\u6240\u4ee5\u4f7f\u7528\u6570\u7ec4\u66f4\u901a\u914d\u4e9b\u3002"),(0,i.kt)("p",null,"\u5982\u679c\u5c06\u53c2\u6570\u6539\u6210\u4e24\u4e2a\u4f1a\u662f\u4ec0\u4e48\u6548\u679c\u5462?"),(0,i.kt)("p",null,"(1)\u4fee\u6539BookDao\u63a5\u53e3\u548cBookDaoImpl\u5b9e\u73b0\u7c7b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public interface BookDao {\n    public String findName(int id,String password);\n}\n@Repository\npublic class BookDaoImpl implements BookDao {\n\n    public String findName(int id,String password) {\n        System.out.println("id:"+id);\n        return "itcast";\n    }\n}\n')),(0,i.kt)("p",null,"(2)\u4fee\u6539App\u7c7b\uff0c\u8c03\u7528\u65b9\u6cd5\u4f20\u5165\u591a\u4e2a\u53c2\u6570"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class App {\n    public static void main(String[] args) {\n        ApplicationContext ctx = new AnnotationConfigApplicationContext(SpringConfig.class);\n        BookDao bookDao = ctx.getBean(BookDao.class);\n        String name = bookDao.findName(100,"wrm244");\n        System.out.println(name);\n    }\n}\n')),(0,i.kt)("p",null,"(3)\u8fd0\u884cApp\uff0c\u67e5\u770b\u7ed3\u679c,\u8bf4\u660e\u4e24\u4e2a\u53c2\u6570\u90fd\u5df2\u7ecf\u88ab\u83b7\u53d6\u5230"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630233548743",src:t(41837).Z,width:"680",height:"262"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u8bf4\u660e:")),(0,i.kt)("p",null,"\u4f7f\u7528JoinPoint\u7684\u65b9\u5f0f\u83b7\u53d6\u53c2\u6570\u9002\u7528\u4e8e",(0,i.kt)("inlineCode",{parentName:"p"},"\u524d\u7f6e"),"\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"\u540e\u7f6e"),"\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"\u8fd4\u56de\u540e"),"\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"\u629b\u51fa\u5f02\u5e38\u540e"),"\u901a\u77e5\u3002\u5269\u4e0b\u7684\u5927\u5bb6\u81ea\u884c\u53bb\u9a8c\u8bc1\u3002"),(0,i.kt)("h5",{id:"\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u65b9\u5f0f"},"\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u65b9\u5f0f"),(0,i.kt)("p",null,"\u73af\u7ed5\u901a\u77e5\u4f7f\u7528\u7684\u662fProceedingJoinPoint\uff0c\u56e0\u4e3aProceedingJoinPoint\u662fJoinPoint\u7c7b\u7684\u5b50\u7c7b\uff0c\u6240\u4ee5\u5bf9\u4e8eProceedingJoinPoint\u7c7b\u4e2d\u5e94\u8be5\u4e5f\u4f1a\u6709\u5bf9\u5e94\u7684",(0,i.kt)("inlineCode",{parentName:"p"},"getArgs()"),"\u65b9\u6cd5\uff0c\u6211\u4eec\u53bb\u9a8c\u8bc1\u4e0b:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(- com.wrm244.dao.BookDao.findName(..))")\n    private void pt(){}\n\n    @Around("pt()")\n    public Object around(ProceedingJoinPoint pjp)throws Throwable {\n        Object[] args = pjp.getArgs();\n        System.out.println(Arrays.toString(args));\n        Object ret = pjp.proceed();\n        return ret;\n    }\n    //\u5176\u4ed6\u7684\u7565\n}\n')),(0,i.kt)("p",null,"\u8fd0\u884cApp\u540e\u67e5\u770b\u8fd0\u884c\u7ed3\u679c\uff0c\u8bf4\u660eProceedingJoinPoint\u4e5f\u662f\u53ef\u4ee5\u901a\u8fc7getArgs()\u83b7\u53d6\u53c2\u6570"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630233974310",src:t(29162).Z,width:"670",height:"251"})),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6ce8\u610f:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"pjp.proceed()\u65b9\u6cd5\u662f\u6709\u4e24\u4e2a\u6784\u9020\u65b9\u6cd5\uff0c\u5206\u522b\u662f:"),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("img",{alt:"1630234756123",src:t(92166).Z,width:"690",height:"132"})),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u8c03\u7528\u65e0\u53c2\u6570\u7684proceed\uff0c\u5f53\u539f\u59cb\u65b9\u6cd5\u6709\u53c2\u6570\uff0c\u4f1a\u5728\u8c03\u7528\u7684\u8fc7\u7a0b\u4e2d\u81ea\u52a8\u4f20\u5165\u53c2\u6570")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6240\u4ee5\u8c03\u7528\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u7684\u4efb\u610f\u4e00\u4e2a\u90fd\u53ef\u4ee5\u5b8c\u6210\u529f\u80fd")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u4f46\u662f\u5f53\u9700\u8981\u4fee\u6539\u539f\u59cb\u65b9\u6cd5\u7684\u53c2\u6570\u65f6\uff0c\u5c31\u53ea\u80fd\u91c7\u7528\u5e26\u6709\u53c2\u6570\u7684\u65b9\u6cd5,\u5982\u4e0b:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(- com.wrm244.dao.BookDao.findName(..))")\n    private void pt(){}\n\n    @Around("pt()")\n    public Object around(ProceedingJoinPoint pjp) throws Throwable{\n        Object[] args = pjp.getArgs();\n        System.out.println(Arrays.toString(args));\n        args[0] = 666;\n        Object ret = pjp.proceed(args);\n        return ret;\n    }\n    //\u5176\u4ed6\u7684\u7565\n}\n')),(0,i.kt)("p",{parentName:"li"},"\u6709\u4e86\u8fd9\u4e2a\u7279\u6027\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u73af\u7ed5\u901a\u77e5\u4e2d\u5bf9\u539f\u59cb\u65b9\u6cd5\u7684\u53c2\u6570\u8fdb\u884c\u62e6\u622a\u8fc7\u6ee4\uff0c\u907f\u514d\u7531\u4e8e\u53c2\u6570\u7684\u95ee\u9898\u5bfc\u81f4\u7a0b\u5e8f\u65e0\u6cd5\u6b63\u786e\u8fd0\u884c\uff0c\u4fdd\u8bc1\u4ee3\u7801\u7684\u5065\u58ee\u6027\u3002"))))),(0,i.kt)("h4",{id:"\u83b7\u53d6\u8fd4\u56de\u503c"},"\u83b7\u53d6\u8fd4\u56de\u503c"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u8fd4\u56de\u503c\uff0c\u53ea\u6709\u8fd4\u56de\u540e",(0,i.kt)("inlineCode",{parentName:"p"},"AfterReturing"),"\u548c\u73af\u7ed5",(0,i.kt)("inlineCode",{parentName:"p"},"Around"),"\u8fd9\u4e24\u4e2a\u901a\u77e5\u7c7b\u578b\u53ef\u4ee5\u83b7\u53d6\uff0c\u5177\u4f53\u5982\u4f55\u83b7\u53d6?"),(0,i.kt)("h5",{id:"\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u8fd4\u56de\u503c"},"\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u8fd4\u56de\u503c"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(- com.wrm244.dao.BookDao.findName(..))")\n    private void pt(){}\n\n    @Around("pt()")\n    public Object around(ProceedingJoinPoint pjp) throws Throwable{\n        Object[] args = pjp.getArgs();\n        System.out.println(Arrays.toString(args));\n        args[0] = 666;\n        Object ret = pjp.proceed(args);\n        return ret;\n    }\n    //\u5176\u4ed6\u7684\u7565\n}\n')),(0,i.kt)("p",null,"\u4e0a\u8ff0\u4ee3\u7801\u4e2d\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"ret"),"\u5c31\u662f\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\uff0c\u6211\u4eec\u662f\u53ef\u4ee5\u76f4\u63a5\u83b7\u53d6\uff0c\u4e0d\u4f46\u53ef\u4ee5\u83b7\u53d6\uff0c\u5982\u679c\u9700\u8981\u8fd8\u53ef\u4ee5\u8fdb\u884c\u4fee\u6539\u3002"),(0,i.kt)("h5",{id:"\u8fd4\u56de\u540e\u901a\u77e5\u83b7\u53d6\u8fd4\u56de\u503c"},"\u8fd4\u56de\u540e\u901a\u77e5\u83b7\u53d6\u8fd4\u56de\u503c"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(- com.wrm244.dao.BookDao.findName(..))")\n    private void pt(){}\n\n    @AfterReturning(value = "pt()",returning = "ret")\n    public void afterReturning(Object ret) {\n        System.out.println("afterReturning advice ..."+ret);\n    }\n    //\u5176\u4ed6\u7684\u7565\n}\n')),(0,i.kt)("p",null,"\u6ce8\u610f:"),(0,i.kt)("p",null,"(1)\u53c2\u6570\u540d\u7684\u95ee\u9898"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630237320870",src:t(48801).Z,width:"919",height:"119"})),(0,i.kt)("p",null,"(2)afterReturning\u65b9\u6cd5\u53c2\u6570\u7c7b\u578b\u7684\u95ee\u9898"),(0,i.kt)("p",null,"\u53c2\u6570\u7c7b\u578b\u53ef\u4ee5\u5199\u6210String\uff0c\u4f46\u662f\u4e3a\u4e86\u80fd\u5339\u914d\u66f4\u591a\u7684\u53c2\u6570\u7c7b\u578b\uff0c\u5efa\u8bae\u5199\u6210Object\u7c7b\u578b"),(0,i.kt)("p",null,"(3)afterReturning\u65b9\u6cd5\u53c2\u6570\u7684\u987a\u5e8f\u95ee\u9898"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630237586682",src:t(85874).Z,width:"822",height:"123"})),(0,i.kt)("p",null,"\u8fd0\u884cApp\u540e\u67e5\u770b\u8fd0\u884c\u7ed3\u679c\uff0c\u8bf4\u660e\u8fd4\u56de\u503c\u5df2\u7ecf\u88ab\u83b7\u53d6\u5230"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630237372286",src:t(86680).Z,width:"640",height:"215"})),(0,i.kt)("h4",{id:"\u83b7\u53d6\u5f02\u5e38"},"\u83b7\u53d6\u5f02\u5e38"),(0,i.kt)("p",null,"\u5bf9\u4e8e\u83b7\u53d6\u629b\u51fa\u7684\u5f02\u5e38\uff0c\u53ea\u6709\u629b\u51fa\u5f02\u5e38\u540e",(0,i.kt)("inlineCode",{parentName:"p"},"AfterThrowing"),"\u548c\u73af\u7ed5",(0,i.kt)("inlineCode",{parentName:"p"},"Around"),"\u8fd9\u4e24\u4e2a\u901a\u77e5\u7c7b\u578b\u53ef\u4ee5\u83b7\u53d6\uff0c\u5177\u4f53\u5982\u4f55\u83b7\u53d6?"),(0,i.kt)("h5",{id:"\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u5f02\u5e38"},"\u73af\u7ed5\u901a\u77e5\u83b7\u53d6\u5f02\u5e38"),(0,i.kt)("p",null,"\u8fd9\u5757\u6bd4\u8f83\u7b80\u5355\uff0c\u4ee5\u524d\u6211\u4eec\u662f\u629b\u51fa\u5f02\u5e38\uff0c\u73b0\u5728\u53ea\u9700\u8981\u5c06\u5f02\u5e38\u6355\u83b7\uff0c\u5c31\u53ef\u4ee5\u83b7\u53d6\u5230\u539f\u59cb\u65b9\u6cd5\u7684\u5f02\u5e38\u4fe1\u606f\u4e86"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(- com.wrm244.dao.BookDao.findName(..))")\n    private void pt(){}\n\n    @Around("pt()")\n    public Object around(ProceedingJoinPoint pjp){\n        Object[] args = pjp.getArgs();\n        System.out.println(Arrays.toString(args));\n        args[0] = 666;\n        Object ret = null;\n        try{\n            ret = pjp.proceed(args);\n        }catch(Throwable throwable){\n            t.printStackTrace();\n        }\n        return ret;\n    }\n    //\u5176\u4ed6\u7684\u7565\n}\n')),(0,i.kt)("p",null,"\u5728catch\u65b9\u6cd5\u4e2d\u5c31\u53ef\u4ee5\u83b7\u53d6\u5230\u5f02\u5e38\uff0c\u81f3\u4e8e\u83b7\u53d6\u5230\u5f02\u5e38\u4ee5\u540e\u8be5\u5982\u4f55\u5904\u7406\uff0c\u8fd9\u4e2a\u5c31\u548c\u4f60\u7684\u4e1a\u52a1\u9700\u6c42\u6709\u5173\u4e86\u3002"),(0,i.kt)("h5",{id:"\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5\u83b7\u53d6\u5f02\u5e38"},"\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5\u83b7\u53d6\u5f02\u5e38"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class MyAdvice {\n    @Pointcut("execution(- com.wrm244.dao.BookDao.findName(..))")\n    private void pt(){}\n\n    @AfterThrowing(value = "pt()",throwing = "t")\n    public void afterThrowing(Throwable t) {\n        System.out.println("afterThrowing advice ..."+t);\n    }\n    //\u5176\u4ed6\u7684\u7565\n}\n')),(0,i.kt)("p",null,"\u5982\u4f55\u8ba9\u539f\u59cb\u65b9\u6cd5\u629b\u51fa\u5f02\u5e38\uff0c\u65b9\u5f0f\u6709\u5f88\u591a\uff0c"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Repository\npublic class BookDaoImpl implements BookDao {\n\n    public String findName(int id,String password) {\n        System.out.println("id:"+id);\n        if(true){\n            throw new NullPointerException();\n        }\n        return "itcast";\n    }\n}\n')),(0,i.kt)("p",null,"\u6ce8\u610f:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630239939043",src:t(84761).Z,width:"1078",height:"125"})),(0,i.kt)("p",null,"\u8fd0\u884cApp\u540e\uff0c\u67e5\u770b\u63a7\u5236\u53f0\uff0c\u5c31\u80fd\u770b\u7684\u5f02\u5e38\u4fe1\u606f\u88ab\u6253\u5370\u5230\u63a7\u5236\u53f0"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630239997560",src:t(84532).Z,width:"1181",height:"206"})),(0,i.kt)("p",null,"\u81f3\u6b64\uff0cAOP\u901a\u77e5\u5982\u4f55\u83b7\u53d6\u6570\u636e\u5c31\u5df2\u7ecf\u8bb2\u89e3\u5b8c\u4e86\uff0c\u6570\u636e\u4e2d\u5305\u542b",(0,i.kt)("inlineCode",{parentName:"p"},"\u53c2\u6570"),"\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"\u8fd4\u56de\u503c"),"\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"\u5f02\u5e38(\u4e86\u89e3)"),"\u3002"),(0,i.kt)("h3",{id:"\u767e\u5ea6\u7f51\u76d8\u5bc6\u7801\u6570\u636e\u517c\u5bb9\u5904\u7406"},"\u767e\u5ea6\u7f51\u76d8\u5bc6\u7801\u6570\u636e\u517c\u5bb9\u5904\u7406"),(0,i.kt)("h4",{id:"\u9700\u6c42\u5206\u6790-2"},"\u9700\u6c42\u5206\u6790"),(0,i.kt)("p",null,"\u9700\u6c42: \u5bf9\u767e\u5ea6\u7f51\u76d8\u5206\u4eab\u94fe\u63a5\u8f93\u5165\u5bc6\u7801\u65f6\u5c3e\u90e8\u591a\u8f93\u5165\u7684\u7a7a\u683c\u505a\u517c\u5bb9\u5904\u7406\u3002"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630240203033",src:t(43807).Z,width:"892",height:"157"})),(0,i.kt)("p",null,"\u95ee\u9898\u63cf\u8ff0:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u70b9\u51fb\u94fe\u63a5\uff0c\u4f1a\u63d0\u793a\uff0c\u8bf7\u8f93\u5165\u63d0\u53d6\u7801\uff0c\u5982\u4e0b\u56fe\u6240\u793a"),(0,i.kt)("p",{parentName:"li"},(0,i.kt)("img",{alt:"1630240528228",src:t(73662).Z,width:"579",height:"501"}))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5f53\u6211\u4eec\u4ece\u522b\u4eba\u53d1\u7ed9\u6211\u4eec\u7684\u5185\u5bb9\u4e2d\u590d\u5236\u63d0\u53d6\u7801\u7684\u65f6\u5019\uff0c\u6709\u65f6\u5019\u4f1a\u591a\u590d\u5236\u5230\u4e00\u4e9b\u7a7a\u683c\uff0c\u76f4\u63a5\u7c98\u8d34\u5230\u767e\u5ea6\u7684\u63d0\u53d6\u7801\u8f93\u5165\u6846")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u4f46\u662f\u767e\u5ea6\u90a3\u8fb9\u8bb0\u5f55\u7684\u63d0\u53d6\u7801\u662f\u6ca1\u6709\u7a7a\u683c\u7684")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u8fd9\u4e2a\u65f6\u5019\u5982\u679c\u4e0d\u505a\u5904\u7406\uff0c\u76f4\u63a5\u5bf9\u6bd4\u7684\u8bdd\uff0c\u5c31\u4f1a\u5f15\u53d1\u63d0\u53d6\u7801\u4e0d\u4e00\u81f4\uff0c\u5bfc\u81f4\u65e0\u6cd5\u8bbf\u95ee\u767e\u5ea6\u76d8\u4e0a\u7684\u5185\u5bb9")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6240\u4ee5\u591a\u8f93\u5165\u4e00\u4e2a\u7a7a\u683c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u9879\u76ee\u7684\u529f\u80fd\u65e0\u6cd5\u6b63\u5e38\u4f7f\u7528\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6b64\u65f6\u6211\u4eec\u5c31\u60f3\u80fd\u4e0d\u80fd\u5c06\u8f93\u5165\u7684\u53c2\u6570\u5148\u5e2e\u7528\u6237\u53bb\u6389\u7a7a\u683c\u518d\u64cd\u4f5c\u5462?"))),(0,i.kt)("p",null,"\u7b54\u6848\u662f\u53ef\u4ee5\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u4e1a\u52a1\u65b9\u6cd5\u6267\u884c\u4e4b\u524d\u5bf9\u6240\u6709\u7684\u8f93\u5165\u53c2\u6570\u8fdb\u884c\u683c\u5f0f\u5904\u7406\u2014\u2014trim()"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u662f\u5bf9\u6240\u6709\u7684\u53c2\u6570\u90fd\u9700\u8981\u53bb\u9664\u7a7a\u683c\u4e48?")),(0,i.kt)("p",null,"\u4e5f\u6ca1\u6709\u5fc5\u8981\uff0c\u4e00\u822c\u53ea\u9700\u8981\u9488\u5bf9\u5b57\u7b26\u4e32\u5904\u7406\u5373\u53ef\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4ee5\u540e\u6d89\u53ca\u5230\u9700\u8981\u53bb\u9664\u524d\u540e\u7a7a\u683c\u7684\u4e1a\u52a1\u53ef\u80fd\u4f1a\u6709\u5f88\u591a\uff0c\u8fd9\u4e2a\u53bb\u7a7a\u683c\u7684\u4ee3\u7801\u662f\u6bcf\u4e2a\u4e1a\u52a1\u90fd\u5199\u4e48?")),(0,i.kt)("p",null,"\u53ef\u4ee5\u8003\u8651\u4f7f\u7528AOP\u6765\u7edf\u4e00\u5904\u7406\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"AOP\u6709\u4e94\u79cd\u901a\u77e5\u7c7b\u578b\uff0c\u8be5\u4f7f\u7528\u54ea\u79cd\u5462?")),(0,i.kt)("p",null,"\u6211\u4eec\u7684\u9700\u6c42\u662f\u5c06\u539f\u59cb\u65b9\u6cd5\u7684\u53c2\u6570\u5904\u7406\u540e\u5728\u53c2\u4e0e\u539f\u59cb\u65b9\u6cd5\u7684\u8c03\u7528\uff0c\u80fd\u505a\u8fd9\u4ef6\u4e8b\u7684\u5c31\u53ea\u6709\u73af\u7ed5\u901a\u77e5\u3002"),(0,i.kt)("p",null,"\u7efc\u4e0a\u6240\u8ff0\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651\u4e24\u4ef6\u4e8b:\n\u2460\uff1a\u5728\u4e1a\u52a1\u65b9\u6cd5\u6267\u884c\u4e4b\u524d\u5bf9\u6240\u6709\u7684\u8f93\u5165\u53c2\u6570\u8fdb\u884c\u683c\u5f0f\u5904\u7406\u2014\u2014trim()\n\u2461\uff1a\u4f7f\u7528\u5904\u7406\u540e\u7684\u53c2\u6570\u8c03\u7528\u539f\u59cb\u65b9\u6cd5\u2014\u2014\u73af\u7ed5\u901a\u77e5\u4e2d\u5b58\u5728\u5bf9\u539f\u59cb\u65b9\u6cd5\u7684\u8c03\u7528"),(0,i.kt)("h4",{id:"\u73af\u5883\u51c6\u5907-4"},"\u73af\u5883\u51c6\u5907"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u521b\u5efa\u4e00\u4e2aMaven\u9879\u76ee")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"pom.xml\u6dfb\u52a0Spring\u4f9d\u8d56"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-xml"},"<dependencies>\n    <dependency>\n      <groupId>org.springframework</groupId>\n      <artifactId>spring-context</artifactId>\n      <version>5.2.10.RELEASE</version>\n    </dependency>\n    <dependency>\n      <groupId>org.aspectj</groupId>\n      <artifactId>aspectjweaver</artifactId>\n      <version>1.9.4</version>\n    </dependency>\n  </dependencies>\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6dfb\u52a0ResourcesService\uff0cResourcesServiceImpl,ResourcesDao\u548cResourcesDaoImpl\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public interface ResourcesDao {\n    boolean readResources(String url, String password);\n}\n@Repository\npublic class ResourcesDaoImpl implements ResourcesDao {\n    public boolean readResources(String url, String password) {\n        //\u6a21\u62df\u6821\u9a8c\n        return password.equals("root");\n    }\n}\npublic interface ResourcesService {\n    public boolean openURL(String url ,String password);\n}\n@Service\npublic class ResourcesServiceImpl implements ResourcesService {\n    @Autowired\n    private ResourcesDao resourcesDao;\n\n    public boolean openURL(String url, String password) {\n        return resourcesDao.readResources(url,password);\n    }\n}\n\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u521b\u5efaSpring\u7684\u914d\u7f6e\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\n@ComponentScan("com.wrm244")\npublic class SpringConfig {\n}\n'))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u7f16\u5199App\u8fd0\u884c\u7c7b"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class App {\n    public static void main(String[] args) {\n        ApplicationContext ctx = new AnnotationConfigApplicationContext(SpringConfig.class);\n        ResourcesService resourcesService = ctx.getBean(ResourcesService.class);\n        boolean flag = resourcesService.openURL("http://pan.baidu.com/haha", "root");\n        System.out.println(flag);\n    }\n}\n')))),(0,i.kt)("p",null,"\u6700\u7ec8\u521b\u5efa\u597d\u7684\u9879\u76ee\u7ed3\u6784\u5982\u4e0b:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630241681697",src:t(28637).Z,width:"405",height:"424"})),(0,i.kt)("p",null,'\u73b0\u5728\u9879\u76ee\u7684\u6548\u679c\u662f\uff0c\u5f53\u8f93\u5165\u5bc6\u7801\u4e3a"root"\u63a7\u5236\u53f0\u6253\u5370\u4e3atrue,\u5982\u679c\u5bc6\u7801\u6539\u4e3a"root  "\u63a7\u5236\u53f0\u6253\u5370\u7684\u662ffalse'),(0,i.kt)("p",null,"\u9700\u6c42\u662f\u4f7f\u7528AOP\u5c06\u53c2\u6570\u8fdb\u884c\u7edf\u4e00\u5904\u7406\uff0c\u4e0d\u7ba1\u8f93\u5165\u7684\u5bc6\u7801",(0,i.kt)("inlineCode",{parentName:"p"},"root"),"\u524d\u540e\u5305\u542b\u591a\u5c11\u4e2a\u7a7a\u683c\uff0c\u6700\u7ec8\u63a7\u5236\u53f0\u6253\u5370\u7684\u90fd\u662ftrue\u3002"),(0,i.kt)("h4",{id:"\u5177\u4f53\u5b9e\u73b0"},"\u5177\u4f53\u5b9e\u73b0"),(0,i.kt)("h5",{id:"\u6b65\u9aa41\u5f00\u542fspringaop\u7684\u6ce8\u89e3\u529f\u80fd-1"},"\u6b65\u9aa41:\u5f00\u542fSpringAOP\u7684\u6ce8\u89e3\u529f\u80fd"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\n@ComponentScan("com.wrm244")\n@EnableAspectJAutoProxy\npublic class SpringConfig {\n}\n')),(0,i.kt)("h5",{id:"\u6b65\u9aa42\u7f16\u5199\u901a\u77e5\u7c7b"},"\u6b65\u9aa42:\u7f16\u5199\u901a\u77e5\u7c7b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class DataAdvice {\n    @Pointcut("execution(boolean com.wrm244.service.*Service.*(*,*))")\n    private void servicePt(){}\n    \n}\n')),(0,i.kt)("h5",{id:"\u6b65\u9aa43\u6dfb\u52a0\u73af\u7ed5\u901a\u77e5-1"},"\u6b65\u9aa43:\u6dfb\u52a0\u73af\u7ed5\u901a\u77e5"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class DataAdvice {\n    @Pointcut("execution(boolean com.wrm244.service.*Service.*(*,*))")\n    private void servicePt(){}\n    \n    @Around("DataAdvice.servicePt()")\n    // @Around("servicePt()")\u8fd9\u4e24\u79cd\u5199\u6cd5\u90fd\u5bf9\n    public Object trimStr(ProceedingJoinPoint pjp) throws Throwable {\n        Object ret = pjp.proceed();\n        return ret;\n    }\n    \n}\n')),(0,i.kt)("h5",{id:"\u6b65\u9aa44\u5b8c\u6210\u6838\u5fc3\u4e1a\u52a1\u5904\u7406\u53c2\u6570\u4e2d\u7684\u7a7a\u683c"},"\u6b65\u9aa44:\u5b8c\u6210\u6838\u5fc3\u4e1a\u52a1\uff0c\u5904\u7406\u53c2\u6570\u4e2d\u7684\u7a7a\u683c"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Component\n@Aspect\npublic class DataAdvice {\n    @Pointcut("execution(boolean com.wrm244.service.*Service.*(*,*))")\n    private void servicePt(){}\n    \n    @Around("DataAdvice.servicePt()")\n    // @Around("servicePt()")\u8fd9\u4e24\u79cd\u5199\u6cd5\u90fd\u5bf9\n    public Object trimStr(ProceedingJoinPoint pjp) throws Throwable {\n        //\u83b7\u53d6\u539f\u59cb\u65b9\u6cd5\u7684\u53c2\u6570\n        Object[] args = pjp.getArgs();\n        for (int i = 0; i < args.length; i++) {\n            //\u5224\u65ad\u53c2\u6570\u662f\u4e0d\u662f\u5b57\u7b26\u4e32\n            if(args[i].getClass().equals(String.class)){\n                //args[i] instanceof String\n                args[i] = args[i].toString().trim();\n                //trim()\u65b9\u6cd5\u5b9e\u9645\u4e0atrim\u6389\u4e86\u5b57\u7b26\u4e32\u4e24\u7aefUnicode\u7f16\u7801\u5c0f\u4e8e\u7b49\u4e8e32\uff08\\u0020\uff09\u7684\u6240\u6709\u5b57\u7b26\u3002\n            }\n        }\n        //\u5c06\u4fee\u6539\u540e\u7684\u53c2\u6570\u4f20\u5165\u5230\u539f\u59cb\u65b9\u6cd5\u7684\u6267\u884c\u4e2d\n        Object ret = pjp.proceed(args);\n        return ret;\n    }\n    \n}\n')),(0,i.kt)("h5",{id:"\u6b65\u9aa45\u8fd0\u884c\u7a0b\u5e8f-1"},"\u6b65\u9aa45:\u8fd0\u884c\u7a0b\u5e8f"),(0,i.kt)("p",null,"\u4e0d\u7ba1\u5bc6\u7801",(0,i.kt)("inlineCode",{parentName:"p"},"root"),"\u524d\u540e\u662f\u5426\u52a0\u7a7a\u683c\uff0c\u6700\u7ec8\u63a7\u5236\u53f0\u6253\u5370\u7684\u90fd\u662ftrue"),(0,i.kt)("h5",{id:"\u6b65\u9aa46\u4f18\u5316\u6d4b\u8bd5"},"\u6b65\u9aa46:\u4f18\u5316\u6d4b\u8bd5"),(0,i.kt)("p",null,"\u4e3a\u4e86\u80fd\u66f4\u597d\u7684\u770b\u51faAOP\u5df2\u7ecf\u751f\u6548\uff0c\u6211\u4eec\u53ef\u4ee5\u4fee\u6539ResourcesImpl\u7c7b\uff0c\u5728\u65b9\u6cd5\u4e2d\u5c06\u5bc6\u7801\u7684\u957f\u5ea6\u8fdb\u884c\u6253\u5370"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Repository\npublic class ResourcesDaoImpl implements ResourcesDao {\n    public boolean readResources(String url, String password) {\n        System.out.println(password.length());\n        //\u6a21\u62df\u6821\u9a8c\n        return password.equals("root");\n    }\n}\n')),(0,i.kt)("p",null,"\u518d\u6b21\u8fd0\u884c\u6210\u529f\uff0c\u5c31\u53ef\u4ee5\u6839\u636e\u6700\u7ec8\u6253\u5370\u7684\u957f\u5ea6\u6765\u770b\u770b\uff0c\u5b57\u7b26\u4e32\u7684\u7a7a\u683c\u6709\u6ca1\u6709\u88ab\u53bb\u9664\u6389\u3002"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6ce8\u610f\uff1a")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630242491831",src:t(32806).Z,width:"827",height:"400"})),(0,i.kt)("h2",{id:"aop\u603b\u7ed3"},"AOP\u603b\u7ed3"),(0,i.kt)("p",null,"AOP\u7684\u77e5\u8bc6\u5c31\u5df2\u7ecf\u8bb2\u89e3\u5b8c\u4e86\uff0c\u63a5\u4e0b\u6765\u5bf9\u4e8eAOP\u7684\u77e5\u8bc6\u8fdb\u884c\u4e00\u4e2a\u603b\u7ed3:"),(0,i.kt)("h3",{id:"aop\u7684\u6838\u5fc3\u6982\u5ff5"},"AOP\u7684\u6838\u5fc3\u6982\u5ff5"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u6982\u5ff5\uff1aAOP(Aspect Oriented Programming)\u9762\u5411\u5207\u9762\u7f16\u7a0b\uff0c\u4e00\u79cd\u7f16\u7a0b\u8303\u5f0f"),(0,i.kt)("li",{parentName:"ul"},"\u4f5c\u7528\uff1a\u5728\u4e0d\u60ca\u52a8\u539f\u59cb\u8bbe\u8ba1\u7684\u57fa\u7840\u4e0a\u4e3a\u65b9\u6cd5\u8fdb\u884c\u529f\u80fd\u589e\u5f3a"),(0,i.kt)("li",{parentName:"ul"},"\u6838\u5fc3\u6982\u5ff5",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u4ee3\u7406\uff08Proxy\uff09\uff1aSpringAOP\u7684\u6838\u5fc3\u672c\u8d28\u662f\u91c7\u7528\u4ee3\u7406\u6a21\u5f0f\u5b9e\u73b0\u7684"),(0,i.kt)("li",{parentName:"ul"},"\u8fde\u63a5\u70b9\uff08JoinPoint\uff09\uff1a\u5728SpringAOP\u4e2d\uff0c\u7406\u89e3\u4e3a\u4efb\u610f\u65b9\u6cd5\u7684\u6267\u884c"),(0,i.kt)("li",{parentName:"ul"},"\u5207\u5165\u70b9\uff08Pointcut\uff09\uff1a\u5339\u914d\u8fde\u63a5\u70b9\u7684\u5f0f\u5b50\uff0c\u4e5f\u662f\u5177\u6709\u5171\u6027\u529f\u80fd\u7684\u65b9\u6cd5\u63cf\u8ff0"),(0,i.kt)("li",{parentName:"ul"},"\u901a\u77e5\uff08Advice\uff09\uff1a\u82e5\u5e72\u4e2a\u65b9\u6cd5\u7684\u5171\u6027\u529f\u80fd\uff0c\u5728\u5207\u5165\u70b9\u5904\u6267\u884c\uff0c\u6700\u7ec8\u4f53\u73b0\u4e3a\u4e00\u4e2a\u65b9\u6cd5"),(0,i.kt)("li",{parentName:"ul"},"\u5207\u9762\uff08Aspect\uff09\uff1a\u63cf\u8ff0\u901a\u77e5\u4e0e\u5207\u5165\u70b9\u7684\u5bf9\u5e94\u5173\u7cfb"),(0,i.kt)("li",{parentName:"ul"},"\u76ee\u6807\u5bf9\u8c61\uff08Target\uff09\uff1a\u88ab\u4ee3\u7406\u7684\u539f\u59cb\u5bf9\u8c61\u6210\u4e3a\u76ee\u6807\u5bf9\u8c61")))),(0,i.kt)("h3",{id:"\u5207\u5165\u70b9\u8868\u8fbe\u5f0f"},"\u5207\u5165\u70b9\u8868\u8fbe\u5f0f"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u6807\u51c6\u683c\u5f0f\uff1a\u52a8\u4f5c\u5173\u952e\u5b57(\u8bbf\u95ee\u4fee\u9970\u7b26  \u8fd4\u56de\u503c  \u5305\u540d.\u7c7b/\u63a5\u53e3\u540d.\u65b9\u6cd5\u540d\uff08\u53c2\u6570\uff09\u5f02\u5e38\u540d)"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"execution(- com.wrm244.service.*Service.*(..))\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u63cf\u8ff0\u901a\u914d\u7b26\uff1a"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u4f5c\u7528\uff1a\u7528\u4e8e\u5feb\u901f\u63cf\u8ff0\uff0c\u8303\u56f4\u63cf\u8ff0"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"*"),"\uff1a\u5339\u914d\u4efb\u610f\u7b26\u53f7\uff08\u5e38\u7528\uff09"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"..")," \uff1a\u5339\u914d\u591a\u4e2a\u8fde\u7eed\u7684\u4efb\u610f\u7b26\u53f7\uff08\u5e38\u7528\uff09"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"+"),"\uff1a\u5339\u914d\u5b50\u7c7b\u7c7b\u578b"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5207\u5165\u70b9\u8868\u8fbe\u5f0f\u4e66\u5199\u6280\u5de7"),(0,i.kt)("p",{parentName:"li"},"1.\u6309\u6807\u51c6\u89c4\u8303\u5f00\u53d1\n2.\u67e5\u8be2\u64cd\u4f5c\u7684\u8fd4\u56de\u503c\u5efa\u8bae\u4f7f\u7528",(0,i.kt)("inlineCode",{parentName:"p"},"\\*"),"\u5339\u914d\n3.\u51cf\u5c11\u4f7f\u7528..\u7684\u5f62\u5f0f\u63cf\u8ff0\u5305\n4.\u5bf9\u63a5\u53e3\u8fdb\u884c\u63cf\u8ff0\uff0c\u4f7f\u7528",(0,i.kt)("inlineCode",{parentName:"p"},"\\*"),"\u8868\u793a\u6a21\u5757\u540d\uff0c\u4f8b\u5982UserService\u7684\u5339\u914d\u63cf\u8ff0\u4e3a*Service\n5.\u65b9\u6cd5\u540d\u4e66\u5199\u4fdd\u7559\u52a8\u8bcd\uff0c\u4f8b\u5982get\uff0c\u4f7f\u7528",(0,i.kt)("inlineCode",{parentName:"p"},"\\*"),"\u8868\u793a\u540d\u8bcd\uff0c\u4f8b\u5982getById\u5339\u914d\u63cf\u8ff0\u4e3agetBy",(0,i.kt)("inlineCode",{parentName:"p"},"\\*"),"\n6.\u53c2\u6570\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u7075\u6d3b\u8c03\u6574"))),(0,i.kt)("h3",{id:"\u4e94\u79cd\u901a\u77e5\u7c7b\u578b"},"\u4e94\u79cd\u901a\u77e5\u7c7b\u578b"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u524d\u7f6e\u901a\u77e5"),(0,i.kt)("li",{parentName:"ul"},"\u540e\u7f6e\u901a\u77e5"),(0,i.kt)("li",{parentName:"ul"},"\u73af\u7ed5\u901a\u77e5\uff08\u91cd\u70b9\uff09",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u73af\u7ed5\u901a\u77e5\u4f9d\u8d56\u5f62\u53c2ProceedingJoinPoint\u624d\u80fd\u5b9e\u73b0\u5bf9\u539f\u59cb\u65b9\u6cd5\u7684\u8c03\u7528"),(0,i.kt)("li",{parentName:"ul"},"\u73af\u7ed5\u901a\u77e5\u53ef\u4ee5\u9694\u79bb\u539f\u59cb\u65b9\u6cd5\u7684\u8c03\u7528\u6267\u884c"),(0,i.kt)("li",{parentName:"ul"},"\u73af\u7ed5\u901a\u77e5\u8fd4\u56de\u503c\u8bbe\u7f6e\u4e3aObject\u7c7b\u578b"),(0,i.kt)("li",{parentName:"ul"},"\u73af\u7ed5\u901a\u77e5\u4e2d\u53ef\u4ee5\u5bf9\u539f\u59cb\u65b9\u6cd5\u8c03\u7528\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u7684\u5f02\u5e38\u8fdb\u884c\u5904\u7406"))),(0,i.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u540e\u901a\u77e5"),(0,i.kt)("li",{parentName:"ul"},"\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5")),(0,i.kt)("h3",{id:"\u901a\u77e5\u4e2d\u83b7\u53d6\u53c2\u6570"},"\u901a\u77e5\u4e2d\u83b7\u53d6\u53c2\u6570"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u5207\u5165\u70b9\u65b9\u6cd5\u7684\u53c2\u6570\uff0c\u6240\u6709\u7684\u901a\u77e5\u7c7b\u578b\u90fd\u53ef\u4ee5\u83b7\u53d6\u53c2\u6570",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"JoinPoint\uff1a\u9002\u7528\u4e8e\u524d\u7f6e\u3001\u540e\u7f6e\u3001\u8fd4\u56de\u540e\u3001\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5"),(0,i.kt)("li",{parentName:"ul"},"ProceedingJoinPoint\uff1a\u9002\u7528\u4e8e\u73af\u7ed5\u901a\u77e5"))),(0,i.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u5207\u5165\u70b9\u65b9\u6cd5\u8fd4\u56de\u503c\uff0c\u524d\u7f6e\u548c\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5\u662f\u6ca1\u6709\u8fd4\u56de\u503c\uff0c\u540e\u7f6e\u901a\u77e5\u53ef\u6709\u53ef\u65e0\uff0c\u6240\u4ee5\u4e0d\u505a\u7814\u7a76",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u8fd4\u56de\u540e\u901a\u77e5"),(0,i.kt)("li",{parentName:"ul"},"\u73af\u7ed5\u901a\u77e5"))),(0,i.kt)("li",{parentName:"ul"},"\u83b7\u53d6\u5207\u5165\u70b9\u65b9\u6cd5\u8fd0\u884c\u5f02\u5e38\u4fe1\u606f\uff0c\u524d\u7f6e\u548c\u8fd4\u56de\u540e\u901a\u77e5\u662f\u4e0d\u4f1a\u6709\uff0c\u540e\u7f6e\u901a\u77e5\u53ef\u6709\u53ef\u65e0\uff0c\u6240\u4ee5\u4e0d\u505a\u7814\u7a76",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u629b\u51fa\u5f02\u5e38\u540e\u901a\u77e5"),(0,i.kt)("li",{parentName:"ul"},"\u73af\u7ed5\u901a\u77e5")))),(0,i.kt)("h2",{id:"aop\u4e8b\u52a1\u7ba1\u7406"},"AOP\u4e8b\u52a1\u7ba1\u7406"),(0,i.kt)("h3",{id:"spring\u4e8b\u52a1\u7b80\u4ecb"},"Spring\u4e8b\u52a1\u7b80\u4ecb"),(0,i.kt)("h4",{id:"\u76f8\u5173\u6982\u5ff5\u4ecb\u7ecd"},"\u76f8\u5173\u6982\u5ff5\u4ecb\u7ecd"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4e8b\u52a1\u4f5c\u7528\uff1a\u5728\u6570\u636e\u5c42\u4fdd\u969c\u4e00\u7cfb\u5217\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u540c\u6210\u529f\u540c\u5931\u8d25"),(0,i.kt)("li",{parentName:"ul"},"Spring\u4e8b\u52a1\u4f5c\u7528\uff1a\u5728\u6570\u636e\u5c42\u6216",(0,i.kt)("strong",{parentName:"li"},"\u4e1a\u52a1\u5c42"),"\u4fdd\u969c\u4e00\u7cfb\u5217\u7684\u6570\u636e\u5e93\u64cd\u4f5c\u540c\u6210\u529f\u540c\u5931\u8d25")),(0,i.kt)("p",null,"\u6570\u636e\u5c42\u6709\u4e8b\u52a1\u6211\u4eec\u53ef\u4ee5\u7406\u89e3\uff0c\u4e3a\u4ec0\u4e48\u4e1a\u52a1\u5c42\u4e5f\u9700\u8981\u5904\u7406\u4e8b\u52a1\u5462?"),(0,i.kt)("p",null,"\u4e3e\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff0c"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u8f6c\u8d26\u4e1a\u52a1\u4f1a\u6709\u4e24\u6b21\u6570\u636e\u5c42\u7684\u8c03\u7528\uff0c\u4e00\u6b21\u662f\u52a0\u94b1\u4e00\u6b21\u662f\u51cf\u94b1"),(0,i.kt)("li",{parentName:"ul"},"\u628a\u4e8b\u52a1\u653e\u5728\u6570\u636e\u5c42\uff0c\u52a0\u94b1\u548c\u51cf\u94b1\u5c31\u6709\u4e24\u4e2a\u4e8b\u52a1"),(0,i.kt)("li",{parentName:"ul"},"\u6ca1\u529e\u6cd5\u4fdd\u8bc1\u52a0\u94b1\u548c\u51cf\u94b1\u540c\u65f6\u6210\u529f\u6216\u8005\u540c\u65f6\u5931\u8d25"),(0,i.kt)("li",{parentName:"ul"},"\u8fd9\u4e2a\u65f6\u5019\u5c31\u9700\u8981\u5c06\u4e8b\u52a1\u653e\u5728\u4e1a\u52a1\u5c42\u8fdb\u884c\u5904\u7406\u3002")),(0,i.kt)("p",null,"Spring\u4e3a\u4e86\u7ba1\u7406\u4e8b\u52a1\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5e73\u53f0\u4e8b\u52a1\u7ba1\u7406\u5668",(0,i.kt)("inlineCode",{parentName:"p"},"PlatformTransactionManager")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630243651541",src:t(71306).Z,width:"1578",height:"212"})),(0,i.kt)("p",null,"commit\u662f\u7528\u6765\u63d0\u4ea4\u4e8b\u52a1\uff0crollback\u662f\u7528\u6765\u56de\u6eda\u4e8b\u52a1\u3002"),(0,i.kt)("p",null,"PlatformTransactionManager\u53ea\u662f\u4e00\u4e2a\u63a5\u53e3\uff0cSpring\u8fd8\u4e3a\u5176\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5177\u4f53\u7684\u5b9e\u73b0:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630243993380",src:t(7866).Z,width:"1581",height:"173"})),(0,i.kt)("p",null,"\u4ece\u540d\u79f0\u4e0a\u53ef\u4ee5\u770b\u51fa\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7ed9\u5b83\u4e00\u4e2aDataSource\u5bf9\u8c61\uff0c\u5b83\u5c31\u53ef\u4ee5\u5e2e\u4f60\u53bb\u5728\u4e1a\u52a1\u5c42\u7ba1\u7406\u4e8b\u52a1\u3002\u5176\u5185\u90e8\u91c7\u7528\u7684\u662fJDBC\u7684\u4e8b\u52a1\u3002\u6240\u4ee5\u8bf4\u5982\u679c\u4f60\u6301\u4e45\u5c42\u91c7\u7528\u7684\u662fJDBC\u76f8\u5173\u7684\u6280\u672f\uff0c\u5c31\u53ef\u4ee5\u91c7\u7528\u8fd9\u4e2a\u4e8b\u52a1\u7ba1\u7406\u5668\u6765\u7ba1\u7406\u4f60\u7684\u4e8b\u52a1\u3002\u800cMybatis\u5185\u90e8\u91c7\u7528\u7684\u5c31\u662fJDBC\u7684\u4e8b\u52a1\uff0c\u6240\u4ee5\u540e\u671f\u6211\u4eecSpring\u6574\u5408Mybatis\u5c31\u91c7\u7528\u7684\u8fd9\u4e2aDataSourceTransactionManager\u4e8b\u52a1\u7ba1\u7406\u5668\u3002"),(0,i.kt)("h4",{id:"\u8f6c\u8d26\u6848\u4f8b-\u9700\u6c42\u5206\u6790"},"\u8f6c\u8d26\u6848\u4f8b-\u9700\u6c42\u5206\u6790"),(0,i.kt)("p",null,"\u63a5\u4e0b\u6765\u901a\u8fc7\u4e00\u4e2a\u6848\u4f8b\u6765\u5b66\u4e60\u4e0bSpring\u662f\u5982\u4f55\u6765\u7ba1\u7406\u4e8b\u52a1\u7684\u3002"),(0,i.kt)("p",null,"\u5148\u6765\u5206\u6790\u4e0b\u9700\u6c42:"),(0,i.kt)("p",null,"\u9700\u6c42: \u5b9e\u73b0\u4efb\u610f\u4e24\u4e2a\u8d26\u6237\u95f4\u8f6c\u8d26\u64cd\u4f5c"),(0,i.kt)("p",null,"\u9700\u6c42\u5fae\u7f29: A\u8d26\u6237\u51cf\u94b1\uff0cB\u8d26\u6237\u52a0\u94b1"),(0,i.kt)("p",null,"\u4e3a\u4e86\u5b9e\u73b0\u4e0a\u8ff0\u7684\u4e1a\u52a1\u9700\u6c42\uff0c\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u4e0b\u9762\u6b65\u9aa4\u6765\u5b9e\u73b0\u4e0b:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u6570\u636e\u5c42\u63d0\u4f9b\u57fa\u7840\u64cd\u4f5c\uff0c\u6307\u5b9a\u8d26\u6237\u51cf\u94b1\uff08outMoney\uff09\uff0c\u6307\u5b9a\u8d26\u6237\u52a0\u94b1\uff08inMoney\uff09")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u4e1a\u52a1\u5c42\u63d0\u4f9b\u8f6c\u8d26\u64cd\u4f5c\uff08transfer\uff09\uff0c\u8c03\u7528\u51cf\u94b1\u4e0e\u52a0\u94b1\u7684\u64cd\u4f5c")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u63d0\u4f9b2\u4e2a\u8d26\u53f7\u548c\u64cd\u4f5c\u91d1\u989d\u6267\u884c\u8f6c\u8d26\u64cd\u4f5c")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u57fa\u4e8eSpring\u6574\u5408MyBatis\u73af\u5883\u642d\u5efa\u4e0a\u8ff0\u64cd\u4f5c"))),(0,i.kt)("h4",{id:"\u8f6c\u8d26\u6848\u4f8b-\u73af\u5883\u642d\u5efa"},"\u8f6c\u8d26\u6848\u4f8b-\u73af\u5883\u642d\u5efa"),(0,i.kt)("h5",{id:"\u6b65\u9aa41\u51c6\u5907\u6570\u636e\u5e93\u8868"},"\u6b65\u9aa41:\u51c6\u5907\u6570\u636e\u5e93\u8868"),(0,i.kt)("p",null,"\u4e4b\u524d\u6211\u4eec\u5728\u6574\u5408Mybatis\u7684\u65f6\u5019\u5df2\u7ecf\u521b\u5efa\u4e86\u8fd9\u4e2a\u8868,\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"create database spring_db character set utf8;\nuse spring_db;\ncreate table tbl_account(\n    id int primary key auto_increment,\n    name varchar(35),\n    money double\n);\ninsert into tbl_account values(1,'Tom',1000);\ninsert into tbl_account values(2,'Jerry',1000);\n")),(0,i.kt)("h5",{id:"\u6b65\u9aa42\u521b\u5efa\u9879\u76ee\u5bfc\u5165jar\u5305"},"\u6b65\u9aa42:\u521b\u5efa\u9879\u76ee\u5bfc\u5165jar\u5305"),(0,i.kt)("p",null,"\u9879\u76ee\u7684pom.xml\u6dfb\u52a0\u76f8\u5173\u4f9d\u8d56"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-xml"},"<dependencies>\n    <dependency>\n      <groupId>org.springframework</groupId>\n      <artifactId>spring-context</artifactId>\n      <version>5.2.10.RELEASE</version>\n    </dependency>\n    <dependency>\n      <groupId>com.alibaba</groupId>\n      <artifactId>druid</artifactId>\n      <version>1.1.16</version>\n    </dependency>\n\n    <dependency>\n      <groupId>org.mybatis</groupId>\n      <artifactId>mybatis</artifactId>\n      <version>3.5.6</version>\n    </dependency>\n\n    <dependency>\n      <groupId>mysql</groupId>\n      <artifactId>mysql-connector-java</artifactId>\n      <version>5.1.47</version>\n    </dependency>\n\n    <dependency>\n      <groupId>org.springframework</groupId>\n      <artifactId>spring-jdbc</artifactId>\n      <version>5.2.10.RELEASE</version>\n    </dependency>\n\n    <dependency>\n      <groupId>org.mybatis</groupId>\n      <artifactId>mybatis-spring</artifactId>\n      <version>1.3.0</version>\n    </dependency>\n\n    <dependency>\n      <groupId>junit</groupId>\n      <artifactId>junit</artifactId>\n      <version>4.12</version>\n      <scope>test</scope>\n    </dependency>\n\n    <dependency>\n      <groupId>org.springframework</groupId>\n      <artifactId>spring-test</artifactId>\n      <version>5.2.10.RELEASE</version>\n    </dependency>\n\n  </dependencies>\n")),(0,i.kt)("h5",{id:"\u6b65\u9aa43\u6839\u636e\u8868\u521b\u5efa\u6a21\u578b\u7c7b"},"\u6b65\u9aa43:\u6839\u636e\u8868\u521b\u5efa\u6a21\u578b\u7c7b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public class Account implements Serializable {\n\n    private Integer id;\n    private String name;\n    private Double money;\n    //setter...getter...toString...\u65b9\u6cd5\u7565    \n}\n")),(0,i.kt)("h5",{id:"\u6b65\u9aa44\u521b\u5efadao\u63a5\u53e3"},"\u6b65\u9aa44:\u521b\u5efaDao\u63a5\u53e3"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public interface AccountDao {\n\n    @Update("update tbl_account set money = money + #{money} where name = #{name}")\n    void inMoney(@Param("name") String name, @Param("money") Double money);\n\n    @Update("update tbl_account set money = money - #{money} where name = #{name}")\n    void outMoney(@Param("name") String name, @Param("money") Double money);\n}\n')),(0,i.kt)("h5",{id:"\u6b65\u9aa45\u521b\u5efaservice\u63a5\u53e3\u548c\u5b9e\u73b0\u7c7b"},"\u6b65\u9aa45:\u521b\u5efaService\u63a5\u53e3\u548c\u5b9e\u73b0\u7c7b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public interface AccountService {\n    /**\n     - \u8f6c\u8d26\u64cd\u4f5c\n     - @param out \u4f20\u51fa\u65b9\n     - @param in \u8f6c\u5165\u65b9\n     - @param money \u91d1\u989d\n     */\n    public void transfer(String out,String in ,Double money) ;\n}\n\n@Service\npublic class AccountServiceImpl implements AccountService {\n\n    @Autowired\n    private AccountDao accountDao;\n\n    public void transfer(String out,String in ,Double money) {\n        accountDao.outMoney(out,money);\n        accountDao.inMoney(in,money);\n    }\n\n}\n")),(0,i.kt)("h5",{id:"\u6b65\u9aa46\u6dfb\u52a0jdbcproperties\u6587\u4ef6"},"\u6b65\u9aa46:\u6dfb\u52a0jdbc.properties\u6587\u4ef6"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-properties"},"jdbc.driver=com.mysql.jdbc.Driver\njdbc.url=jdbc:mysql://localhost:3306/spring_db?useSSL=false\njdbc.username=root\njdbc.password=root\n")),(0,i.kt)("h5",{id:"\u6b65\u9aa47\u521b\u5efajdbcconfig\u914d\u7f6e\u7c7b"},"\u6b65\u9aa47:\u521b\u5efaJdbcConfig\u914d\u7f6e\u7c7b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class JdbcConfig {\n    @Value("${jdbc.driver}")\n    private String driver;\n    @Value("${jdbc.url}")\n    private String url;\n    @Value("${jdbc.username}")\n    private String userName;\n    @Value("${jdbc.password}")\n    private String password;\n\n    @Bean\n    public DataSource dataSource(){\n        DruidDataSource ds = new DruidDataSource();\n        ds.setDriverClassName(driver);\n        ds.setUrl(url);\n        ds.setUsername(userName);\n        ds.setPassword(password);\n        return ds;\n    }\n}\n')),(0,i.kt)("h5",{id:"\u6b65\u9aa48\u521b\u5efamybatisconfig\u914d\u7f6e\u7c7b"},"\u6b65\u9aa48:\u521b\u5efaMybatisConfig\u914d\u7f6e\u7c7b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class MybatisConfig {\n\n    @Bean\n    public SqlSessionFactoryBean sqlSessionFactory(DataSource dataSource){\n        SqlSessionFactoryBean ssfb = new SqlSessionFactoryBean();\n        ssfb.setTypeAliasesPackage("com.wrm244.domain");\n        ssfb.setDataSource(dataSource);\n        return ssfb;\n    }\n\n    @Bean\n    public MapperScannerConfigurer mapperScannerConfigurer(){\n        MapperScannerConfigurer msc = new MapperScannerConfigurer();\n        msc.setBasePackage("com.wrm244.dao");\n        return msc;\n    }\n}\n')),(0,i.kt)("h5",{id:"\u6b65\u9aa49\u521b\u5efaspringconfig\u914d\u7f6e\u7c7b"},"\u6b65\u9aa49:\u521b\u5efaSpringConfig\u914d\u7f6e\u7c7b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\n@ComponentScan("com.wrm244")\n@PropertySource("classpath:jdbc.properties")\n@Import({JdbcConfig.class,MybatisConfig.class})\npublic class SpringConfig {\n}\n\n')),(0,i.kt)("h5",{id:"\u6b65\u9aa410\u7f16\u5199\u6d4b\u8bd5\u7c7b"},"\u6b65\u9aa410:\u7f16\u5199\u6d4b\u8bd5\u7c7b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(classes = SpringConfig.class)\npublic class AccountServiceTest {\n\n    @Autowired\n    private AccountService accountService;\n\n    @Test\n    public void testTransfer() throws IOException {\n        accountService.transfer("Tom","Jerry",100D);\n    }\n\n}\n')),(0,i.kt)("p",null,"\u6700\u7ec8\u521b\u5efa\u597d\u7684\u9879\u76ee\u7ed3\u6784\u5982\u4e0b:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630247220645",src:t(92989).Z,width:"409",height:"576"})),(0,i.kt)("h4",{id:"\u4e8b\u52a1\u7ba1\u7406"},"\u4e8b\u52a1\u7ba1\u7406"),(0,i.kt)("p",null,"\u4e0a\u8ff0\u73af\u5883\uff0c\u8fd0\u884c\u5355\u5143\u6d4b\u8bd5\u7c7b\uff0c\u4f1a\u6267\u884c\u8f6c\u8d26\u64cd\u4f5c\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"Tom"),"\u7684\u8d26\u6237\u4f1a\u51cf\u5c11100\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"Jerry"),"\u7684\u8d26\u6237\u4f1a\u52a0100\u3002"),(0,i.kt)("p",null,"\u8fd9\u662f\u6b63\u5e38\u60c5\u51b5\u4e0b\u7684\u8fd0\u884c\u7ed3\u679c\uff0c\u4f46\u662f\u5982\u679c\u5728\u8f6c\u8d26\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e86\u5f02\u5e38\uff0c\u5982:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"@Service\npublic class AccountServiceImpl implements AccountService {\n\n    @Autowired\n    private AccountDao accountDao;\n\n    public void transfer(String out,String in ,Double money) {\n        accountDao.outMoney(out,money);\n        int i = 1/0;\n        accountDao.inMoney(in,money);\n    }\n\n}\n")),(0,i.kt)("p",null,"\u8fd9\u4e2a\u65f6\u5019\u5c31\u6a21\u62df\u4e86\u8f6c\u8d26\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u5f02\u5e38\u7684\u60c5\u51b5\uff0c\u6b63\u786e\u7684\u64cd\u4f5c\u5e94\u8be5\u662f\u8f6c\u8d26\u51fa\u95ee\u9898\u4e86\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"Tom"),"\u5e94\u8be5\u8fd8\u662f900\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"Jerry"),"\u5e94\u8be5\u8fd8\u662f1100\uff0c\u4f46\u662f\u771f\u6b63\u8fd0\u884c\u540e\u4f1a\u53d1\u73b0\uff0c\u5e76\u6ca1\u6709\u50cf\u6211\u4eec\u60f3\u8c61\u7684\u90a3\u6837\uff0c",(0,i.kt)("inlineCode",{parentName:"p"},"Tom"),"\u8d26\u6237\u4e3a800\u800c",(0,i.kt)("inlineCode",{parentName:"p"},"Jerry"),"\u8fd8\u662f1100,100\u5757\u94b1\u51ed\u7a7a\u6d88\u606f\u4e86\uff0c\u94f6\u884c\u4e50\u75af\u4e86\u3002\u5982\u679c\u628a\u8f6c\u8d26\u6362\u4e2a\u987a\u5e8f\uff0c\u94f6\u884c\u5c31\u8be5\u54ed\u4e86\u3002"),(0,i.kt)("p",null,"\u4e0d\u7ba1\u54ea\u79cd\u60c5\u51b5\uff0c\u90fd\u662f\u4e0d\u5141\u8bb8\u51fa\u73b0\u7684\uff0c\u5bf9\u521a\u624d\u7684\u7ed3\u679c\u6211\u4eec\u505a\u4e00\u4e2a\u5206\u6790:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u7a0b\u5e8f\u6b63\u5e38\u6267\u884c\u65f6\uff0c\u8d26\u6237\u91d1\u989dA\u51cfB\u52a0\uff0c\u6ca1\u6709\u95ee\u9898")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u7a0b\u5e8f\u51fa\u73b0\u5f02\u5e38\u540e\uff0c\u8f6c\u8d26\u5931\u8d25\uff0c\u4f46\u662f\u5f02\u5e38\u4e4b\u524d\u64cd\u4f5c\u6210\u529f\uff0c\u5f02\u5e38\u4e4b\u540e\u64cd\u4f5c\u5931\u8d25\uff0c\u6574\u4f53\u4e1a\u52a1\u5931\u8d25"))),(0,i.kt)("p",null,"\u5f53\u7a0b\u5e8f\u51fa\u95ee\u9898\u540e\uff0c\u6211\u4eec\u9700\u8981\u8ba9\u4e8b\u52a1\u8fdb\u884c\u56de\u6eda\uff0c\u800c\u4e14\u8fd9\u4e2a\u4e8b\u52a1\u5e94\u8be5\u662f\u52a0\u5728\u4e1a\u52a1\u5c42\u4e0a\uff0c\u800cSpring\u7684\u4e8b\u52a1\u7ba1\u7406\u5c31\u662f\u7528\u6765\u89e3\u51b3\u8fd9\u7c7b\u95ee\u9898\u7684\u3002"),(0,i.kt)("p",null,"Spring\u4e8b\u52a1\u7ba1\u7406\u5177\u4f53\u7684\u5b9e\u73b0\u6b65\u9aa4\u4e3a:"),(0,i.kt)("h5",{id:"\u6b65\u9aa41\u5728\u9700\u8981\u88ab\u4e8b\u52a1\u7ba1\u7406\u7684\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u6ce8\u89e3"},"\u6b65\u9aa41:\u5728\u9700\u8981\u88ab\u4e8b\u52a1\u7ba1\u7406\u7684\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u6ce8\u89e3"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public interface AccountService {\n    /**\n     - \u8f6c\u8d26\u64cd\u4f5c\n     - @param out \u4f20\u51fa\u65b9\n     - @param in \u8f6c\u5165\u65b9\n     - @param money \u91d1\u989d\n     */\n    //\u914d\u7f6e\u5f53\u524d\u63a5\u53e3\u65b9\u6cd5\u5177\u6709\u4e8b\u52a1\n    public void transfer(String out,String in ,Double money) ;\n}\n\n@Service\npublic class AccountServiceImpl implements AccountService {\n\n    @Autowired\n    private AccountDao accountDao;\n    @Transactional\n    public void transfer(String out,String in ,Double money) {\n        accountDao.outMoney(out,money);\n        int i = 1/0;\n        accountDao.inMoney(in,money);\n    }\n\n}\n")),(0,i.kt)("p",null,"\u6ce8\u610f:"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"@Transactional"),"\u53ef\u4ee5\u5199\u5728\u63a5\u53e3\u7c7b\u4e0a\u3001\u63a5\u53e3\u65b9\u6cd5\u4e0a\u3001\u5b9e\u73b0\u7c7b\u4e0a\u548c\u5b9e\u73b0\u7c7b\u65b9\u6cd5\u4e0a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u5199\u5728\u63a5\u53e3\u7c7b\u4e0a\uff0c\u8be5\u63a5\u53e3\u7684\u6240\u6709\u5b9e\u73b0\u7c7b\u7684\u6240\u6709\u65b9\u6cd5\u90fd\u4f1a\u6709\u4e8b\u52a1"),(0,i.kt)("li",{parentName:"ul"},"\u5199\u5728\u63a5\u53e3\u65b9\u6cd5\u4e0a\uff0c\u8be5\u63a5\u53e3\u7684\u6240\u6709\u5b9e\u73b0\u7c7b\u7684\u8be5\u65b9\u6cd5\u90fd\u4f1a\u6709\u4e8b\u52a1"),(0,i.kt)("li",{parentName:"ul"},"\u5199\u5728\u5b9e\u73b0\u7c7b\u4e0a\uff0c\u8be5\u7c7b\u4e2d\u7684\u6240\u6709\u65b9\u6cd5\u90fd\u4f1a\u6709\u4e8b\u52a1"),(0,i.kt)("li",{parentName:"ul"},"\u5199\u5728\u5b9e\u73b0\u7c7b\u65b9\u6cd5\u4e0a\uff0c\u8be5\u65b9\u6cd5\u4e0a\u6709\u4e8b\u52a1"),(0,i.kt)("li",{parentName:"ul"},"\u5efa\u8bae\u5199\u5728\u5b9e\u73b0\u7c7b\u6216\u5b9e\u73b0\u7c7b\u7684\u65b9\u6cd5\u4e0a")),(0,i.kt)("h5",{id:"\u6b65\u9aa42\u5728jdbcconfig\u7c7b\u4e2d\u914d\u7f6e\u4e8b\u52a1\u7ba1\u7406\u5668"},"\u6b65\u9aa42:\u5728JdbcConfig\u7c7b\u4e2d\u914d\u7f6e\u4e8b\u52a1\u7ba1\u7406\u5668"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public class JdbcConfig {\n    @Value("${jdbc.driver}")\n    private String driver;\n    @Value("${jdbc.url}")\n    private String url;\n    @Value("${jdbc.username}")\n    private String userName;\n    @Value("${jdbc.password}")\n    private String password;\n\n    @Bean\n    public DataSource dataSource(){\n        DruidDataSource ds = new DruidDataSource();\n        ds.setDriverClassName(driver);\n        ds.setUrl(url);\n        ds.setUsername(userName);\n        ds.setPassword(password);\n        return ds;\n    }\n\n    //\u914d\u7f6e\u4e8b\u52a1\u7ba1\u7406\u5668\uff0cmybatis\u4f7f\u7528\u7684\u662fjdbc\u4e8b\u52a1\n    @Bean\n    public PlatformTransactionManager transactionManager(DataSource dataSource){\n        DataSourceTransactionManager transactionManager = new DataSourceTransactionManager();\n        transactionManager.setDataSource(dataSource);\n        return transactionManager;\n    }\n}\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"\u6ce8\u610f\uff1a")," \u4e8b\u52a1\u7ba1\u7406\u5668\u8981\u6839\u636e\u4f7f\u7528\u6280\u672f\u8fdb\u884c\u9009\u62e9\uff0cMybatis\u6846\u67b6\u4f7f\u7528\u7684\u662fJDBC\u4e8b\u52a1\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528",(0,i.kt)("inlineCode",{parentName:"p"},"DataSourceTransactionManager")),(0,i.kt)("h5",{id:"\u6b65\u9aa43\u5f00\u542f\u4e8b\u52a1\u6ce8\u89e3"},"\u6b65\u9aa43\uff1a\u5f00\u542f\u4e8b\u52a1\u6ce8\u89e3"),(0,i.kt)("p",null,"\u5728SpringConfig\u7684\u914d\u7f6e\u7c7b\u4e2d\u5f00\u542f"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Configuration\n@ComponentScan("com.wrm244")\n@PropertySource("classpath:jdbc.properties")\n@Import({JdbcConfig.class,MybatisConfig.class\n//\u5f00\u542f\u6ce8\u89e3\u5f0f\u4e8b\u52a1\u9a71\u52a8\n@EnableTransactionManagement\npublic class SpringConfig {\n}\n\n')),(0,i.kt)("h5",{id:"\u6b65\u9aa44\u8fd0\u884c\u6d4b\u8bd5\u7c7b"},"\u6b65\u9aa44:\u8fd0\u884c\u6d4b\u8bd5\u7c7b"),(0,i.kt)("p",null,"\u4f1a\u53d1\u73b0\u5728\u8f6c\u6362\u7684\u4e1a\u52a1\u51fa\u73b0\u9519\u8bef\u540e\uff0c\u4e8b\u52a1\u5c31\u53ef\u4ee5\u63a7\u5236\u56de\u987e\uff0c\u4fdd\u8bc1\u6570\u636e\u7684\u6b63\u786e\u6027\u3002"),(0,i.kt)("h5",{id:"\u77e5\u8bc6\u70b91enabletransactionmanagement"},"\u77e5\u8bc6\u70b91\uff1a@EnableTransactionManagement"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,i.kt)("th",{parentName:"tr",align:null},"@EnableTransactionManagement"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,i.kt)("td",{parentName:"tr",align:null},"\u914d\u7f6e\u7c7b\u6ce8\u89e3")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f4d\u7f6e"),(0,i.kt)("td",{parentName:"tr",align:null},"\u914d\u7f6e\u7c7b\u5b9a\u4e49\u4e0a\u65b9")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f5c\u7528"),(0,i.kt)("td",{parentName:"tr",align:null},"\u8bbe\u7f6e\u5f53\u524dSpring\u73af\u5883\u4e2d\u5f00\u542f\u6ce8\u89e3\u5f0f\u4e8b\u52a1\u652f\u6301")))),(0,i.kt)("h5",{id:"\u77e5\u8bc6\u70b92transactional"},"\u77e5\u8bc6\u70b92\uff1a@Transactional"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"\u540d\u79f0"),(0,i.kt)("th",{parentName:"tr",align:null},"@Transactional"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,i.kt)("td",{parentName:"tr",align:null},"\u63a5\u53e3\u6ce8\u89e3  \u7c7b\u6ce8\u89e3  \u65b9\u6cd5\u6ce8\u89e3")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f4d\u7f6e"),(0,i.kt)("td",{parentName:"tr",align:null},"\u4e1a\u52a1\u5c42\u63a5\u53e3\u4e0a\u65b9  \u4e1a\u52a1\u5c42\u5b9e\u73b0\u7c7b\u4e0a\u65b9  \u4e1a\u52a1\u65b9\u6cd5\u4e0a\u65b9")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"\u4f5c\u7528"),(0,i.kt)("td",{parentName:"tr",align:null},"\u4e3a\u5f53\u524d\u4e1a\u52a1\u5c42\u65b9\u6cd5\u6dfb\u52a0\u4e8b\u52a1\uff08\u5982\u679c\u8bbe\u7f6e\u5728\u7c7b\u6216\u63a5\u53e3\u4e0a\u65b9\u5219\u7c7b\u6216\u63a5\u53e3\u4e2d\u6240\u6709\u65b9\u6cd5\u5747\u6dfb\u52a0\u4e8b\u52a1\uff09")))),(0,i.kt)("h3",{id:"spring\u4e8b\u52a1\u89d2\u8272"},"Spring\u4e8b\u52a1\u89d2\u8272"),(0,i.kt)("p",null,"\u8fd9\u8282\u4e2d\u6211\u4eec\u91cd\u70b9\u8981\u7406\u89e3\u4e24\u4e2a\u6982\u5ff5\uff0c\u5206\u522b\u662f",(0,i.kt)("inlineCode",{parentName:"p"},"\u4e8b\u52a1\u7ba1\u7406\u5458"),"\u548c",(0,i.kt)("inlineCode",{parentName:"p"},"\u4e8b\u52a1\u534f\u8c03\u5458"),"\u3002"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u672a\u5f00\u542fSpring\u4e8b\u52a1\u4e4b\u524d:")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630248794837",src:t(55144).Z,width:"1707",height:"797"})),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"AccountDao\u7684outMoney\u56e0\u4e3a\u662f\u4fee\u6539\u64cd\u4f5c\uff0c\u4f1a\u5f00\u542f\u4e00\u4e2a\u4e8b\u52a1T1"),(0,i.kt)("li",{parentName:"ul"},"AccountDao\u7684inMoney\u56e0\u4e3a\u662f\u4fee\u6539\u64cd\u4f5c\uff0c\u4f1a\u5f00\u542f\u4e00\u4e2a\u4e8b\u52a1T2"),(0,i.kt)("li",{parentName:"ul"},"AccountService\u7684transfer\u6ca1\u6709\u4e8b\u52a1\uff0c",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u5982\u679c\u6ca1\u6709\u629b\u51fa\u5f02\u5e38\uff0c\u5219T1\u548cT2\u90fd\u6b63\u5e38\u63d0\u4ea4\uff0c\u6570\u636e\u6b63\u786e"),(0,i.kt)("li",{parentName:"ul"},"\u5982\u679c\u5728\u4e24\u4e2a\u65b9\u6cd5\u4e2d\u95f4\u629b\u51fa\u5f02\u5e38\uff0cT1\u56e0\u4e3a\u6267\u884c\u6210\u529f\u63d0\u4ea4\u4e8b\u52a1\uff0cT2\u56e0\u4e3a\u629b\u5f02\u5e38\u4e0d\u4f1a\u88ab\u6267\u884c"),(0,i.kt)("li",{parentName:"ul"},"\u5c31\u4f1a\u5bfc\u81f4\u6570\u636e\u51fa\u73b0\u9519\u8bef")))),(0,i.kt)("ol",{start:2},(0,i.kt)("li",{parentName:"ol"},"\u5f00\u542fSpring\u7684\u4e8b\u52a1\u7ba1\u7406\u540e")),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630249111055",src:t(52197).Z,width:"1702",height:"800"})),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"transfer\u4e0a\u6dfb\u52a0\u4e86@Transactional\u6ce8\u89e3\uff0c\u5728\u8be5\u65b9\u6cd5\u4e0a\u5c31\u4f1a\u6709\u4e00\u4e2a\u4e8b\u52a1T"),(0,i.kt)("li",{parentName:"ul"},"AccountDao\u7684outMoney\u65b9\u6cd5\u7684\u4e8b\u52a1T1\u52a0\u5165\u5230transfer\u7684\u4e8b\u52a1T\u4e2d"),(0,i.kt)("li",{parentName:"ul"},"AccountDao\u7684inMoney\u65b9\u6cd5\u7684\u4e8b\u52a1T2\u52a0\u5165\u5230transfer\u7684\u4e8b\u52a1T\u4e2d"),(0,i.kt)("li",{parentName:"ul"},"\u8fd9\u6837\u5c31\u4fdd\u8bc1\u4ed6\u4eec\u5728\u540c\u4e00\u4e2a\u4e8b\u52a1\u4e2d\uff0c\u5f53\u4e1a\u52a1\u5c42\u4e2d\u51fa\u73b0\u5f02\u5e38\uff0c\u6574\u4e2a\u4e8b\u52a1\u5c31\u4f1a\u56de\u6eda\uff0c\u4fdd\u8bc1\u6570\u636e\u7684\u51c6\u786e\u6027\u3002")),(0,i.kt)("p",null,"\u901a\u8fc7\u4e0a\u9762\u4f8b\u5b50\u7684\u5206\u6790\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u5982\u4e0b\u6982\u5ff5:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4e8b\u52a1\u7ba1\u7406\u5458\uff1a\u53d1\u8d77\u4e8b\u52a1\u65b9\uff0c\u5728Spring\u4e2d\u901a\u5e38\u6307\u4ee3\u4e1a\u52a1\u5c42\u5f00\u542f\u4e8b\u52a1\u7684\u65b9\u6cd5"),(0,i.kt)("li",{parentName:"ul"},"\u4e8b\u52a1\u534f\u8c03\u5458\uff1a\u52a0\u5165\u4e8b\u52a1\u65b9\uff0c\u5728Spring\u4e2d\u901a\u5e38\u6307\u4ee3\u6570\u636e\u5c42\u65b9\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e1a\u52a1\u5c42\u65b9\u6cd5")),(0,i.kt)("p",null,"\u6ce8\u610f:"),(0,i.kt)("p",null,"\u76ee\u524d\u7684\u4e8b\u52a1\u7ba1\u7406\u662f\u57fa\u4e8e",(0,i.kt)("inlineCode",{parentName:"p"},"DataSourceTransactionManager"),"\u548c",(0,i.kt)("inlineCode",{parentName:"p"},"SqlSessionFactoryBean"),"\u4f7f\u7528\u7684\u662f\u540c\u4e00\u4e2a\u6570\u636e\u6e90\u3002"),(0,i.kt)("h3",{id:"spring\u4e8b\u52a1\u5c5e\u6027"},"Spring\u4e8b\u52a1\u5c5e\u6027"),(0,i.kt)("p",null,"\u4e0a\u4e00\u8282\u6211\u4eec\u4ecb\u7ecd\u4e86\u4e24\u4e2a\u6982\u5ff5\uff0c\u4e8b\u52a1\u7684\u7ba1\u7406\u5458\u548c\u4e8b\u52a1\u7684\u534f\u540c\u5458\uff0c\u5bf9\u4e8e\u8fd9\u4e24\u4e2a\u6982\u5ff5\u5177\u4f53\u505a\u4ec0\u4e48\u7684\uff0c\u6211\u4eec\u5f85\u4f1a\u901a\u8fc7\u6848\u4f8b\u6765\u4f7f\u7528\u4e0b\u3002\u9664\u4e86\u8fd9\u4e24\u4e2a\u6982\u5ff5\uff0c\u8fd8\u6709\u5c31\u662f\u4e8b\u52a1\u7684\u5176\u4ed6\u76f8\u5173\u914d\u7f6e\u90fd\u6709\u54ea\u4e9b\uff0c\u5c31\u662f\u6211\u4eec\u63a5\u4e0b\u6765\u8981\u5b66\u4e60\u7684\u5185\u5bb9\u3002"),(0,i.kt)("p",null,"\u5728\u8fd9\u4e00\u8282\u4e2d\uff0c\u6211\u4eec\u4e3b\u8981\u5b66\u4e60\u4e09\u90e8\u5206\u5185\u5bb9",(0,i.kt)("inlineCode",{parentName:"p"},"\u4e8b\u52a1\u914d\u7f6e"),"\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"\u8f6c\u8d26\u4e1a\u52a1\u8ffd\u52a0\u65e5\u5fd7"),"\u3001",(0,i.kt)("inlineCode",{parentName:"p"},"\u4e8b\u52a1\u4f20\u64ad\u884c\u4e3a"),"\u3002"),(0,i.kt)("h4",{id:"\u4e8b\u52a1\u914d\u7f6e"},"\u4e8b\u52a1\u914d\u7f6e"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630250069844",src:t(68945).Z,width:"1430",height:"677"})),(0,i.kt)("p",null,"\u4e0a\u9762\u8fd9\u4e9b\u5c5e\u6027\u90fd\u53ef\u4ee5\u5728",(0,i.kt)("inlineCode",{parentName:"p"},"@Transactional"),"\u6ce8\u89e3\u7684\u53c2\u6570\u4e0a\u8fdb\u884c\u8bbe\u7f6e\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"readOnly\uff1atrue\u53ea\u8bfb\u4e8b\u52a1\uff0cfalse\u8bfb\u5199\u4e8b\u52a1\uff0c\u589e\u5220\u6539\u8981\u8bbe\u4e3afalse,\u67e5\u8be2\u8bbe\u4e3atrue\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"timeout:\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4\u5355\u4f4d\u79d2\uff0c\u5728\u591a\u957f\u65f6\u95f4\u4e4b\u5185\u4e8b\u52a1\u6ca1\u6709\u63d0\u4ea4\u6210\u529f\u5c31\u81ea\u52a8\u56de\u6eda\uff0c-1\u8868\u793a\u4e0d\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4\u3002")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"rollbackFor:\u5f53\u51fa\u73b0\u6307\u5b9a\u5f02\u5e38\u8fdb\u884c\u4e8b\u52a1\u56de\u6eda")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"noRollbackFor:\u5f53\u51fa\u73b0\u6307\u5b9a\u5f02\u5e38\u4e0d\u8fdb\u884c\u4e8b\u52a1\u56de\u6eda"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u601d\u8003:\u51fa\u73b0\u5f02\u5e38\u4e8b\u52a1\u4f1a\u81ea\u52a8\u56de\u6eda\uff0c\u8fd9\u4e2a\u662f\u6211\u4eec\u4e4b\u524d\u5c31\u5df2\u7ecf\u77e5\u9053\u7684")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"noRollbackFor\u662f\u8bbe\u5b9a\u5bf9\u4e8e\u6307\u5b9a\u7684\u5f02\u5e38\u4e0d\u56de\u6eda\uff0c\u8fd9\u4e2a\u597d\u7406\u89e3")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"rollbackFor\u662f\u6307\u5b9a\u56de\u6eda\u5f02\u5e38\uff0c\u5bf9\u4e8e\u5f02\u5e38\u4e8b\u52a1\u4e0d\u5e94\u8be5\u90fd\u56de\u6eda\u4e48\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u8981\u6307\u5b9a?"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u8fd9\u5757\u9700\u8981\u66f4\u6b63\u4e00\u4e2a\u77e5\u8bc6\u70b9\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u5f02\u5e38\u90fd\u4f1a\u56de\u6eda\u4e8b\u52a1\uff0c\u6bd4\u5982\u4e0b\u9762\u7684\u4ee3\u7801\u5c31\u4e0d\u4f1a\u56de\u6eda"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public interface AccountService {\n    /**\n     - \u8f6c\u8d26\u64cd\u4f5c\n     - @param out \u4f20\u51fa\u65b9\n     - @param in \u8f6c\u5165\u65b9\n     - @param money \u91d1\u989d\n     */\n    //\u914d\u7f6e\u5f53\u524d\u63a5\u53e3\u65b9\u6cd5\u5177\u6709\u4e8b\u52a1\n    public void transfer(String out,String in ,Double money) throws IOException;\n}\n\n@Service\npublic class AccountServiceImpl implements AccountService {\n\n    @Autowired\n    private AccountDao accountDao;\n    @Transactional\n    public void transfer(String out,String in ,Double money) throws IOException{\n        accountDao.outMoney(out,money);\n        //int i = 1/0; //\u8fd9\u4e2a\u5f02\u5e38\u4e8b\u52a1\u4f1a\u56de\u6eda\n        if(true){\n            throw new IOException(); //\u8fd9\u4e2a\u5f02\u5e38\u4e8b\u52a1\u5c31\u4e0d\u4f1a\u56de\u6eda\n        }\n        accountDao.inMoney(in,money);\n    }\n\n}\n"))))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u51fa\u73b0\u8fd9\u4e2a\u95ee\u9898\u7684\u539f\u56e0\u662f\uff0cSpring\u7684\u4e8b\u52a1\u53ea\u4f1a\u5bf9",(0,i.kt)("inlineCode",{parentName:"p"},"Error\u5f02\u5e38"),"\u548c",(0,i.kt)("inlineCode",{parentName:"p"},"RuntimeException\u5f02\u5e38"),"\u53ca\u5176\u5b50\u7c7b\u8fdb\u884c\u4e8b\u52a1\u56de\u987e\uff0c\u5176\u4ed6\u7684\u5f02\u5e38\u7c7b\u578b\u662f\u4e0d\u4f1a\u56de\u6eda\u7684\uff0c\u5bf9\u5e94IOException\u4e0d\u7b26\u5408\u4e0a\u8ff0\u6761\u4ef6\u6240\u4ee5\u4e0d\u56de\u6eda"),(0,i.kt)("blockquote",{parentName:"li"},(0,i.kt)("p",{parentName:"blockquote"},"IOException \u4e0d\u662f\u8fd0\u884c\u65f6\u5f02\u5e38\uff0c\u800c\u662f\u975e\u8fd0\u884c\u65f6\u5f02\u5e38")),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre"},"- \u6b64\u65f6\u5c31\u53ef\u4ee5\u4f7f\u7528rollbackFor\u5c5e\u6027\u6765\u8bbe\u7f6e\u51fa\u73b0IOException\u5f02\u5e38\u4e0d\u56de\u6eda\n\n  ```java\n  @Service\n  public class AccountServiceImpl implements AccountService {\n  \n      @Autowired\n      private AccountDao accountDao;\n     @Transactional(rollbackFor = {IOException.class})\n      public void transfer(String out,String in ,Double money) throws IOException{\n          accountDao.outMoney(out,money);\n          //int i = 1/0; //\u8fd9\u4e2a\u5f02\u5e38\u4e8b\u52a1\u4f1a\u56de\u6eda\n          if(true){\n              throw new IOException(); //\u8fd9\u4e2a\u5f02\u5e38\u4e8b\u52a1\u5c31\u4e0d\u4f1a\u56de\u6eda\n          }\n          accountDao.inMoney(in,money);\n      }\n  \n  }\n  ```\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"rollbackForClassName\u7b49\u540c\u4e8erollbackFor,\u53ea\u4e0d\u8fc7\u5c5e\u6027\u4e3a\u5f02\u5e38\u7684\u7c7b\u5168\u540d\u5b57\u7b26\u4e32")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"noRollbackForClassName\u7b49\u540c\u4e8enoRollbackFor\uff0c\u53ea\u4e0d\u8fc7\u5c5e\u6027\u4e3a\u5f02\u5e38\u7684\u7c7b\u5168\u540d\u5b57\u7b26\u4e32")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"isolation\u8bbe\u7f6e\u4e8b\u52a1\u7684\u9694\u79bb\u7ea7\u522b"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"DEFAULT   :\u9ed8\u8ba4\u9694\u79bb\u7ea7\u522b, \u4f1a\u91c7\u7528\u6570\u636e\u5e93\u7684\u9694\u79bb\u7ea7\u522b"),(0,i.kt)("li",{parentName:"ul"},"READ_UNCOMMITTED : \u8bfb\u672a\u63d0\u4ea4"),(0,i.kt)("li",{parentName:"ul"},"READ_COMMITTED : \u8bfb\u5df2\u63d0\u4ea4"),(0,i.kt)("li",{parentName:"ul"},"REPEATABLE_READ : \u91cd\u590d\u8bfb\u53d6"),(0,i.kt)("li",{parentName:"ul"},"SERIALIZABLE: \u4e32\u884c\u5316")))),(0,i.kt)("p",null,"\u4ecb\u7ecd\u5b8c\u4e0a\u8ff0\u5c5e\u6027\u540e\uff0c\u8fd8\u6709\u6700\u540e\u4e00\u4e2a\u4e8b\u52a1\u7684\u4f20\u64ad\u884c\u4e3a\uff0c\u4e3a\u4e86\u8bb2\u89e3\u8be5\u5c5e\u6027\u7684\u8bbe\u7f6e\uff0c\u6211\u4eec\u9700\u8981\u5b8c\u6210\u4e0b\u9762\u7684\u6848\u4f8b\u3002"),(0,i.kt)("h4",{id:"\u8f6c\u8d26\u4e1a\u52a1\u8ffd\u52a0\u65e5\u5fd7\u6848\u4f8b"},"\u8f6c\u8d26\u4e1a\u52a1\u8ffd\u52a0\u65e5\u5fd7\u6848\u4f8b"),(0,i.kt)("h5",{id:"\u9700\u6c42\u5206\u6790-3"},"\u9700\u6c42\u5206\u6790"),(0,i.kt)("p",null,"\u5728\u524d\u9762\u7684\u8f6c\u6848\u4f8b\u7684\u57fa\u7840\u4e0a\u6dfb\u52a0\u65b0\u7684\u9700\u6c42\uff0c\u5b8c\u6210\u8f6c\u8d26\u540e\u8bb0\u5f55\u65e5\u5fd7\u3002"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u9700\u6c42\uff1a\u5b9e\u73b0\u4efb\u610f\u4e24\u4e2a\u8d26\u6237\u95f4\u8f6c\u8d26\u64cd\u4f5c\uff0c\u5e76\u5bf9\u6bcf\u6b21\u8f6c\u8d26\u64cd\u4f5c\u5728\u6570\u636e\u5e93\u8fdb\u884c\u7559\u75d5"),(0,i.kt)("li",{parentName:"ul"},"\u9700\u6c42\u5fae\u7f29\uff1aA\u8d26\u6237\u51cf\u94b1\uff0cB\u8d26\u6237\u52a0\u94b1\uff0c\u6570\u636e\u5e93\u8bb0\u5f55\u65e5\u5fd7")),(0,i.kt)("p",null,"\u57fa\u4e8e\u4e0a\u8ff0\u7684\u4e1a\u52a1\u9700\u6c42\uff0c\u6211\u4eec\u6765\u5206\u6790\u4e0b\u8be5\u5982\u4f55\u5b9e\u73b0:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u57fa\u4e8e\u8f6c\u8d26\u64cd\u4f5c\u6848\u4f8b\u6dfb\u52a0\u65e5\u5fd7\u6a21\u5757\uff0c\u5b9e\u73b0\u6570\u636e\u5e93\u4e2d\u8bb0\u5f55\u65e5\u5fd7")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"\u4e1a\u52a1\u5c42\u8f6c\u8d26\u64cd\u4f5c\uff08transfer\uff09\uff0c\u8c03\u7528\u51cf\u94b1\u3001\u52a0\u94b1\u4e0e\u8bb0\u5f55\u65e5\u5fd7\u529f\u80fd"))),(0,i.kt)("p",null,"\u9700\u8981\u6ce8\u610f\u4e00\u70b9\u5c31\u662f\uff0c\u6211\u4eec\u8fd9\u4e2a\u6848\u4f8b\u7684\u9884\u671f\u6548\u679c\u4e3a:"),(0,i.kt)("p",null,"\u65e0\u8bba\u8f6c\u8d26\u64cd\u4f5c\u662f\u5426\u6210\u529f\uff0c\u5747\u8fdb\u884c\u8f6c\u8d26\u64cd\u4f5c\u7684\u65e5\u5fd7\u7559\u75d5"),(0,i.kt)("h5",{id:"\u73af\u5883\u51c6\u5907-5"},"\u73af\u5883\u51c6\u5907"),(0,i.kt)("p",null,"\u8be5\u73af\u5883\u662f\u57fa\u4e8e\u8f6c\u8d26\u73af\u5883\u6765\u5b8c\u6210\u7684\uff0c\u6240\u4ee5\u73af\u5883\u7684\u51c6\u5907\u53ef\u4ee5\u53c2\u8003",(0,i.kt)("inlineCode",{parentName:"p"},"\u4e4b\u524d\u73af\u5883\u642d\u5efa\u6b65\u9aa4"),"\uff0c\u5728\u5176\u57fa\u7840\u4e0a\uff0c\u6211\u4eec\u7ee7\u7eed\u5f80\u4e0b\u5199"),(0,i.kt)("h6",{id:"\u6b65\u9aa41\u521b\u5efa\u65e5\u5fd7\u8868"},"\u6b65\u9aa41:\u521b\u5efa\u65e5\u5fd7\u8868"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-sql"},"create table tbl_log(\n   id int primary key auto_increment,\n   info varchar(255),\n   createDate datetime\n)\n")),(0,i.kt)("h6",{id:"\u6b65\u9aa42\u6dfb\u52a0logdao\u63a5\u53e3"},"\u6b65\u9aa42:\u6dfb\u52a0LogDao\u63a5\u53e3"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public interface LogDao {\n    @Insert("insert into tbl_log (info,createDate) values(#{info},now())")\n    void log(String info);\n}\n\n')),(0,i.kt)("h6",{id:"\u6b65\u9aa43\u6dfb\u52a0logservice\u63a5\u53e3\u4e0e\u5b9e\u73b0\u7c7b"},"\u6b65\u9aa43:\u6dfb\u52a0LogService\u63a5\u53e3\u4e0e\u5b9e\u73b0\u7c7b"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'public interface LogService {\n    void log(String out, String in, Double money);\n}\n@Service\npublic class LogServiceImpl implements LogService {\n\n    @Autowired\n    private LogDao logDao;\n    @Transactional\n    public void log(String out,String in,Double money ) {\n        logDao.log("\u8f6c\u8d26\u64cd\u4f5c\u7531"+out+"\u5230"+in+",\u91d1\u989d\uff1a"+money);\n    }\n}\n')),(0,i.kt)("h6",{id:"\u6b65\u9aa44\u5728\u8f6c\u8d26\u7684\u4e1a\u52a1\u4e2d\u6dfb\u52a0\u8bb0\u5f55\u65e5\u5fd7"},"\u6b65\u9aa44:\u5728\u8f6c\u8d26\u7684\u4e1a\u52a1\u4e2d\u6dfb\u52a0\u8bb0\u5f55\u65e5\u5fd7"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},"public interface AccountService {\n    /**\n     - \u8f6c\u8d26\u64cd\u4f5c\n     - @param out \u4f20\u51fa\u65b9\n     - @param in \u8f6c\u5165\u65b9\n     - @param money \u91d1\u989d\n     */\n    //\u914d\u7f6e\u5f53\u524d\u63a5\u53e3\u65b9\u6cd5\u5177\u6709\u4e8b\u52a1\n    public void transfer(String out,String in ,Double money)throws IOException ;\n}\n@Service\npublic class AccountServiceImpl implements AccountService {\n\n    @Autowired\n    private AccountDao accountDao;\n    @Autowired\n    private LogService logService;\n    @Transactional\n    public void transfer(String out,String in ,Double money) {\n        try{\n            accountDao.outMoney(out,money);\n            accountDao.inMoney(in,money);\n        }finally {\n            logService.log(out,in,money);\n        }\n    }\n\n}\n")),(0,i.kt)("h6",{id:"\u6b65\u9aa45\u8fd0\u884c\u7a0b\u5e8f-2"},"\u6b65\u9aa45:\u8fd0\u884c\u7a0b\u5e8f"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5f53\u7a0b\u5e8f\u6b63\u5e38\u8fd0\u884c\uff0ctbl_account\u8868\u4e2d\u8f6c\u8d26\u6210\u529f\uff0ctbl_log\u8868\u4e2d\u65e5\u5fd7\u8bb0\u5f55\u6210\u529f")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5f53\u8f6c\u8d26\u4e1a\u52a1\u4e4b\u95f4\u51fa\u73b0\u5f02\u5e38(int i =1/0),\u8f6c\u8d26\u5931\u8d25\uff0ctbl_account\u6210\u529f\u56de\u6eda\uff0c\u4f46\u662ftbl_log\u8868\u672a\u6dfb\u52a0\u6570\u636e")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u8fd9\u4e2a\u7ed3\u679c\u548c\u6211\u4eec\u60f3\u8981\u7684\u4e0d\u4e00\u6837\uff0c\u4ec0\u4e48\u539f\u56e0?\u8be5\u5982\u4f55\u89e3\u51b3?")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u5931\u8d25\u539f\u56e0:\u65e5\u5fd7\u7684\u8bb0\u5f55\u4e0e\u8f6c\u8d26\u64cd\u4f5c\u96b6\u5c5e\u540c\u4e00\u4e2a\u4e8b\u52a1\uff0c\u540c\u6210\u529f\u540c\u5931\u8d25")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"\u6700\u7ec8\u6548\u679c:\u65e0\u8bba\u8f6c\u8d26\u64cd\u4f5c\u662f\u5426\u6210\u529f\uff0c\u65e5\u5fd7\u5fc5\u987b\u4fdd\u7559"))),(0,i.kt)("p",null,"\u4e0b\u5c0f\u8282\u5206\u6790\u539f\u56e0\uff1a"),(0,i.kt)("h4",{id:"\u4e8b\u52a1\u4f20\u64ad\u884c\u4e3a"},"\u4e8b\u52a1\u4f20\u64ad\u884c\u4e3a"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630253779575",src:t(63411).Z,width:"1411",height:"557"})),(0,i.kt)("p",null,"\u5bf9\u4e8e\u4e0a\u8ff0\u6848\u4f8b\u7684\u5206\u6790:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"log\u65b9\u6cd5\u3001inMoney\u65b9\u6cd5\u548coutMoney\u65b9\u6cd5\u90fd\u5c5e\u4e8e\u589e\u5220\u6539\uff0c\u5206\u522b\u6709\u4e8b\u52a1T1,T2,T3"),(0,i.kt)("li",{parentName:"ul"},"transfer\u56e0\u4e3a\u52a0\u4e86",(0,i.kt)("inlineCode",{parentName:"li"},"@Transactional"),"\u6ce8\u89e3\uff0c\u4e5f\u5f00\u542f\u4e86\u4e8b\u52a1T"),(0,i.kt)("li",{parentName:"ul"},"\u524d\u9762\u6211\u4eec\u8bb2\u8fc7Spring\u4e8b\u52a1\u4f1a\u628aT1,T2,T3\u90fd\u52a0\u5165\u5230\u4e8b\u52a1T\u4e2d"),(0,i.kt)("li",{parentName:"ul"},"\u6240\u4ee5\u5f53\u8f6c\u8d26\u5931\u8d25\u540e\uff0c\u6240\u6709\u7684\u4e8b\u52a1\u90fd\u56de\u6eda\uff0c\u5bfc\u81f4\u65e5\u5fd7\u6ca1\u6709\u8bb0\u5f55\u4e0b\u6765"),(0,i.kt)("li",{parentName:"ul"},"\u8fd9\u548c\u6211\u4eec\u7684\u9700\u6c42\u4e0d\u7b26\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u60f3\u80fd\u4e0d\u80fd\u8ba9log\u65b9\u6cd5\u5355\u72ec\u662f\u4e00\u4e2a\u4e8b\u52a1\u5462?")),(0,i.kt)("p",null,"\u8981\u60f3\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5c31\u9700\u8981\u7528\u5230\u4e8b\u52a1\u4f20\u64ad\u884c\u4e3a\uff0c\u6240\u8c13\u7684\u4e8b\u52a1\u4f20\u64ad\u884c\u4e3a\u6307\u7684\u662f:"),(0,i.kt)("p",null,"\u4e8b\u52a1\u4f20\u64ad\u884c\u4e3a\uff1a\u4e8b\u52a1\u534f\u8c03\u5458\u5bf9\u4e8b\u52a1\u7ba1\u7406\u5458\u6240\u643a\u5e26\u4e8b\u52a1\u7684\u5904\u7406\u6001\u5ea6\u3002"),(0,i.kt)("p",null,"\u5177\u4f53\u5982\u4f55\u89e3\u51b3\uff0c\u9700\u8981\u6dfb\u52a0\u65b0\u7684\u5c5e\u6027\uff1a",(0,i.kt)("inlineCode",{parentName:"p"},"propagation\u5c5e\u6027"),"\u3002"),(0,i.kt)("h5",{id:"\u4fee\u6539logservice\u6539\u53d8\u4e8b\u52a1\u7684\u4f20\u64ad\u884c\u4e3a"},"\u4fee\u6539logService\u6539\u53d8\u4e8b\u52a1\u7684\u4f20\u64ad\u884c\u4e3a"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-java"},'@Service\npublic class LogServiceImpl implements LogService {\n\n    @Autowired\n    private LogDao logDao;\n    //propagation\u8bbe\u7f6e\u4e8b\u52a1\u5c5e\u6027\uff1a\u4f20\u64ad\u884c\u4e3a\u8bbe\u7f6e\u4e3a\u5f53\u524d\u64cd\u4f5c\u9700\u8981\u65b0\u4e8b\u52a1\n    @Transactional(propagation = Propagation.REQUIRES_NEW)\n    public void log(String out,String in,Double money ) {\n        logDao.log("\u8f6c\u8d26\u64cd\u4f5c\u7531"+out+"\u5230"+in+",\u91d1\u989d\uff1a"+money);\n    }\n}\n')),(0,i.kt)("p",null,"\u8fd0\u884c\u540e\uff0c\u5c31\u80fd\u5b9e\u73b0\u6211\u4eec\u60f3\u8981\u7684\u7ed3\u679c\uff0c\u4e0d\u7ba1\u8f6c\u8d26\u662f\u5426\u6210\u529f\uff0c\u90fd\u4f1a\u8bb0\u5f55\u65e5\u5fd7\u3002"),(0,i.kt)("h5",{id:"\u4e8b\u52a1\u4f20\u64ad\u884c\u4e3a\u7684\u53ef\u9009\u503c"},"\u4e8b\u52a1\u4f20\u64ad\u884c\u4e3a\u7684\u53ef\u9009\u503c"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"1630254257628",src:t(92260).Z,width:"1432",height:"664"})),(0,i.kt)("p",null,"\u5bf9\u4e8e\u6211\u4eec\u5f00\u53d1\u5b9e\u9645\u4e2d\u4f7f\u7528\u7684\u8bdd\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u503c\u9700\u8981\u4e8b\u52a1\u662f\u5e38\u6001\u7684\u3002\u6839\u636e\u5f00\u53d1\u8fc7\u7a0b\u9009\u62e9\u5176\u4ed6\u7684\u5c31\u53ef\u4ee5\u4e86\uff0c\u4f8b\u5982\u6848\u4f8b\u4e2d\u9700\u8981\u65b0\u4e8b\u52a1\u5c31\u9700\u8981\u624b\u5de5\u914d\u7f6e\u3002\u5176\u5b9e\u5165\u8d26\u548c\u51fa\u8d26\u64cd\u4f5c\u4e0a\u4e5f\u6709\u4e8b\u52a1\uff0c\u91c7\u7528\u7684\u5c31\u662f\u9ed8\u8ba4\u503c\u3002"))}k.isMDXComponent=!0},3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return k}});var a=t(67294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function p(e,n){if(null==e)return{};var t,a,l=function(e,n){if(null==e)return{};var t,a,l={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var o=a.createContext({}),u=function(e){var n=a.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},c=function(e){var n=u(e.components);return a.createElement(o.Provider,{value:n},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},s=a.forwardRef((function(e,n){var t=e.components,l=e.mdxType,i=e.originalType,o=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),d=u(t),s=l,k=d["".concat(o,".").concat(s)]||d[s]||m[s]||i;return t?a.createElement(k,r(r({ref:n},c),{},{components:t})):a.createElement(k,r({ref:n},c))}));function k(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var i=t.length,r=new Array(i);r[0]=s;var p={};for(var o in n)hasOwnProperty.call(n,o)&&(p[o]=n[o]);p.originalType=e,p[d]="string"==typeof e?e:l,r[1]=p;for(var u=2;u<i;u++)r[u]=t[u];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}s.displayName="MDXCreateElement"},42453:function(e,n,t){n.Z=t.p+"assets/images/1630143927489-48916fd44a2bf51501ed8da5bf748f31.png"},21080:function(e,n,t){n.Z=t.p+"assets/images/1630144353462-fb473c81a06344f48f173f0241b0c0db.png"},36252:function(e,n,t){n.Z=t.p+"assets/images/1630146885493-8831f9b69c4babce3238a866f00acc33.png"},65532:function(e,n,t){n.Z=t.p+"assets/images/1630147945888-fa09840dc3d7de2c3147a6f521cad2c0.png"},95673:function(e,n,t){n.Z=t.p+"assets/images/1630148447689-3db39631116d6b1c4b5db3a562c13ef3.png"},66181:function(e,n,t){n.Z=t.p+"assets/images/1630151682428-de3de7427a2c498a9b2142063325f70a.png"},97726:function(e,n,t){n.Z=t.p+"assets/images/1630152538083-9c34ae03d2888f5aa624bb1dd904e051.png"},4223:function(e,n,t){n.Z=t.p+"assets/images/1630154495165-7dabe4cde3e8609fdfd734864d717b1c.png"},42478:function(e,n,t){n.Z=t.p+"assets/images/1630154625564-fce8602493e253b44ebf02cd8aff3a60.png"},51830:function(e,n,t){n.Z=t.p+"assets/images/1630155937718-cf7359b431b60ce4b48e02e39edc29a7.png"},24549:function(e,n,t){n.Z=t.p+"assets/images/1630156172790-1ff2197e3dbccd404e94dcbe7f4a3c79.png"},55798:function(e,n,t){n.Z=t.p+"assets/images/1630163744963-bea2d4e9ef623b024013c90b9be09ca1.png"},71321:function(e,n,t){n.Z=t.p+"assets/images/1630164718080-45c840b9ac5cf07083cc02eb49109b73.png"},66732:function(e,n,t){n.Z=t.p+"assets/images/1630166147697-31c988c69f0577431c569ba4e4713f28.png"},84082:function(e,n,t){n.Z=t.p+"assets/images/1630167092142-066128660151e0640a6180f81310c36f.png"},45373:function(e,n,t){n.Z=t.p+"assets/images/1630167385146-e9bb85d434d18ab37f82ac7d9184c50b.png"},48605:function(e,n,t){n.Z=t.p+"assets/images/1630167805723-ec6d958bd34b00ab3ad2f4c0c12b6c12.png"},37146:function(e,n,t){n.Z=t.p+"assets/images/1630167887131-6c5d76a6f685418281c758f836147cbb.png"},7573:function(e,n,t){n.Z=t.p+"assets/images/1630167969051-40982e949af9c52161ad176cfba4e1c5.png"},81975:function(e,n,t){n.Z=t.p+"assets/images/1630168248052-c54d1b1d2924f6f29a5d93c907bc9c33.png"},17951:function(e,n,t){n.Z=t.p+"assets/images/1630168293492-4eb0b462687de9cddbe95426b619b582.png"},44124:function(e,n,t){n.Z=t.p+"assets/images/1630169124446-8610a96a0bec6d10fa18fa325ffab768.png"},26079:function(e,n,t){n.Z=t.p+"assets/images/1630169357146-b8297cb34cf8e011013f81c76f9e10dc.png"},19204:function(e,n,t){n.Z=t.p+"assets/images/1630170090945-3872d0bbab3e8a09003080fda7caed54.png"},85276:function(e,n,t){n.Z=t.p+"assets/images/1630214631112-9f9209d7c8cb6f786664cb4877741d00.png"},85803:function(e,n,t){n.Z=t.p+"assets/images/1630215355776-cf8f0e5d8d9cf7b4eb8e4c869af3c940.png"},37880:function(e,n,t){n.Z=t.p+"assets/images/1630215743444-d02d05c148b01cfe0384bacfe288eb13.png"},446:function(e,n,t){n.Z=t.p+"assets/images/1630233154992-b311a7111468cc33f422f70f7daf893f.png"},16081:function(e,n,t){n.Z=t.p+"assets/images/1630233291929-b376b3aa6ac2e9e6c9a55ae161f26a50.png"},41837:function(e,n,t){n.Z=t.p+"assets/images/1630233548743-124b2840f7cb01d14883063f7431e2fc.png"},29162:function(e,n,t){n.Z=t.p+"assets/images/1630233974310-08e911d3eb8273228e3b6e9679cf2134.png"},92166:function(e,n,t){n.Z=t.p+"assets/images/1630234756123-2df4df9dca2c1cbd3feb5bbbc9b58429.png"},48801:function(e,n,t){n.Z=t.p+"assets/images/1630237320870-6bd40a6c635938ff4072aa92b6bbe3e8.png"},86680:function(e,n,t){n.Z=t.p+"assets/images/1630237372286-c215aa2d8f3991da36b8e70a664ccb1d.png"},85874:function(e,n,t){n.Z=t.p+"assets/images/1630237586682-903d908bcc5b51132a85e6b851da4429.png"},84761:function(e,n,t){n.Z=t.p+"assets/images/1630239939043-7c23306b219d5b0d58e3d05b17a1870b.png"},84532:function(e,n,t){n.Z=t.p+"assets/images/1630239997560-cace934ae96dd53ff49fdac9db2ef36f.png"},43807:function(e,n,t){n.Z=t.p+"assets/images/1630240203033-076f454d1764fe27eb5ca98ef13595b1.png"},73662:function(e,n,t){n.Z=t.p+"assets/images/1630240528228-2a75d9d6d32f720c9d65e24f018662bf.png"},28637:function(e,n,t){n.Z=t.p+"assets/images/1630241681697-c60fd9b400bce8d0a17e18f740a71036.png"},32806:function(e,n,t){n.Z=t.p+"assets/images/1630242491831-dab4c9cb51b518c7f0013f26a979a1c1.png"},71306:function(e,n,t){n.Z=t.p+"assets/images/1630243651541-09138b97b9ec472a5a5f0c41a3105814.png"},7866:function(e,n,t){n.Z=t.p+"assets/images/1630243993380-20d376ed41f12b185d378f79d9e9885f.png"},92989:function(e,n,t){n.Z=t.p+"assets/images/1630247220645-10df3d0219aa41170b5e485fe97dc40f.png"},55144:function(e,n,t){n.Z=t.p+"assets/images/1630248794837-f0b5912f285306569d85d867f6e2a918.png"},52197:function(e,n,t){n.Z=t.p+"assets/images/1630249111055-4244893ab60a1da0ad7ad6a0b2ceaceb.png"},68945:function(e,n,t){n.Z=t.p+"assets/images/1630250069844-fc1bbf9fb9a14a3f5a15b4ff1bc05441.png"},63411:function(e,n,t){n.Z=t.p+"assets/images/1630253779575-f1232eeb90cf061ead3745d5dd16021f.png"},92260:function(e,n,t){n.Z=t.p+"assets/images/1630254257628-2c7f71a198314842cbfefdedbd3fbf5d.png"}}]);